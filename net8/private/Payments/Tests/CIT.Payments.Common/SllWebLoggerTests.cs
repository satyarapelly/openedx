// <copyright company="Microsoft">Copyright (c) Microsoft 2019. All rights reserved.</copyright>

namespace CIT.Payments.Common
{
    using Microsoft.AspNetCore.Http;
    using Microsoft.Commerce.Payments.Common.Tracing;
    using Microsoft.Commerce.Payments.Common.Web;
    using Microsoft.Commerce.Payments.PidlFactory;
    using Microsoft.Diagnostics.Tracing;
    using Microsoft.Diagnostics.Tracing.Parsers;
    using Microsoft.Diagnostics.Tracing.Session;
    using Microsoft.VisualStudio.TestTools.UnitTesting;
    using Newtonsoft.Json;
    using System;
    using System.Diagnostics;
    using System.IO;
    using System.Net.Http;
    using System.Text;

    [TestClass]
    public class SllWebLoggerTests
    {
        // ETW provider id of Sll log.         
        const string SllProviderID = "4df70947-988d-5aa7-6059-8d957fad613a";
        const string XPertPaymentsSessionName = "XPert-Payments";

        [TestMethod]
        [Ignore]

        // Task 26084576: System.AppDomainUnloadedException
        public void TracePXServiceOutgoingOperationAsExpected2()
        {
            string etlFileName = "PXServiceSllWebLoggerTests.etl";

            string requestPayload = "<GetAccountInput xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"urn:schemas.microsoft.com/CommercePlatform/Services/AccountService\"><PropertyBag i:nil=\"true\" /><APIContext><FraudDetectionContext i:nil=\"true\" /><PropertyBag i:nil=\"true\" /><TrackingGuid>7c6f8b28-e83b-4fa1-8ede-c5929542b72d</TrackingGuid></APIContext><AdditionalRequiredInfo>None</AdditionalRequiredInfo><AllAddressesReturned>false</AllAddressesReturned><CallerInfo><AccountId>u5kTBQAAAAAAAAAA</AccountId><Delegator i:nil=\"true\" /><Requester><IdentityProperty i:nil=\"true\" /><IdentityType>PUID</IdentityType><IdentityValue>985154368592012</IdentityValue></Requester></CallerInfo><Filters i:nil=\"true\" /><SearchCriteria><AccountId>u5kTBQAAAAAAAAAA</AccountId><Identity i:nil=\"true\" /></SearchCriteria></GetAccountInput>";
            string responsePayload = "<GetAccountOutput xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"urn:schemas.microsoft.com/CommercePlatform/Services/AccountService\"><AccountOutputInfo><AccountInfo><AccountID>u5kTBQAAAAAAAAAA</AccountID><PayinInfo><AddressSet><Address><AddressID>u5kTBQAAAAABAACg</AddressID><City>Vijayawada</City><CountryCode>IN</CountryCode><District /><FirstName>John</FirstName><FriendlyName>My Address</FriendlyName><LastName>Doe</LastName><MapAddressResult i:nil=\"true\" /><PostalCode>520012</PostalCode><State>andhra pradesh</State><Street1>One Microsoft Way</Street1><Street2/><Street3/><UnitNumber/></Address></AddressSet><CompanyName>Microsoft</CompanyName><CompanyNamePronunciation /><CorporateIdentity>1291</CorporateIdentity><CorporateLegalEntity>Microsoft Regional Sales</CorporateLegalEntity><CorporateVatId>SG M9-0002526-N</CorporateVatId><CountryCode>IN</CountryCode><CreatedDate>2019-04-11T22:45:22.263</CreatedDate><Currency>INR</Currency><CustomerType>Business</CustomerType><DefaultAddressID>u5kTBQAAAAABAACg</DefaultAddressID><Email>johndoe@live.com</Email><FirstName>John</FirstName><FirstNamePronunciation /><FriendlyName>Microsoft</FriendlyName><HCI>NO</HCI><HCIValid>NO</HCIValid><HistoryDate>0001-01-01T00:00:00</HistoryDate><LastName>Doe</LastName><LastNamePronunciation /><LastUpdatedDate>2019-04-11T22:48:59.513</LastUpdatedDate><Locale>en-IN</Locale><PhoneSet i:nil=\"true\" /><Status>Active</Status><TaxExemptionInfoSet i:nil=\"true\" /><Violations i:nil=\"true\" /></PayinInfo><PayoutInfo i:nil=\"true\" /><TaxProfiles i:nil=\"true\" /></AccountInfo></AccountOutputInfo></GetAccountOutput>"; // lgtm[cs/hard-coded-id]
            DateTime startTime = DateTime.Now;
            string requestTraceId = Guid.NewGuid().ToString();
            string message = string.Format("Tracking Guid: {0}", Guid.NewGuid());

            // Sessions collect and control event providers.
            using (var session = new TraceEventSession(XPertPaymentsSessionName, etlFileName))
            {
                session.EnableProvider(SllProviderID);
            }

            bool receivedExpectedTraceData = false;

            using (var source = new ETWTraceEventSource(etlFileName))
            {
                var parser = new DynamicTraceEventParser(source);
                parser.All += delegate (TraceEvent data)
                {
                    if (string.Equals(data.EventName, "GeneralInformational/Message")
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("Microsoft.Commerce.Tracing.Sll.PXServiceOutgoingOperation") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("RequestTraceId\":\"{0}", requestTraceId)) > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("<IdentityValue>MASKED(15)</IdentityValue>") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("<FirstName>J...(4)</FirstName>") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("<Street1>MASKED(17)</Street1>") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("<Email>jo...e(7)@live.com</Email>") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("Message\":\"{0}", message)) > 0)
                    {
                        receivedExpectedTraceData = true;
                    }
                };

                source.Process();
            }

            Assert.IsTrue(receivedExpectedTraceData, "Expected trace data is not received");
        }

        [TestMethod]
        public void TracePXServiceIncomingOperation()
        {
            string etlFileName = "PXServiceSllWebLoggerTest_TracePXServiceIncomingOperation.etl";
            EventTraceActivity requestTraceId = new EventTraceActivity(Guid.NewGuid());
            string partner = "xbox";
            string operationName = "AddressDescription-GET";
            string[] pidlOperations = new string[]
            {
                null,
                "add",
                "validateInstance"
            };

            string[] avsSuggests = new string[]
            {
                null,
                "true",
                "false"
            };

            string accountId = "dummy-account-id";
            string payload = "{\"set_as_default_shipping_address\":false,\"set_as_default_billing_address\":false,\"is_user_entered\":false,\"customer_id\":\"18c69db8-dd2e-48a0-8887-1ccabd0bbcb2\",\"id\":\"283da942-ffbd-55a3-155a-060dd049e5fe\",\"country\":\"US\",\"region\":\"CO\",\"city\":\"Platteville\",\"address_line1\":\"PO Box 528\",\"postal_code\":\"80651-0528\",\"validate\":false,\"links\":{\"self\":{\"href\":\"18c69db8-dd2e-48a0-8887-1ccabd0bbcb2/addresses/283da942-ffbd-55a3-155a-060dd049e5fe\",\"method\":\"GET\"},\"delete\":{\"href\":\"18c69db8-dd2e-48a0-8887-1ccabd0bbcb2/addresses/283da942-ffbd-55a3-155a-060dd049e5fe\",\"method\":\"DELETE\"}},\"object_type\":\"Address\",\"resource_status\":\"Active\",\"is_customer_consented\":false,\"is_zip_plus_4_present\":true,\"etag\":\"1763102227800331261\"}";

            foreach (string operation in pidlOperations)
            {
                foreach (var avsSuggest in avsSuggests)
                {
                    using (var session = new TraceEventSession(XPertPaymentsSessionName, etlFileName))
                    {
                        session.EnableProvider(SllProviderID);
                    }

                    bool receivedExpectedTraceData = false;
                    using (var source = new ETWTraceEventSource(etlFileName))
                    {
                        var parser = new DynamicTraceEventParser(source);
                        parser.All += delegate (TraceEvent data)
                        {
                            if (string.Equals(data.EventName, "GeneralInformational/Message")
                            && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("Microsoft.Commerce.Tracing.Sll.PXServiceIncomingOperation") > 0
                            && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("Partner\":\"{0}", partner)) > 0)
                            {
                                if ((string.IsNullOrEmpty(operation) || ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("PidlOperation\":\"{0}", operation)) > 0)
                                && (string.IsNullOrEmpty(avsSuggest) || ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("AvsSuggest\":\"{0}", avsSuggest)) > 0))
                                {
                                    receivedExpectedTraceData = true;
                                }
                            }
                        };

                        source.Process();
                    }

                    Assert.IsTrue(receivedExpectedTraceData);
                }
            }
        }

        [TestMethod]
        public void TracePXServiceIncomingOperationExceedlimit()
        {
            string etlFileName = "PXServiceSllWebLoggerTest_TracePXServiceIncomingOperation.etl";
            EventTraceActivity requestTraceId = new EventTraceActivity(Guid.NewGuid());
            string partner = "xbox";
            string operationName = "AddressDescription-GET";
            string[] pidlOperations = new string[]
            {
               "validateInstance"
            };

            string[] avsSuggests = new string[]
            {
                null
            };

            string accountId = "dummy-account-id";
            string payload = "[{\"identity\":{\"description_type\":\"address\",\"operation\":\"validateInstance\",\"country\":\"US\",\"type\":\"suggested_0\",\"resource_id\":\"suggested_0\"},\"data_description\":{\"addressOperation\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"validateInstance\"},\"addressCountry\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"US\"},\"addressType\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"suggested_0\"},\"id\":{\"propertyType\":\"userData\",\"type\":\"returnObject\",\"dataType\":\"returnObject\",\"is_key\":true,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"suggested_0\",\"possible_values\":{\"suggested_0\":\"suggested_0\",\"xxxxx\":\"xxxxx\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^suggested_0$\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^suggested_0$\"}]},\"addressBillingV3\":[{\"identity\":{\"description_type\":\"address\",\"type\":\"billing_v3\",\"operation\":\"add\",\"country\":\"US\"},\"data_description\":{\"addressType\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"billing_v3\"},\"addressOperation\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"add\"},\"addressCountry\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"US\"},\"id\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_key\":false,\"is_optional\":true,\"is_updatable\":true},\"address_line1\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"1 Microsoft Way\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"}]},\"address_line2\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":true,\"is_updatable\":true,\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"}]},\"city\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"redmond\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_city\",\"error_message\":\"Incorrectly formatted city\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_city\",\"error_message\":\"Incorrectly formatted city\"}]},\"region\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"wa\",\"possible_values\":{\"al\":\"Alabama\",\"ak\":\"Alaska\",\"az\":\"Arizona\",\"ar\":\"Arkansas\",\"ae\":\"Armed Forces Africa\",\"aa\":\"Armed Forces America\",\"ap\":\"Armed Forces Pacific\",\"ca\":\"California\",\"co\":\"Colorado\",\"ct\":\"Connecticut\",\"de\":\"Delaware\",\"dc\":\"District of Columbia\",\"fl\":\"Florida\",\"ga\":\"Georgia\",\"hi\":\"Hawaii\",\"id\":\"Idaho\",\"il\":\"Illinois\",\"in\":\"Indiana\",\"ia\":\"Iowa\",\"ks\":\"Kansas\",\"ky\":\"Kentucky\",\"la\":\"Louisiana\",\"me\":\"Maine\",\"md\":\"Maryland\",\"ma\":\"Massachusetts\",\"mi\":\"Michigan\",\"mn\":\"Minnesota\",\"ms\":\"Mississippi\",\"mo\":\"Missouri\",\"mt\":\"Montana\",\"ne\":\"Nebraska\",\"nv\":\"Nevada\",\"nh\":\"New Hampshire\",\"nj\":\"New Jersey\",\"nm\":\"New Mexico\",\"ny\":\"New York\",\"nc\":\"North Carolina\",\"nd\":\"North Dakota\",\"oh\":\"Ohio\",\"ok\":\"Oklahoma\",\"or\":\"Oregon\",\"pa\":\"Pennsylvania\",\"pr\":\"Puerto Rico\",\"ri\":\"Rhode Island\",\"sc\":\"South Carolina\",\"sd\":\"South Dakota\",\"tn\":\"Tennessee\",\"tx\":\"Texas\",\"ut\":\"Utah\",\"vt\":\"Vermont\",\"va\":\"Virginia\",\"wa\":\"Washington\",\"wv\":\"West Virginia\",\"wi\":\"Wisconsin\",\"wy\":\"Wyoming\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^[A-Za-z0-9]{2,3}$\",\"error_code\":\"invalid_state\",\"error_message\":\"Incorrectly formatted state\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^[A-Za-z0-9]{2,3}$\",\"error_code\":\"invalid_state\",\"error_message\":\"Incorrectly formatted state\"}]},\"postal_code\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"98051\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^\\\\d{5}(-\\\\d{4})?$\",\"error_code\":\"invalid_zip\",\"error_message\":\"Incorrectly formatted zip\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^\\\\d{5}(-\\\\d{4})?$\",\"error_code\":\"invalid_zip\",\"error_message\":\"Incorrectly formatted zip\"}]},\"country\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":true,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"US\",\"possible_values\":{\"af\":\"Afghanistan\",\"ax\":\"\u00C5land Islands\",\"al\":\"Albania\",\"dz\":\"Algeria\",\"as\":\"American Samoa\",\"ad\":\"Andorra\",\"ao\":\"Angola\",\"ai\":\"Anguilla\",\"aq\":\"Antarctica\",\"ag\":\"Antigua and Barbuda\",\"ar\":\"Argentina\",\"am\":\"Armenia\",\"aw\":\"Aruba\",\"au\":\"Australia\",\"at\":\"Austria\",\"az\":\"Azerbaijan\",\"bs\":\"Bahamas\",\"bh\":\"Bahrain\",\"bd\":\"Bangladesh\",\"bb\":\"Barbados\",\"by\":\"Belarus\",\"be\":\"Belgium\",\"bz\":\"Belize\",\"bj\":\"Benin\",\"bm\":\"Bermuda\",\"bt\":\"Bhutan\",\"bo\":\"Bolivia\",\"bq\":\"Bonaire\",\"ba\":\"Bosnia and Herzegovina\",\"bw\":\"Botswana\",\"bv\":\"Bouvet Island\",\"br\":\"Brazil\",\"io\":\"British Indian Ocean Territory\",\"bn\":\"Brunei\",\"bg\":\"Bulgaria\",\"bf\":\"Burkina Faso\",\"bi\":\"Burundi\",\"kh\":\"Cambodia\",\"cm\":\"Cameroon\",\"ca\":\"Canada\",\"cv\":\"Cabo Verde\",\"ky\":\"Cayman Islands\",\"cf\":\"Central African Republic\",\"td\":\"Chad\",\"gg\":\"Guernsey\",\"je\":\"Jersey\",\"cl\":\"Chile\",\"cn\":\"China\",\"cx\":\"Christmas Island\",\"cc\":\"Cocos (Keeling) Islands\",\"co\":\"Colombia\",\"km\":\"Comoros\",\"cd\":\"Congo (DRC)\",\"cg\":\"Congo\",\"ck\":\"Cook Islands\",\"cr\":\"Costa Rica\",\"ci\":\"C\u00F4te d\u2019Ivoire\",\"hr\":\"Croatia\",\"cw\":\"Cura\u00E7ao\",\"cy\":\"Cyprus\",\"cz\":\"Czechia\",\"dk\":\"Denmark\",\"dj\":\"Djibouti\",\"dm\":\"Dominica\",\"do\":\"Dominican Republic\",\"ec\":\"Ecuador\",\"eg\":\"Egypt\",\"sv\":\"El Salvador\",\"gq\":\"Equatorial Guinea\",\"er\":\"Eritrea\",\"ee\":\"Estonia\",\"et\":\"Ethiopia\",\"fk\":\"Falkland Islands\",\"fo\":\"Faroe Islands\",\"fj\":\"Fiji\",\"fi\":\"Finland\",\"fr\":\"France\",\"gf\":\"French Guiana\",\"pf\":\"French Polynesia\",\"ga\":\"Gabon\",\"gm\":\"Gambia\",\"ge\":\"Georgia\",\"de\":\"Germany\",\"gh\":\"Ghana\",\"gi\":\"Gibraltar\",\"gr\":\"Greece\",\"gl\":\"Greenland\",\"gd\":\"Grenada\",\"gp\":\"Guadeloupe\",\"gu\":\"Guam\",\"gt\":\"Guatemala\",\"gn\":\"Guinea\",\"gw\":\"Guinea-Bissau\",\"gy\":\"Guyana\",\"ht\":\"Haiti\",\"hm\":\"Heard Island and McDonald Islands\",\"hn\":\"Honduras\",\"hk\":\"Hong Kong SAR\",\"hu\":\"Hungary\",\"is\":\"Iceland\",\"in\":\"India\",\"id\":\"Indonesia\",\"iq\":\"Iraq\",\"ie\":\"Ireland\",\"im\":\"Isle of Man\",\"il\":\"Israel\",\"it\":\"Italy\",\"jm\":\"Jamaica\",\"jp\":\"Japan\",\"jo\":\"Jordan\",\"kz\":\"Kazakhstan\",\"ke\":\"Kenya\",\"ki\":\"Kiribati\",\"kr\":\"Korea\",\"xk\":\"Kosovo\",\"kw\":\"Kuwait\",\"kg\":\"Kyrgyzstan\",\"la\":\"Laos\",\"lv\":\"Latvia\",\"lb\":\"Lebanon\",\"ls\":\"Lesotho\",\"lr\":\"Liberia\",\"ly\":\"Libya\",\"li\":\"Liechtenstein\",\"lt\":\"Lithuania\",\"lu\":\"Luxembourg\",\"mo\":\"Macao SAR\",\"mk\":\"North Macedonia\",\"mg\":\"Madagascar\",\"mw\":\"Malawi\",\"my\":\"Malaysia\",\"mv\":\"Maldives\",\"ml\":\"Mali\",\"mt\":\"Malta\",\"mh\":\"Marshall Islands\",\"mq\":\"Martinique\",\"mr\":\"Mauritania\",\"mu\":\"Mauritius\",\"yt\":\"Mayotte\",\"mx\":\"Mexico\",\"fm\":\"Micronesia\",\"md\":\"Moldova\",\"mc\":\"Monaco\",\"mn\":\"Mongolia\",\"me\":\"Montenegro\",\"ms\":\"Montserrat\",\"ma\":\"Morocco\",\"mz\":\"Mozambique\",\"mm\":\"Myanmar\",\"na\":\"Namibia\",\"nr\":\"Nauru\",\"np\":\"Nepal\",\"nl\":\"Netherlands\",\"nc\":\"New Caledonia\",\"nz\":\"New Zealand\",\"ni\":\"Nicaragua\",\"ne\":\"Niger\",\"ng\":\"Nigeria\",\"nu\":\"Niue\",\"nf\":\"Norfolk Island\",\"mp\":\"Northern Mariana Islands\",\"no\":\"Norway\",\"om\":\"Oman\",\"pk\":\"Pakistan\",\"pw\":\"Palau\",\"ps\":\"Palestinian Authority\",\"pa\":\"Panama\",\"pg\":\"Papua New Guinea\",\"py\":\"Paraguay\",\"pe\":\"Peru\",\"ph\":\"Philippines\",\"pn\":\"Pitcairn Islands\",\"pl\":\"Poland\",\"pt\":\"Portugal\",\"pr\":\"Puerto Rico\",\"qa\":\"Qatar\",\"re\":\"R\u00E9union\",\"ro\":\"Romania\",\"ru\":\"Russia\",\"rw\":\"Rwanda\",\"bl\":\"Saint Barth\u00E9lemy\",\"sh\":\"St Helena, Ascension, Tristan da Cunha\",\"kn\":\"Saint Kitts and Nevis\",\"lc\":\"Saint Lucia\",\"mf\":\"Saint Martin\",\"pm\":\"Saint Pierre and Miquelon\",\"vc\":\"Saint Vincent and the Grenadines\",\"ws\":\"Samoa\",\"sm\":\"San Marino\",\"st\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"sa\":\"Saudi Arabia\",\"sn\":\"Senegal\",\"rs\":\"Serbia\",\"sc\":\"Seychelles\",\"sl\":\"Sierra Leone\",\"sg\":\"Singapore\",\"sx\":\"Sint Maarten\",\"sk\":\"Slovakia\",\"si\":\"Slovenia\",\"sb\":\"Solomon Islands\",\"so\":\"Somalia\",\"za\":\"South Africa\",\"gs\":\"South Georgia and South Sandwich Islands\",\"es\":\"Spain\",\"lk\":\"Sri Lanka\",\"sr\":\"Suriname\",\"sj\":\"Svalbard\",\"sz\":\"Eswatini\",\"se\":\"Sweden\",\"ch\":\"Switzerland\",\"tw\":\"Taiwan\",\"tj\":\"Tajikistan\",\"tz\":\"Tanzania\",\"th\":\"Thailand\",\"tl\":\"Timor-Leste\",\"tg\":\"Togo\",\"tk\":\"Tokelau\",\"to\":\"Tonga\",\"tt\":\"Trinidad and Tobago\",\"tn\":\"Tunisia\",\"tr\":\"Turkey\",\"tm\":\"Turkmenistan\",\"tc\":\"Turks and Caicos Islands\",\"tv\":\"Tuvalu\",\"ug\":\"Uganda\",\"ua\":\"Ukraine\",\"ae\":\"United Arab Emirates\",\"gb\":\"United Kingdom\",\"us\":\"United States\",\"um\":\"U.S. Outlying Islands\",\"uy\":\"Uruguay\",\"uz\":\"Uzbekistan\",\"vu\":\"Vanuatu\",\"va\":\"Vatican City\",\"ve\":\"Venezuela\",\"vn\":\"Vietnam\",\"vg\":\"British Virgin Islands\",\"vi\":\"U.S. Virgin Islands\",\"wf\":\"Wallis and Futuna\",\"ye\":\"Yemen\",\"zm\":\"Zambia\",\"zw\":\"Zimbabwe\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^us|US$\",\"error_code\":\"invalid_country\",\"error_message\":\"Incorrectly formatted country\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^us|US$\",\"error_code\":\"invalid_country\",\"error_message\":\"Incorrectly formatted country\"}]}}}]},\"displayDescription\":[{\"displayName\":\"suggestedAddressesDetailsPage\",\"members\":[{\"displayContent\":\"Verify your address\",\"displayId\":\"addressSuggestionHeading\",\"displayType\":\"heading\"},{\"displayContent\":\"We couldn't validate your address. Choose the address you want to use.\",\"displayId\":\"addressSuggestionMessage\",\"displayType\":\"text\"},{\"layoutOrientation\":\"inline\",\"members\":[{\"layoutOrientation\":\"inline\",\"members\":[{\"displayName\":\"Current address\",\"showDisplayName\":\"true\",\"possibleValues\":{\"xxxxx\":\"xxxxx\"},\"possibleOptions\":{\"xxxxx\":{\"displayText\":\"xxxxx\",\"isDisabled\":false,\"displayContent\":{\"members\":[{\"displayContent\":\"1 Microsoft Way\",\"displayId\":\"address_line1_xxxxx\",\"displayType\":\"text\"},{\"displayId\":\"address_line2_xxxxx\",\"displayType\":\"text\"},{\"displayId\":\"address_line3_xxxxx\",\"displayType\":\"text\"},{\"displayContent\":\"redmond, WA\",\"displayId\":\"city_region_xxxxx\",\"displayType\":\"text\"},{\"displayContent\":\"98051\",\"displayId\":\"postal_code_xxxxx\",\"displayType\":\"text\"}],\"displayId\":\"optionAddress_xxxxx\",\"displayType\":\"group\",\"tags\":{\"address-container\":\"address-container\"}}}},\"selectType\":\"radio\",\"displayId\":\"addressEntered\",\"displayType\":\"property\",\"pidlAction\":{\"type\":\"success\",\"context\":\"\"},\"propertyName\":\"id\",\"tags\":{\"accessibilityName\":\"Current address\"}},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Change\",\"displayId\":\"addressChangeButton\",\"displayType\":\"button\",\"pidlAction\":{\"type\":\"moveNext\",\"context\":\"\"},\"tags\":{\"accessibilityName\":\"Change\",\"action-trigger\":\"action-trigger\"}}],\"displayId\":\"addressChangeGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressEnteredGroup\",\"displayType\":\"group\"},{\"displayName\":\"We suggest\",\"showDisplayName\":\"true\",\"possibleValues\":{\"suggested_0\":\"suggested_0\"},\"possibleOptions\":{\"suggested_0\":{\"displayText\":\"suggested_0\",\"isDisabled\":false,\"displayContent\":{\"members\":[{\"displayContent\":\"1 Microsoft Way\",\"displayId\":\"address_line1_suggested_0\",\"displayType\":\"text\"},{\"displayId\":\"address_line2_suggested_0\",\"displayType\":\"text\"},{\"displayId\":\"address_line3_suggested_0\",\"displayType\":\"text\"},{\"displayContent\":\"Redmond, WA\",\"displayId\":\"city_region_suggested_0\",\"displayType\":\"text\"},{\"displayContent\":\"98052-8300\",\"displayId\":\"postal_code_suggested_0\",\"displayType\":\"text\"}],\"displayId\":\"optionAddress_suggested_0\",\"displayType\":\"group\",\"tags\":{\"address-container\":\"address-container\"}}}},\"selectType\":\"radio\",\"displayId\":\"addressSuggested\",\"displayType\":\"property\",\"pidlAction\":{\"type\":\"success\",\"context\":\"\"},\"propertyName\":\"id\",\"tags\":{\"accessibilityName\":\"We suggest\"}}],\"displayId\":\"addressOptionsGroup\",\"displayType\":\"group\"},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Use this address\",\"displayId\":\"addressUseButton\",\"displayType\":\"button\",\"isHighlighted\":true,\"pidlAction\":{\"type\":\"restAction\",\"isDefault\":true,\"context\":{\"href\":\"https://{pifd-endpoint}/users/{userId}/addressesEx?partner=amcweb&language=en-US&avsSuggest=False\",\"method\":\"POST\",\"payload\":{\"set_as_default_shipping_address\":false,\"set_as_default_billing_address\":false,\"is_user_entered\":false,\"id\":\"suggested_0\",\"country\":\"US\",\"region\":\"WA\",\"city\":\"Redmond\",\"address_line1\":\"1 Microsoft Way\",\"postal_code\":\"98052-8300\",\"last_name\":\"testName\",\"phone_number\":\"4255382416\"}}},\"tags\":{\"accessibilityName\":\"Use this address\"}}],\"displayId\":\"addressUseCloseGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressSuggestionPage1\",\"displayType\":\"page\"},{\"displayName\":\"AddressDetailsPage\",\"members\":[{\"displayContent\":\"Change your address\",\"displayId\":\"addressChangePageHeading\",\"displayType\":\"heading\"},{\"displayContent\":\"This address will be saved with your Microsoft account.\",\"displayId\":\"addressChangePageSubheading\",\"displayType\":\"text\"},{\"members\":[{\"displayName\":\"Address line 1\",\"showDisplayName\":\"true\",\"minLength\":25,\"maxLength\":30,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted address\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Address line 1 is a required field\"}]},\"displayId\":\"addressLine1\",\"displayType\":\"property\",\"propertyName\":\"address_line1\",\"tags\":{\"accessibilityName\":\"Address line 1\"}},{\"displayName\":\"Address line 2 (Optional)\",\"showDisplayName\":\"true\",\"minLength\":25,\"maxLength\":30,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted address\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Address line 2 is a required field\"}]},\"displayId\":\"addressLine2\",\"displayType\":\"property\",\"propertyName\":\"address_line2\",\"tags\":{\"accessibilityName\":\"Address line 2 (Optional)\"}},{\"displayName\":\"City\",\"showDisplayName\":\"true\",\"maxLength\":26,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted city\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"City is a required field\"}]},\"displayId\":\"addressCity\",\"displayType\":\"property\",\"propertyName\":\"city\",\"tags\":{\"accessibilityName\":\"City\"}},{\"displayName\":\"State\",\"showDisplayName\":\"true\",\"possibleValues\":{\"al\":\"Alabama\",\"ak\":\"Alaska\",\"az\":\"Arizona\",\"ar\":\"Arkansas\",\"ae\":\"Armed Forces Africa\",\"aa\":\"Armed Forces America\",\"ap\":\"Armed Forces Pacific\",\"ca\":\"California\",\"co\":\"Colorado\",\"ct\":\"Connecticut\",\"de\":\"Delaware\",\"dc\":\"District of Columbia\",\"fl\":\"Florida\",\"ga\":\"Georgia\",\"hi\":\"Hawaii\",\"id\":\"Idaho\",\"il\":\"Illinois\",\"in\":\"Indiana\",\"ia\":\"Iowa\",\"ks\":\"Kansas\",\"ky\":\"Kentucky\",\"la\":\"Louisiana\",\"me\":\"Maine\",\"md\":\"Maryland\",\"ma\":\"Massachusetts\",\"mi\":\"Michigan\",\"mn\":\"Minnesota\",\"ms\":\"Mississippi\",\"mo\":\"Missouri\",\"mt\":\"Montana\",\"ne\":\"Nebraska\",\"nv\":\"Nevada\",\"nh\":\"New Hampshire\",\"nj\":\"New Jersey\",\"nm\":\"New Mexico\",\"ny\":\"New York\",\"nc\":\"North Carolina\",\"nd\":\"North Dakota\",\"oh\":\"Ohio\",\"ok\":\"Oklahoma\",\"or\":\"Oregon\",\"pa\":\"Pennsylvania\",\"pr\":\"Puerto Rico\",\"ri\":\"Rhode Island\",\"sc\":\"South Carolina\",\"sd\":\"South Dakota\",\"tn\":\"Tennessee\",\"tx\":\"Texas\",\"ut\":\"Utah\",\"vt\":\"Vermont\",\"va\":\"Virginia\",\"wa\":\"Washington\",\"wv\":\"West Virginia\",\"wi\":\"Wisconsin\",\"wy\":\"Wyoming\"},\"possibleOptions\":{\"al\":{\"displayText\":\"Alabama\",\"isDisabled\":false},\"ak\":{\"displayText\":\"Alaska\",\"isDisabled\":false},\"az\":{\"displayText\":\"Arizona\",\"isDisabled\":false},\"ar\":{\"displayText\":\"Arkansas\",\"isDisabled\":false},\"ae\":{\"displayText\":\"Armed Forces Africa\",\"isDisabled\":false},\"aa\":{\"displayText\":\"Armed Forces America\",\"isDisabled\":false},\"ap\":{\"displayText\":\"Armed Forces Pacific\",\"isDisabled\":false},\"ca\":{\"displayText\":\"California\",\"isDisabled\":false},\"co\":{\"displayText\":\"Colorado\",\"isDisabled\":false},\"ct\":{\"displayText\":\"Connecticut\",\"isDisabled\":false},\"de\":{\"displayText\":\"Delaware\",\"isDisabled\":false},\"dc\":{\"displayText\":\"District of Columbia\",\"isDisabled\":false},\"fl\":{\"displayText\":\"Florida\",\"isDisabled\":false},\"ga\":{\"displayText\":\"Georgia\",\"isDisabled\":false},\"hi\":{\"displayText\":\"Hawaii\",\"isDisabled\":false},\"id\":{\"displayText\":\"Idaho\",\"isDisabled\":false},\"il\":{\"displayText\":\"Illinois\",\"isDisabled\":false},\"in\":{\"displayText\":\"Indiana\",\"isDisabled\":false},\"ia\":{\"displayText\":\"Iowa\",\"isDisabled\":false},\"ks\":{\"displayText\":\"Kansas\",\"isDisabled\":false},\"ky\":{\"displayText\":\"Kentucky\",\"isDisabled\":false},\"la\":{\"displayText\":\"Louisiana\",\"isDisabled\":false},\"me\":{\"displayText\":\"Maine\",\"isDisabled\":false},\"md\":{\"displayText\":\"Maryland\",\"isDisabled\":false},\"ma\":{\"displayText\":\"Massachusetts\",\"isDisabled\":false},\"mi\":{\"displayText\":\"Michigan\",\"isDisabled\":false},\"mn\":{\"displayText\":\"Minnesota\",\"isDisabled\":false},\"ms\":{\"displayText\":\"Mississippi\",\"isDisabled\":false},\"mo\":{\"displayText\":\"Missouri\",\"isDisabled\":false},\"mt\":{\"displayText\":\"Montana\",\"isDisabled\":false},\"ne\":{\"displayText\":\"Nebraska\",\"isDisabled\":false},\"nv\":{\"displayText\":\"Nevada\",\"isDisabled\":false},\"nh\":{\"displayText\":\"New Hampshire\",\"isDisabled\":false},\"nj\":{\"displayText\":\"New Jersey\",\"isDisabled\":false},\"nm\":{\"displayText\":\"New Mexico\",\"isDisabled\":false},\"ny\":{\"displayText\":\"New York\",\"isDisabled\":false},\"nc\":{\"displayText\":\"North Carolina\",\"isDisabled\":false},\"nd\":{\"displayText\":\"North Dakota\",\"isDisabled\":false},\"oh\":{\"displayText\":\"Ohio\",\"isDisabled\":false},\"ok\":{\"displayText\":\"Oklahoma\",\"isDisabled\":false},\"or\":{\"displayText\":\"Oregon\",\"isDisabled\":false},\"pa\":{\"displayText\":\"Pennsylvania\",\"isDisabled\":false},\"pr\":{\"displayText\":\"Puerto Rico\",\"isDisabled\":false},\"ri\":{\"displayText\":\"Rhode Island\",\"isDisabled\":false},\"sc\":{\"displayText\":\"South Carolina\",\"isDisabled\":false},\"sd\":{\"displayText\":\"South Dakota\",\"isDisabled\":false},\"tn\":{\"displayText\":\"Tennessee\",\"isDisabled\":false},\"tx\":{\"displayText\":\"Texas\",\"isDisabled\":false},\"ut\":{\"displayText\":\"Utah\",\"isDisabled\":false},\"vt\":{\"displayText\":\"Vermont\",\"isDisabled\":false},\"va\":{\"displayText\":\"Virginia\",\"isDisabled\":false},\"wa\":{\"displayText\":\"Washington\",\"isDisabled\":false},\"wv\":{\"displayText\":\"West Virginia\",\"isDisabled\":false},\"wi\":{\"displayText\":\"Wisconsin\",\"isDisabled\":false},\"wy\":{\"displayText\":\"Wyoming\",\"isDisabled\":false}},\"displaySelectionText\":\"--Select--\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted state\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"State is a required field\"}]},\"displayId\":\"addressState\",\"displayType\":\"property\",\"propertyName\":\"region\",\"tags\":{\"theme\":\"windows\",\"accessibilityName\":\"State\"}},{\"displayName\":\"ZIP code\",\"showDisplayName\":\"true\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted ZIP code\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"ZIP Code is a required field\"}]},\"displayId\":\"addressPostalCode\",\"displayType\":\"property\",\"propertyName\":\"postal_code\",\"tags\":{\"accessibilityName\":\"ZIP code\"}},{\"displayName\":\"Country/Region\",\"showDisplayName\":\"true\",\"possibleValues\":{\"af\":\"Afghanistan\",\"ax\":\"\u00C5land Islands\",\"al\":\"Albania\",\"dz\":\"Algeria\",\"as\":\"American Samoa\",\"ad\":\"Andorra\",\"ao\":\"Angola\",\"ai\":\"Anguilla\",\"aq\":\"Antarctica\",\"ag\":\"Antigua and Barbuda\",\"ar\":\"Argentina\",\"am\":\"Armenia\",\"aw\":\"Aruba\",\"au\":\"Australia\",\"at\":\"Austria\",\"az\":\"Azerbaijan\",\"bs\":\"Bahamas\",\"bh\":\"Bahrain\",\"bd\":\"Bangladesh\",\"bb\":\"Barbados\",\"by\":\"Belarus\",\"be\":\"Belgium\",\"bz\":\"Belize\",\"bj\":\"Benin\",\"bm\":\"Bermuda\",\"bt\":\"Bhutan\",\"bo\":\"Bolivia\",\"bq\":\"Bonaire\",\"ba\":\"Bosnia and Herzegovina\",\"bw\":\"Botswana\",\"bv\":\"Bouvet Island\",\"br\":\"Brazil\",\"io\":\"British Indian Ocean Territory\",\"bn\":\"Brunei\",\"bg\":\"Bulgaria\",\"bf\":\"Burkina Faso\",\"bi\":\"Burundi\",\"kh\":\"Cambodia\",\"cm\":\"Cameroon\",\"ca\":\"Canada\",\"cv\":\"Cabo Verde\",\"ky\":\"Cayman Islands\",\"cf\":\"Central African Republic\",\"td\":\"Chad\",\"gg\":\"Guernsey\",\"je\":\"Jersey\",\"cl\":\"Chile\",\"cn\":\"China\",\"cx\":\"Christmas Island\",\"cc\":\"Cocos (Keeling) Islands\",\"co\":\"Colombia\",\"km\":\"Comoros\",\"cd\":\"Congo (DRC)\",\"cg\":\"Congo\",\"ck\":\"Cook Islands\",\"cr\":\"Costa Rica\",\"ci\":\"C\u00F4te d\u2019Ivoire\",\"hr\":\"Croatia\",\"cw\":\"Cura\u00E7ao\",\"cy\":\"Cyprus\",\"cz\":\"Czechia\",\"dk\":\"Denmark\",\"dj\":\"Djibouti\",\"dm\":\"Dominica\",\"do\":\"Dominican Republic\",\"ec\":\"Ecuador\",\"eg\":\"Egypt\",\"sv\":\"El Salvador\",\"gq\":\"Equatorial Guinea\",\"er\":\"Eritrea\",\"ee\":\"Estonia\",\"et\":\"Ethiopia\",\"fk\":\"Falkland Islands\",\"fo\":\"Faroe Islands\",\"fj\":\"Fiji\",\"fi\":\"Finland\",\"fr\":\"France\",\"gf\":\"French Guiana\",\"pf\":\"French Polynesia\",\"ga\":\"Gabon\",\"gm\":\"Gambia\",\"ge\":\"Georgia\",\"de\":\"Germany\",\"gh\":\"Ghana\",\"gi\":\"Gibraltar\",\"gr\":\"Greece\",\"gl\":\"Greenland\",\"gd\":\"Grenada\",\"gp\":\"Guadeloupe\",\"gu\":\"Guam\",\"gt\":\"Guatemala\",\"gn\":\"Guinea\",\"gw\":\"Guinea-Bissau\",\"gy\":\"Guyana\",\"ht\":\"Haiti\",\"hm\":\"Heard Island and McDonald Islands\",\"hn\":\"Honduras\",\"hk\":\"Hong Kong SAR\",\"hu\":\"Hungary\",\"is\":\"Iceland\",\"in\":\"India\",\"id\":\"Indonesia\",\"iq\":\"Iraq\",\"ie\":\"Ireland\",\"im\":\"Isle of Man\",\"il\":\"Israel\",\"it\":\"Italy\",\"jm\":\"Jamaica\",\"jp\":\"Japan\",\"jo\":\"Jordan\",\"kz\":\"Kazakhstan\",\"ke\":\"Kenya\",\"ki\":\"Kiribati\",\"kr\":\"Korea\",\"xk\":\"Kosovo\",\"kw\":\"Kuwait\",\"kg\":\"Kyrgyzstan\",\"la\":\"Laos\",\"lv\":\"Latvia\",\"lb\":\"Lebanon\",\"ls\":\"Lesotho\",\"lr\":\"Liberia\",\"ly\":\"Libya\",\"li\":\"Liechtenstein\",\"lt\":\"Lithuania\",\"lu\":\"Luxembourg\",\"mo\":\"Macao SAR\",\"mk\":\"North Macedonia\",\"mg\":\"Madagascar\",\"mw\":\"Malawi\",\"my\":\"Malaysia\",\"mv\":\"Maldives\",\"ml\":\"Mali\",\"mt\":\"Malta\",\"mh\":\"Marshall Islands\",\"mq\":\"Martinique\",\"mr\":\"Mauritania\",\"mu\":\"Mauritius\",\"yt\":\"Mayotte\",\"mx\":\"Mexico\",\"fm\":\"Micronesia\",\"md\":\"Moldova\",\"mc\":\"Monaco\",\"mn\":\"Mongolia\",\"me\":\"Montenegro\",\"ms\":\"Montserrat\",\"ma\":\"Morocco\",\"mz\":\"Mozambique\",\"mm\":\"Myanmar\",\"na\":\"Namibia\",\"nr\":\"Nauru\",\"np\":\"Nepal\",\"nl\":\"Netherlands\",\"nc\":\"New Caledonia\",\"nz\":\"New Zealand\",\"ni\":\"Nicaragua\",\"ne\":\"Niger\",\"ng\":\"Nigeria\",\"nu\":\"Niue\",\"nf\":\"Norfolk Island\",\"mp\":\"Northern Mariana Islands\",\"no\":\"Norway\",\"om\":\"Oman\",\"pk\":\"Pakistan\",\"pw\":\"Palau\",\"ps\":\"Palestinian Authority\",\"pa\":\"Panama\",\"pg\":\"Papua New Guinea\",\"py\":\"Paraguay\",\"pe\":\"Peru\",\"ph\":\"Philippines\",\"pn\":\"Pitcairn Islands\",\"pl\":\"Poland\",\"pt\":\"Portugal\",\"pr\":\"Puerto Rico\",\"qa\":\"Qatar\",\"re\":\"R\u00E9union\",\"ro\":\"Romania\",\"ru\":\"Russia\",\"rw\":\"Rwanda\",\"bl\":\"Saint Barth\u00E9lemy\",\"sh\":\"St Helena, Ascension, Tristan da Cunha\",\"kn\":\"Saint Kitts and Nevis\",\"lc\":\"Saint Lucia\",\"mf\":\"Saint Martin\",\"pm\":\"Saint Pierre and Miquelon\",\"vc\":\"Saint Vincent and the Grenadines\",\"ws\":\"Samoa\",\"sm\":\"San Marino\",\"st\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"sa\":\"Saudi Arabia\",\"sn\":\"Senegal\",\"rs\":\"Serbia\",\"sc\":\"Seychelles\",\"sl\":\"Sierra Leone\",\"sg\":\"Singapore\",\"sx\":\"Sint Maarten\",\"sk\":\"Slovakia\",\"si\":\"Slovenia\",\"sb\":\"Solomon Islands\",\"so\":\"Somalia\",\"za\":\"South Africa\",\"gs\":\"South Georgia and South Sandwich Islands\",\"es\":\"Spain\",\"lk\":\"Sri Lanka\",\"sr\":\"Suriname\",\"sj\":\"Svalbard\",\"sz\":\"Eswatini\",\"se\":\"Sweden\",\"ch\":\"Switzerland\",\"tw\":\"Taiwan\",\"tj\":\"Tajikistan\",\"tz\":\"Tanzania\",\"th\":\"Thailand\",\"tl\":\"Timor-Leste\",\"tg\":\"Togo\",\"tk\":\"Tokelau\",\"to\":\"Tonga\",\"tt\":\"Trinidad and Tobago\",\"tn\":\"Tunisia\",\"tr\":\"Turkey\",\"tm\":\"Turkmenistan\",\"tc\":\"Turks and Caicos Islands\",\"tv\":\"Tuvalu\",\"ug\":\"Uganda\",\"ua\":\"Ukraine\",\"ae\":\"United Arab Emirates\",\"gb\":\"United Kingdom\",\"us\":\"United States\",\"um\":\"U.S. Outlying Islands\",\"uy\":\"Uruguay\",\"uz\":\"Uzbekistan\",\"vu\":\"Vanuatu\",\"va\":\"Vatican City\",\"ve\":\"Venezuela\",\"vn\":\"Vietnam\",\"vg\":\"British Virgin Islands\",\"vi\":\"U.S. Virgin Islands\",\"wf\":\"Wallis and Futuna\",\"ye\":\"Yemen\",\"zm\":\"Zambia\",\"zw\":\"Zimbabwe\"},\"possibleOptions\":{\"af\":{\"displayText\":\"Afghanistan\",\"isDisabled\":false},\"ax\":{\"displayText\":\"\u00C5land Islands\",\"isDisabled\":false},\"al\":{\"displayText\":\"Albania\",\"isDisabled\":false},\"dz\":{\"displayText\":\"Algeria\",\"isDisabled\":false},\"as\":{\"displayText\":\"American Samoa\",\"isDisabled\":false},\"ad\":{\"displayText\":\"Andorra\",\"isDisabled\":false},\"ao\":{\"displayText\":\"Angola\",\"isDisabled\":false},\"ai\":{\"displayText\":\"Anguilla\",\"isDisabled\":false},\"aq\":{\"displayText\":\"Antarctica\",\"isDisabled\":false},\"ag\":{\"displayText\":\"Antigua and Barbuda\",\"isDisabled\":false},\"ar\":{\"displayText\":\"Argentina\",\"isDisabled\":false},\"am\":{\"displayText\":\"Armenia\",\"isDisabled\":false},\"aw\":{\"displayText\":\"Aruba\",\"isDisabled\":false},\"au\":{\"displayText\":\"Australia\",\"isDisabled\":false},\"at\":{\"displayText\":\"Austria\",\"isDisabled\":false},\"az\":{\"displayText\":\"Azerbaijan\",\"isDisabled\":false},\"bs\":{\"displayText\":\"Bahamas\",\"isDisabled\":false},\"bh\":{\"displayText\":\"Bahrain\",\"isDisabled\":false},\"bd\":{\"displayText\":\"Bangladesh\",\"isDisabled\":false},\"bb\":{\"displayText\":\"Barbados\",\"isDisabled\":false},\"by\":{\"displayText\":\"Belarus\",\"isDisabled\":false},\"be\":{\"displayText\":\"Belgium\",\"isDisabled\":false},\"bz\":{\"displayText\":\"Belize\",\"isDisabled\":false},\"bj\":{\"displayText\":\"Benin\",\"isDisabled\":false},\"bm\":{\"displayText\":\"Bermuda\",\"isDisabled\":false},\"bt\":{\"displayText\":\"Bhutan\",\"isDisabled\":false},\"bo\":{\"displayText\":\"Bolivia\",\"isDisabled\":false},\"bq\":{\"displayText\":\"Bonaire\",\"isDisabled\":false},\"ba\":{\"displayText\":\"Bosnia and Herzegovina\",\"isDisabled\":false},\"bw\":{\"displayText\":\"Botswana\",\"isDisabled\":false},\"bv\":{\"displayText\":\"Bouvet Island\",\"isDisabled\":false},\"br\":{\"displayText\":\"Brazil\",\"isDisabled\":false},\"io\":{\"displayText\":\"British Indian Ocean Territory\",\"isDisabled\":false},\"bn\":{\"displayText\":\"Brunei\",\"isDisabled\":false},\"bg\":{\"displayText\":\"Bulgaria\",\"isDisabled\":false},\"bf\":{\"displayText\":\"Burkina Faso\",\"isDisabled\":false},\"bi\":{\"displayText\":\"Burundi\",\"isDisabled\":false},\"kh\":{\"displayText\":\"Cambodia\",\"isDisabled\":false},\"cm\":{\"displayText\":\"Cameroon\",\"isDisabled\":false},\"ca\":{\"displayText\":\"Canada\",\"isDisabled\":false},\"cv\":{\"displayText\":\"Cabo Verde\",\"isDisabled\":false},\"ky\":{\"displayText\":\"Cayman Islands\",\"isDisabled\":false},\"cf\":{\"displayText\":\"Central African Republic\",\"isDisabled\":false},\"td\":{\"displayText\":\"Chad\",\"isDisabled\":false},\"gg\":{\"displayText\":\"Guernsey\",\"isDisabled\":false},\"je\":{\"displayText\":\"Jersey\",\"isDisabled\":false},\"cl\":{\"displayText\":\"Chile\",\"isDisabled\":false},\"cn\":{\"displayText\":\"China\",\"isDisabled\":false},\"cx\":{\"displayText\":\"Christmas Island\",\"isDisabled\":false},\"cc\":{\"displayText\":\"Cocos (Keeling) Islands\",\"isDisabled\":false},\"co\":{\"displayText\":\"Colombia\",\"isDisabled\":false},\"km\":{\"displayText\":\"Comoros\",\"isDisabled\":false},\"cd\":{\"displayText\":\"Congo (DRC)\",\"isDisabled\":false},\"cg\":{\"displayText\":\"Congo\",\"isDisabled\":false},\"ck\":{\"displayText\":\"Cook Islands\",\"isDisabled\":false},\"cr\":{\"displayText\":\"Costa Rica\",\"isDisabled\":false},\"ci\":{\"displayText\":\"C\u00F4te d\u2019Ivoire\",\"isDisabled\":false},\"hr\":{\"displayText\":\"Croatia\",\"isDisabled\":false},\"cw\":{\"displayText\":\"Cura\u00E7ao\",\"isDisabled\":false},\"cy\":{\"displayText\":\"Cyprus\",\"isDisabled\":false},\"cz\":{\"displayText\":\"Czechia\",\"isDisabled\":false},\"dk\":{\"displayText\":\"Denmark\",\"isDisabled\":false},\"dj\":{\"displayText\":\"Djibouti\",\"isDisabled\":false},\"dm\":{\"displayText\":\"Dominica\",\"isDisabled\":false},\"do\":{\"displayText\":\"Dominican Republic\",\"isDisabled\":false},\"ec\":{\"displayText\":\"Ecuador\",\"isDisabled\":false},\"eg\":{\"displayText\":\"Egypt\",\"isDisabled\":false},\"sv\":{\"displayText\":\"El Salvador\",\"isDisabled\":false},\"gq\":{\"displayText\":\"Equatorial Guinea\",\"isDisabled\":false},\"er\":{\"displayText\":\"Eritrea\",\"isDisabled\":false},\"ee\":{\"displayText\":\"Estonia\",\"isDisabled\":false},\"et\":{\"displayText\":\"Ethiopia\",\"isDisabled\":false},\"fk\":{\"displayText\":\"Falkland Islands\",\"isDisabled\":false},\"fo\":{\"displayText\":\"Faroe Islands\",\"isDisabled\":false},\"fj\":{\"displayText\":\"Fiji\",\"isDisabled\":false},\"fi\":{\"displayText\":\"Finland\",\"isDisabled\":false},\"fr\":{\"displayText\":\"France\",\"isDisabled\":false},\"gf\":{\"displayText\":\"French Guiana\",\"isDisabled\":false},\"pf\":{\"displayText\":\"French Polynesia\",\"isDisabled\":false},\"ga\":{\"displayText\":\"Gabon\",\"isDisabled\":false},\"gm\":{\"displayText\":\"Gambia\",\"isDisabled\":false},\"ge\":{\"displayText\":\"Georgia\",\"isDisabled\":false},\"de\":{\"displayText\":\"Germany\",\"isDisabled\":false},\"gh\":{\"displayText\":\"Ghana\",\"isDisabled\":false},\"gi\":{\"displayText\":\"Gibraltar\",\"isDisabled\":false},\"gr\":{\"displayText\":\"Greece\",\"isDisabled\":false},\"gl\":{\"displayText\":\"Greenland\",\"isDisabled\":false},\"gd\":{\"displayText\":\"Grenada\",\"isDisabled\":false},\"gp\":{\"displayText\":\"Guadeloupe\",\"isDisabled\":false},\"gu\":{\"displayText\":\"Guam\",\"isDisabled\":false},\"gt\":{\"displayText\":\"Guatemala\",\"isDisabled\":false},\"gn\":{\"displayText\":\"Guinea\",\"isDisabled\":false},\"gw\":{\"displayText\":\"Guinea-Bissau\",\"isDisabled\":false},\"gy\":{\"displayText\":\"Guyana\",\"isDisabled\":false},\"ht\":{\"displayText\":\"Haiti\",\"isDisabled\":false},\"hm\":{\"displayText\":\"Heard Island and McDonald Islands\",\"isDisabled\":false},\"hn\":{\"displayText\":\"Honduras\",\"isDisabled\":false},\"hk\":{\"displayText\":\"Hong Kong SAR\",\"isDisabled\":false},\"hu\":{\"displayText\":\"Hungary\",\"isDisabled\":false},\"is\":{\"displayText\":\"Iceland\",\"isDisabled\":false},\"in\":{\"displayText\":\"India\",\"isDisabled\":false},\"id\":{\"displayText\":\"Indonesia\",\"isDisabled\":false},\"iq\":{\"displayText\":\"Iraq\",\"isDisabled\":false},\"ie\":{\"displayText\":\"Ireland\",\"isDisabled\":false},\"im\":{\"displayText\":\"Isle of Man\",\"isDisabled\":false},\"il\":{\"displayText\":\"Israel\",\"isDisabled\":false},\"it\":{\"displayText\":\"Italy\",\"isDisabled\":false},\"jm\":{\"displayText\":\"Jamaica\",\"isDisabled\":false},\"jp\":{\"displayText\":\"Japan\",\"isDisabled\":false},\"jo\":{\"displayText\":\"Jordan\",\"isDisabled\":false},\"kz\":{\"displayText\":\"Kazakhstan\",\"isDisabled\":false},\"ke\":{\"displayText\":\"Kenya\",\"isDisabled\":false},\"ki\":{\"displayText\":\"Kiribati\",\"isDisabled\":false},\"kr\":{\"displayText\":\"Korea\",\"isDisabled\":false},\"xk\":{\"displayText\":\"Kosovo\",\"isDisabled\":false},\"kw\":{\"displayText\":\"Kuwait\",\"isDisabled\":false},\"kg\":{\"displayText\":\"Kyrgyzstan\",\"isDisabled\":false},\"la\":{\"displayText\":\"Laos\",\"isDisabled\":false},\"lv\":{\"displayText\":\"Latvia\",\"isDisabled\":false},\"lb\":{\"displayText\":\"Lebanon\",\"isDisabled\":false},\"ls\":{\"displayText\":\"Lesotho\",\"isDisabled\":false},\"lr\":{\"displayText\":\"Liberia\",\"isDisabled\":false},\"ly\":{\"displayText\":\"Libya\",\"isDisabled\":false},\"li\":{\"displayText\":\"Liechtenstein\",\"isDisabled\":false},\"lt\":{\"displayText\":\"Lithuania\",\"isDisabled\":false},\"lu\":{\"displayText\":\"Luxembourg\",\"isDisabled\":false},\"mo\":{\"displayText\":\"Macao SAR\",\"isDisabled\":false},\"mk\":{\"displayText\":\"North Macedonia\",\"isDisabled\":false},\"mg\":{\"displayText\":\"Madagascar\",\"isDisabled\":false},\"mw\":{\"displayText\":\"Malawi\",\"isDisabled\":false},\"my\":{\"displayText\":\"Malaysia\",\"isDisabled\":false},\"mv\":{\"displayText\":\"Maldives\",\"isDisabled\":false},\"ml\":{\"displayText\":\"Mali\",\"isDisabled\":false},\"mt\":{\"displayText\":\"Malta\",\"isDisabled\":false},\"mh\":{\"displayText\":\"Marshall Islands\",\"isDisabled\":false},\"mq\":{\"displayText\":\"Martinique\",\"isDisabled\":false},\"mr\":{\"displayText\":\"Mauritania\",\"isDisabled\":false},\"mu\":{\"displayText\":\"Mauritius\",\"isDisabled\":false},\"yt\":{\"displayText\":\"Mayotte\",\"isDisabled\":false},\"mx\":{\"displayText\":\"Mexico\",\"isDisabled\":false},\"fm\":{\"displayText\":\"Micronesia\",\"isDisabled\":false},\"md\":{\"displayText\":\"Moldova\",\"isDisabled\":false},\"mc\":{\"displayText\":\"Monaco\",\"isDisabled\":false},\"mn\":{\"displayText\":\"Mongolia\",\"isDisabled\":false},\"me\":{\"displayText\":\"Montenegro\",\"isDisabled\":false},\"ms\":{\"displayText\":\"Montserrat\",\"isDisabled\":false},\"ma\":{\"displayText\":\"Morocco\",\"isDisabled\":false},\"mz\":{\"displayText\":\"Mozambique\",\"isDisabled\":false},\"mm\":{\"displayText\":\"Myanmar\",\"isDisabled\":false},\"na\":{\"displayText\":\"Namibia\",\"isDisabled\":false},\"nr\":{\"displayText\":\"Nauru\",\"isDisabled\":false},\"np\":{\"displayText\":\"Nepal\",\"isDisabled\":false},\"nl\":{\"displayText\":\"Netherlands\",\"isDisabled\":false},\"nc\":{\"displayText\":\"New Caledonia\",\"isDisabled\":false},\"nz\":{\"displayText\":\"New Zealand\",\"isDisabled\":false},\"ni\":{\"displayText\":\"Nicaragua\",\"isDisabled\":false},\"ne\":{\"displayText\":\"Niger\",\"isDisabled\":false},\"ng\":{\"displayText\":\"Nigeria\",\"isDisabled\":false},\"nu\":{\"displayText\":\"Niue\",\"isDisabled\":false},\"nf\":{\"displayText\":\"Norfolk Island\",\"isDisabled\":false},\"mp\":{\"displayText\":\"Northern Mariana Islands\",\"isDisabled\":false},\"no\":{\"displayText\":\"Norway\",\"isDisabled\":false},\"om\":{\"displayText\":\"Oman\",\"isDisabled\":false},\"pk\":{\"displayText\":\"Pakistan\",\"isDisabled\":false},\"pw\":{\"displayText\":\"Palau\",\"isDisabled\":false},\"ps\":{\"displayText\":\"Palestinian Authority\",\"isDisabled\":false},\"pa\":{\"displayText\":\"Panama\",\"isDisabled\":false},\"pg\":{\"displayText\":\"Papua New Guinea\",\"isDisabled\":false},\"py\":{\"displayText\":\"Paraguay\",\"isDisabled\":false},\"pe\":{\"displayText\":\"Peru\",\"isDisabled\":false},\"ph\":{\"displayText\":\"Philippines\",\"isDisabled\":false},\"pn\":{\"displayText\":\"Pitcairn Islands\",\"isDisabled\":false},\"pl\":{\"displayText\":\"Poland\",\"isDisabled\":false},\"pt\":{\"displayText\":\"Portugal\",\"isDisabled\":false},\"pr\":{\"displayText\":\"Puerto Rico\",\"isDisabled\":false},\"qa\":{\"displayText\":\"Qatar\",\"isDisabled\":false},\"re\":{\"displayText\":\"R\u00E9union\",\"isDisabled\":false},\"ro\":{\"displayText\":\"Romania\",\"isDisabled\":false},\"ru\":{\"displayText\":\"Russia\",\"isDisabled\":false},\"rw\":{\"displayText\":\"Rwanda\",\"isDisabled\":false},\"bl\":{\"displayText\":\"Saint Barth\u00E9lemy\",\"isDisabled\":false},\"sh\":{\"displayText\":\"St Helena, Ascension, Tristan da Cunha\",\"isDisabled\":false},\"kn\":{\"displayText\":\"Saint Kitts and Nevis\",\"isDisabled\":false},\"lc\":{\"displayText\":\"Saint Lucia\",\"isDisabled\":false},\"mf\":{\"displayText\":\"Saint Martin\",\"isDisabled\":false},\"pm\":{\"displayText\":\"Saint Pierre and Miquelon\",\"isDisabled\":false},\"vc\":{\"displayText\":\"Saint Vincent and the Grenadines\",\"isDisabled\":false},\"ws\":{\"displayText\":\"Samoa\",\"isDisabled\":false},\"sm\":{\"displayText\":\"San Marino\",\"isDisabled\":false},\"st\":{\"displayText\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"isDisabled\":false},\"sa\":{\"displayText\":\"Saudi Arabia\",\"isDisabled\":false},\"sn\":{\"displayText\":\"Senegal\",\"isDisabled\":false},\"rs\":{\"displayText\":\"Serbia\",\"isDisabled\":false},\"sc\":{\"displayText\":\"Seychelles\",\"isDisabled\":false},\"sl\":{\"displayText\":\"Sierra Leone\",\"isDisabled\":false},\"sg\":{\"displayText\":\"Singapore\",\"isDisabled\":false},\"sx\":{\"displayText\":\"Sint Maarten\",\"isDisabled\":false},\"sk\":{\"displayText\":\"Slovakia\",\"isDisabled\":false},\"si\":{\"displayText\":\"Slovenia\",\"isDisabled\":false},\"sb\":{\"displayText\":\"Solomon Islands\",\"isDisabled\":false},\"so\":{\"displayText\":\"Somalia\",\"isDisabled\":false},\"za\":{\"displayText\":\"South Africa\",\"isDisabled\":false},\"gs\":{\"displayText\":\"South Georgia and South Sandwich Islands\",\"isDisabled\":false},\"es\":{\"displayText\":\"Spain\",\"isDisabled\":false},\"lk\":{\"displayText\":\"Sri Lanka\",\"isDisabled\":false},\"sr\":{\"displayText\":\"Suriname\",\"isDisabled\":false},\"sj\":{\"displayText\":\"Svalbard\",\"isDisabled\":false},\"sz\":{\"displayText\":\"Eswatini\",\"isDisabled\":false},\"se\":{\"displayText\":\"Sweden\",\"isDisabled\":false},\"ch\":{\"displayText\":\"Switzerland\",\"isDisabled\":false},\"tw\":{\"displayText\":\"Taiwan\",\"isDisabled\":false},\"tj\":{\"displayText\":\"Tajikistan\",\"isDisabled\":false},\"tz\":{\"displayText\":\"Tanzania\",\"isDisabled\":false},\"th\":{\"displayText\":\"Thailand\",\"isDisabled\":false},\"tl\":{\"displayText\":\"Timor-Leste\",\"isDisabled\":false},\"tg\":{\"displayText\":\"Togo\",\"isDisabled\":false},\"tk\":{\"displayText\":\"Tokelau\",\"isDisabled\":false},\"to\":{\"displayText\":\"Tonga\",\"isDisabled\":false},\"tt\":{\"displayText\":\"Trinidad and Tobago\",\"isDisabled\":false},\"tn\":{\"displayText\":\"Tunisia\",\"isDisabled\":false},\"tr\":{\"displayText\":\"Turkey\",\"isDisabled\":false},\"tm\":{\"displayText\":\"Turkmenistan\",\"isDisabled\":false},\"tc\":{\"displayText\":\"Turks and Caicos Islands\",\"isDisabled\":false},\"tv\":{\"displayText\":\"Tuvalu\",\"isDisabled\":false},\"ug\":{\"displayText\":\"Uganda\",\"isDisabled\":false},\"ua\":{\"displayText\":\"Ukraine\",\"isDisabled\":false},\"ae\":{\"displayText\":\"United Arab Emirates\",\"isDisabled\":false},\"gb\":{\"displayText\":\"United Kingdom\",\"isDisabled\":false},\"us\":{\"displayText\":\"United States\",\"isDisabled\":false},\"um\":{\"displayText\":\"U.S. Outlying Islands\",\"isDisabled\":false},\"uy\":{\"displayText\":\"Uruguay\",\"isDisabled\":false},\"uz\":{\"displayText\":\"Uzbekistan\",\"isDisabled\":false},\"vu\":{\"displayText\":\"Vanuatu\",\"isDisabled\":false},\"va\":{\"displayText\":\"Vatican City\",\"isDisabled\":false},\"ve\":{\"displayText\":\"Venezuela\",\"isDisabled\":false},\"vn\":{\"displayText\":\"Vietnam\",\"isDisabled\":false},\"vg\":{\"displayText\":\"British Virgin Islands\",\"isDisabled\":false},\"vi\":{\"displayText\":\"U.S. Virgin Islands\",\"isDisabled\":false},\"wf\":{\"displayText\":\"Wallis and Futuna\",\"isDisabled\":false},\"ye\":{\"displayText\":\"Yemen\",\"isDisabled\":false},\"zm\":{\"displayText\":\"Zambia\",\"isDisabled\":false},\"zw\":{\"displayText\":\"Zimbabwe\",\"isDisabled\":false}},\"displaySelectionText\":\"--Select--\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted country\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Country/Region is a required field\"}]},\"displayId\":\"addressCountry\",\"displayType\":\"property\",\"isDisabled\":true,\"propertyName\":\"country\",\"tags\":{\"theme\":\"windows\",\"accessibilityName\":\"Country/Region\"}}],\"displayId\":\"addressDetailsDataGroup\",\"displayType\":\"group\"},{\"members\":[{\"displayContent\":\"Microsoft respects your privacy. See our \",\"displayId\":\"microsoft_privacy_static_text\",\"displayType\":\"text\"},{\"sourceUrl\":\"https://go.microsoft.com/fwlink/?LinkId=248681\",\"displayContent\":\"privacy statement\",\"displayId\":\"privacyStatement\",\"displayType\":\"hyperlink\",\"pidlAction\":{\"type\":\"navigate\",\"context\":\"https://go.microsoft.com/fwlink/?LinkId=248681\"}},{\"displayContent\":\".\",\"displayId\":\"staticPeriodText\",\"displayType\":\"text\"}],\"displayId\":\"microsoftPrivacyTextGroup\",\"displayType\":\"textgroup\",\"tags\":{\"privacy-text-group\":\"privacy-text-group\"}},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Back\",\"displayId\":\"addressBackButton\",\"displayType\":\"button\",\"isBack\":true,\"pidlAction\":{\"type\":\"movePrevious\",\"context\":\"\"},\"tags\":{\"accessibilityName\":\"Back\"}},{\"displayContent\":\"Save\",\"displayId\":\"saveButton\",\"displayType\":\"button\",\"isHighlighted\":true,\"pidlAction\":{\"type\":\"submit\",\"isDefault\":true,\"context\":{\"href\":\"https://{pifd-endpoint}/users/{userId}/addressesEx?partner=amcweb&language=en-US&avsSuggest=True\",\"method\":\"POST\"}},\"tags\":{\"accessibilityName\":\"Save\"}}],\"displayId\":\"addressBackSaveGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressSuggestionPage2\",\"displayType\":\"page\"}],\"strings\":{\"constants\":{\"singleFieldErrorMessage\":\"There is 1 field in the form that requires your attention\",\"multipleFieldsErrorMessage\":\"There are {n} fields in the form that require your attention\"},\"serverErrorCodes\":{\"InvalidAddress\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"postal_code,city,region\"},\"InvalidAddressFieldsCombination\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"postal_code,city,region\"},\"InvalidProperty\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1,address_line2,address_line3,postal_code,city,region\"},\"InvalidCity\":{\"ErrorMessage\":\"Check the city in your address. There appears to be an error in it.\",\"Target\":\"city\"},\"InvalidPostalCode\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address.\uFFFDThere appears to be an error in it.\",\"Target\":\"postal_code\"},\"InvalidRegion\":{\"ErrorMessage\":\"Check the state in your address.\uFFFDThere appears to be an error in it.\",\"Target\":\"region\"},\"10021\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"10033\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"40005\":{\"ErrorMessage\":\"Check your address. A required field is missing.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"60010\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"60012\":{\"ErrorMessage\":\"Check the state in your address. There appears to be an error in it.\",\"Target\":\"region\"},\"60016\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60017\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60018\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60019\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60011\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60013\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,postal_code\"},\"60014\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"},\"60015\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region\"},\"60041\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"},\"60042\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60045\":{\"ErrorMessage\":\"Check the state in your address. There appears to be an error in it.\",\"Target\":\"region\"},\"60071\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,postal_code\"},\"60029\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60030\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"}}}},{\"identity\":{\"description_type\":\"address\",\"operation\":\"validateInstance\",\"country\":\"US\",\"type\":\"userEntered\",\"resource_id\":\"userEntered\"},\"data_description\":{\"addressOperation\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"validateInstance\"},\"addressCountry\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"US\"},\"addressType\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"userEntered\"},\"id\":{\"propertyType\":\"userData\",\"type\":\"returnObject\",\"dataType\":\"returnObject\",\"is_key\":true,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"suggested_0\",\"possible_values\":{\"suggested_0\":\"suggested_0\",\"xxxxx\":\"xxxxx\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^xxxxx$\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^xxxxx$\"}]},\"addressBillingV3\":[{\"identity\":{\"description_type\":\"address\",\"type\":\"billing_v3\",\"operation\":\"add\",\"country\":\"US\"},\"data_description\":{\"addressType\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"billing_v3\"},\"addressOperation\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"add\"},\"addressCountry\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_updatable\":true,\"default_value\":\"US\"},\"id\":{\"propertyType\":\"clientData\",\"type\":\"hidden\",\"dataType\":\"hidden\",\"is_key\":false,\"is_optional\":true,\"is_updatable\":true},\"address_line1\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"1 Microsoft Way\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"}]},\"address_line2\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":true,\"is_updatable\":true,\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_address\",\"error_message\":\"Incorrectly formatted address\"}]},\"city\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"redmond\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_city\",\"error_message\":\"Incorrectly formatted city\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^(?!^[\\\\u0009\\\\u000A\\\\u000D\\\\u0020\\\\u2000-\\\\u200B]*$)[\\\\u0009\\\\u000A\\\\u000D\\\\u0020-\\\\uD7FF\\\\uE000-\\\\uFFFD\\\\u10000-\\\\u10FFFF]{1,50}$\",\"error_code\":\"invalid_city\",\"error_message\":\"Incorrectly formatted city\"}]},\"region\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"wa\",\"possible_values\":{\"al\":\"Alabama\",\"ak\":\"Alaska\",\"az\":\"Arizona\",\"ar\":\"Arkansas\",\"ae\":\"Armed Forces Africa\",\"aa\":\"Armed Forces America\",\"ap\":\"Armed Forces Pacific\",\"ca\":\"California\",\"co\":\"Colorado\",\"ct\":\"Connecticut\",\"de\":\"Delaware\",\"dc\":\"District of Columbia\",\"fl\":\"Florida\",\"ga\":\"Georgia\",\"hi\":\"Hawaii\",\"id\":\"Idaho\",\"il\":\"Illinois\",\"in\":\"Indiana\",\"ia\":\"Iowa\",\"ks\":\"Kansas\",\"ky\":\"Kentucky\",\"la\":\"Louisiana\",\"me\":\"Maine\",\"md\":\"Maryland\",\"ma\":\"Massachusetts\",\"mi\":\"Michigan\",\"mn\":\"Minnesota\",\"ms\":\"Mississippi\",\"mo\":\"Missouri\",\"mt\":\"Montana\",\"ne\":\"Nebraska\",\"nv\":\"Nevada\",\"nh\":\"New Hampshire\",\"nj\":\"New Jersey\",\"nm\":\"New Mexico\",\"ny\":\"New York\",\"nc\":\"North Carolina\",\"nd\":\"North Dakota\",\"oh\":\"Ohio\",\"ok\":\"Oklahoma\",\"or\":\"Oregon\",\"pa\":\"Pennsylvania\",\"pr\":\"Puerto Rico\",\"ri\":\"Rhode Island\",\"sc\":\"South Carolina\",\"sd\":\"South Dakota\",\"tn\":\"Tennessee\",\"tx\":\"Texas\",\"ut\":\"Utah\",\"vt\":\"Vermont\",\"va\":\"Virginia\",\"wa\":\"Washington\",\"wv\":\"West Virginia\",\"wi\":\"Wisconsin\",\"wy\":\"Wyoming\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^[A-Za-z0-9]{2,3}$\",\"error_code\":\"invalid_state\",\"error_message\":\"Incorrectly formatted state\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^[A-Za-z0-9]{2,3}$\",\"error_code\":\"invalid_state\",\"error_message\":\"Incorrectly formatted state\"}]},\"postal_code\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":false,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"98051\",\"validation\":{\"validationType\":\"regex\",\"regex\":\"^\\\\d{5}(-\\\\d{4})?$\",\"error_code\":\"invalid_zip\",\"error_message\":\"Incorrectly formatted zip\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^\\\\d{5}(-\\\\d{4})?$\",\"error_code\":\"invalid_zip\",\"error_message\":\"Incorrectly formatted zip\"}]},\"country\":{\"propertyType\":\"userData\",\"type\":\"string\",\"dataType\":\"string\",\"is_key\":true,\"is_optional\":false,\"is_updatable\":true,\"default_value\":\"US\",\"possible_values\":{\"af\":\"Afghanistan\",\"ax\":\"\u00C5land Islands\",\"al\":\"Albania\",\"dz\":\"Algeria\",\"as\":\"American Samoa\",\"ad\":\"Andorra\",\"ao\":\"Angola\",\"ai\":\"Anguilla\",\"aq\":\"Antarctica\",\"ag\":\"Antigua and Barbuda\",\"ar\":\"Argentina\",\"am\":\"Armenia\",\"aw\":\"Aruba\",\"au\":\"Australia\",\"at\":\"Austria\",\"az\":\"Azerbaijan\",\"bs\":\"Bahamas\",\"bh\":\"Bahrain\",\"bd\":\"Bangladesh\",\"bb\":\"Barbados\",\"by\":\"Belarus\",\"be\":\"Belgium\",\"bz\":\"Belize\",\"bj\":\"Benin\",\"bm\":\"Bermuda\",\"bt\":\"Bhutan\",\"bo\":\"Bolivia\",\"bq\":\"Bonaire\",\"ba\":\"Bosnia and Herzegovina\",\"bw\":\"Botswana\",\"bv\":\"Bouvet Island\",\"br\":\"Brazil\",\"io\":\"British Indian Ocean Territory\",\"bn\":\"Brunei\",\"bg\":\"Bulgaria\",\"bf\":\"Burkina Faso\",\"bi\":\"Burundi\",\"kh\":\"Cambodia\",\"cm\":\"Cameroon\",\"ca\":\"Canada\",\"cv\":\"Cabo Verde\",\"ky\":\"Cayman Islands\",\"cf\":\"Central African Republic\",\"td\":\"Chad\",\"gg\":\"Guernsey\",\"je\":\"Jersey\",\"cl\":\"Chile\",\"cn\":\"China\",\"cx\":\"Christmas Island\",\"cc\":\"Cocos (Keeling) Islands\",\"co\":\"Colombia\",\"km\":\"Comoros\",\"cd\":\"Congo (DRC)\",\"cg\":\"Congo\",\"ck\":\"Cook Islands\",\"cr\":\"Costa Rica\",\"ci\":\"C\u00F4te d\u2019Ivoire\",\"hr\":\"Croatia\",\"cw\":\"Cura\u00E7ao\",\"cy\":\"Cyprus\",\"cz\":\"Czechia\",\"dk\":\"Denmark\",\"dj\":\"Djibouti\",\"dm\":\"Dominica\",\"do\":\"Dominican Republic\",\"ec\":\"Ecuador\",\"eg\":\"Egypt\",\"sv\":\"El Salvador\",\"gq\":\"Equatorial Guinea\",\"er\":\"Eritrea\",\"ee\":\"Estonia\",\"et\":\"Ethiopia\",\"fk\":\"Falkland Islands\",\"fo\":\"Faroe Islands\",\"fj\":\"Fiji\",\"fi\":\"Finland\",\"fr\":\"France\",\"gf\":\"French Guiana\",\"pf\":\"French Polynesia\",\"ga\":\"Gabon\",\"gm\":\"Gambia\",\"ge\":\"Georgia\",\"de\":\"Germany\",\"gh\":\"Ghana\",\"gi\":\"Gibraltar\",\"gr\":\"Greece\",\"gl\":\"Greenland\",\"gd\":\"Grenada\",\"gp\":\"Guadeloupe\",\"gu\":\"Guam\",\"gt\":\"Guatemala\",\"gn\":\"Guinea\",\"gw\":\"Guinea-Bissau\",\"gy\":\"Guyana\",\"ht\":\"Haiti\",\"hm\":\"Heard Island and McDonald Islands\",\"hn\":\"Honduras\",\"hk\":\"Hong Kong SAR\",\"hu\":\"Hungary\",\"is\":\"Iceland\",\"in\":\"India\",\"id\":\"Indonesia\",\"iq\":\"Iraq\",\"ie\":\"Ireland\",\"im\":\"Isle of Man\",\"il\":\"Israel\",\"it\":\"Italy\",\"jm\":\"Jamaica\",\"jp\":\"Japan\",\"jo\":\"Jordan\",\"kz\":\"Kazakhstan\",\"ke\":\"Kenya\",\"ki\":\"Kiribati\",\"kr\":\"Korea\",\"xk\":\"Kosovo\",\"kw\":\"Kuwait\",\"kg\":\"Kyrgyzstan\",\"la\":\"Laos\",\"lv\":\"Latvia\",\"lb\":\"Lebanon\",\"ls\":\"Lesotho\",\"lr\":\"Liberia\",\"ly\":\"Libya\",\"li\":\"Liechtenstein\",\"lt\":\"Lithuania\",\"lu\":\"Luxembourg\",\"mo\":\"Macao SAR\",\"mk\":\"North Macedonia\",\"mg\":\"Madagascar\",\"mw\":\"Malawi\",\"my\":\"Malaysia\",\"mv\":\"Maldives\",\"ml\":\"Mali\",\"mt\":\"Malta\",\"mh\":\"Marshall Islands\",\"mq\":\"Martinique\",\"mr\":\"Mauritania\",\"mu\":\"Mauritius\",\"yt\":\"Mayotte\",\"mx\":\"Mexico\",\"fm\":\"Micronesia\",\"md\":\"Moldova\",\"mc\":\"Monaco\",\"mn\":\"Mongolia\",\"me\":\"Montenegro\",\"ms\":\"Montserrat\",\"ma\":\"Morocco\",\"mz\":\"Mozambique\",\"mm\":\"Myanmar\",\"na\":\"Namibia\",\"nr\":\"Nauru\",\"np\":\"Nepal\",\"nl\":\"Netherlands\",\"nc\":\"New Caledonia\",\"nz\":\"New Zealand\",\"ni\":\"Nicaragua\",\"ne\":\"Niger\",\"ng\":\"Nigeria\",\"nu\":\"Niue\",\"nf\":\"Norfolk Island\",\"mp\":\"Northern Mariana Islands\",\"no\":\"Norway\",\"om\":\"Oman\",\"pk\":\"Pakistan\",\"pw\":\"Palau\",\"ps\":\"Palestinian Authority\",\"pa\":\"Panama\",\"pg\":\"Papua New Guinea\",\"py\":\"Paraguay\",\"pe\":\"Peru\",\"ph\":\"Philippines\",\"pn\":\"Pitcairn Islands\",\"pl\":\"Poland\",\"pt\":\"Portugal\",\"pr\":\"Puerto Rico\",\"qa\":\"Qatar\",\"re\":\"R\u00E9union\",\"ro\":\"Romania\",\"ru\":\"Russia\",\"rw\":\"Rwanda\",\"bl\":\"Saint Barth\u00E9lemy\",\"sh\":\"St Helena, Ascension, Tristan da Cunha\",\"kn\":\"Saint Kitts and Nevis\",\"lc\":\"Saint Lucia\",\"mf\":\"Saint Martin\",\"pm\":\"Saint Pierre and Miquelon\",\"vc\":\"Saint Vincent and the Grenadines\",\"ws\":\"Samoa\",\"sm\":\"San Marino\",\"st\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"sa\":\"Saudi Arabia\",\"sn\":\"Senegal\",\"rs\":\"Serbia\",\"sc\":\"Seychelles\",\"sl\":\"Sierra Leone\",\"sg\":\"Singapore\",\"sx\":\"Sint Maarten\",\"sk\":\"Slovakia\",\"si\":\"Slovenia\",\"sb\":\"Solomon Islands\",\"so\":\"Somalia\",\"za\":\"South Africa\",\"gs\":\"South Georgia and South Sandwich Islands\",\"es\":\"Spain\",\"lk\":\"Sri Lanka\",\"sr\":\"Suriname\",\"sj\":\"Svalbard\",\"sz\":\"Eswatini\",\"se\":\"Sweden\",\"ch\":\"Switzerland\",\"tw\":\"Taiwan\",\"tj\":\"Tajikistan\",\"tz\":\"Tanzania\",\"th\":\"Thailand\",\"tl\":\"Timor-Leste\",\"tg\":\"Togo\",\"tk\":\"Tokelau\",\"to\":\"Tonga\",\"tt\":\"Trinidad and Tobago\",\"tn\":\"Tunisia\",\"tr\":\"Turkey\",\"tm\":\"Turkmenistan\",\"tc\":\"Turks and Caicos Islands\",\"tv\":\"Tuvalu\",\"ug\":\"Uganda\",\"ua\":\"Ukraine\",\"ae\":\"United Arab Emirates\",\"gb\":\"United Kingdom\",\"us\":\"United States\",\"um\":\"U.S. Outlying Islands\",\"uy\":\"Uruguay\",\"uz\":\"Uzbekistan\",\"vu\":\"Vanuatu\",\"va\":\"Vatican City\",\"ve\":\"Venezuela\",\"vn\":\"Vietnam\",\"vg\":\"British Virgin Islands\",\"vi\":\"U.S. Virgin Islands\",\"wf\":\"Wallis and Futuna\",\"ye\":\"Yemen\",\"zm\":\"Zambia\",\"zw\":\"Zimbabwe\"},\"validation\":{\"validationType\":\"regex\",\"regex\":\"^us|US$\",\"error_code\":\"invalid_country\",\"error_message\":\"Incorrectly formatted country\"},\"validations\":[{\"validationType\":\"regex\",\"regex\":\"^us|US$\",\"error_code\":\"invalid_country\",\"error_message\":\"Incorrectly formatted country\"}]}}}]},\"displayDescription\":[{\"displayName\":\"suggestedAddressesDetailsPage\",\"members\":[{\"displayContent\":\"Verify your address\",\"displayId\":\"addressSuggestionHeading\",\"displayType\":\"heading\"},{\"displayContent\":\"We couldn't validate your address. Choose the address you want to use.\",\"displayId\":\"addressSuggestionMessage\",\"displayType\":\"text\"},{\"layoutOrientation\":\"inline\",\"members\":[{\"layoutOrientation\":\"inline\",\"members\":[{\"displayName\":\"Current address\",\"showDisplayName\":\"true\",\"possibleValues\":{\"xxxxx\":\"xxxxx\"},\"possibleOptions\":{\"xxxxx\":{\"displayText\":\"xxxxx\",\"isDisabled\":false,\"displayContent\":{\"members\":[{\"displayContent\":\"1 Microsoft Way\",\"displayId\":\"address_line1_xxxxx\",\"displayType\":\"text\"},{\"displayId\":\"address_line2_xxxxx\",\"displayType\":\"text\"},{\"displayId\":\"address_line3_xxxxx\",\"displayType\":\"text\"},{\"displayContent\":\"redmond, WA\",\"displayId\":\"city_region_xxxxx\",\"displayType\":\"text\"},{\"displayContent\":\"98051\",\"displayId\":\"postal_code_xxxxx\",\"displayType\":\"text\"}],\"displayId\":\"optionAddress_xxxxx\",\"displayType\":\"group\",\"tags\":{\"address-container\":\"address-container\"}}}},\"selectType\":\"radio\",\"displayId\":\"addressEntered\",\"displayType\":\"property\",\"pidlAction\":{\"type\":\"success\",\"context\":\"\"},\"propertyName\":\"id\",\"tags\":{\"accessibilityName\":\"Current address\"}},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Change\",\"displayId\":\"addressChangeButton\",\"displayType\":\"button\",\"pidlAction\":{\"type\":\"moveNext\",\"context\":\"\"},\"tags\":{\"accessibilityName\":\"Change\",\"action-trigger\":\"action-trigger\"}}],\"displayId\":\"addressChangeGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressEnteredGroup\",\"displayType\":\"group\"},{\"displayName\":\"We suggest\",\"showDisplayName\":\"true\",\"possibleValues\":{\"suggested_0\":\"suggested_0\"},\"possibleOptions\":{\"suggested_0\":{\"displayText\":\"suggested_0\",\"isDisabled\":false,\"displayContent\":{\"members\":[{\"displayContent\":\"1 Microsoft Way\",\"displayId\":\"address_line1_suggested_0\",\"displayType\":\"text\"},{\"displayId\":\"address_line2_suggested_0\",\"displayType\":\"text\"},{\"displayId\":\"address_line3_suggested_0\",\"displayType\":\"text\"},{\"displayContent\":\"Redmond, WA\",\"displayId\":\"city_region_suggested_0\",\"displayType\":\"text\"},{\"displayContent\":\"98052-8300\",\"displayId\":\"postal_code_suggested_0\",\"displayType\":\"text\"}],\"displayId\":\"optionAddress_suggested_0\",\"displayType\":\"group\",\"tags\":{\"address-container\":\"address-container\"}}}},\"selectType\":\"radio\",\"displayId\":\"addressSuggested\",\"displayType\":\"property\",\"pidlAction\":{\"type\":\"success\",\"context\":\"\"},\"propertyName\":\"id\",\"tags\":{\"accessibilityName\":\"We suggest\"}}],\"displayId\":\"addressOptionsGroup\",\"displayType\":\"group\"},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Use this address\",\"displayId\":\"addressUseButton\",\"displayType\":\"button\",\"isHighlighted\":true,\"pidlAction\":{\"type\":\"restAction\",\"isDefault\":true,\"context\":{\"href\":\"https://{pifd-endpoint}/users/{userId}/addressesEx/xxxxx?partner=amcweb&language=en-US\",\"method\":\"PATCH\",\"payload\":{\"is_customer_consented\":true},\"headers\":{\"If-Match\":\"7247023615162416086\"}}},\"tags\":{\"accessibilityName\":\"Use this address\"}}],\"displayId\":\"addressUseCloseGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressSuggestionPage1\",\"displayType\":\"page\"},{\"displayName\":\"AddressDetailsPage\",\"members\":[{\"displayContent\":\"Change your address\",\"displayId\":\"addressChangePageHeading\",\"displayType\":\"heading\"},{\"displayContent\":\"This address will be saved with your Microsoft account.\",\"displayId\":\"addressChangePageSubheading\",\"displayType\":\"text\"},{\"members\":[{\"displayName\":\"Address line 1\",\"showDisplayName\":\"true\",\"minLength\":25,\"maxLength\":30,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted address\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Address line 1 is a required field\"}]},\"displayId\":\"addressLine1\",\"displayType\":\"property\",\"propertyName\":\"address_line1\",\"tags\":{\"accessibilityName\":\"Address line 1\"}},{\"displayName\":\"Address line 2 (Optional)\",\"showDisplayName\":\"true\",\"minLength\":25,\"maxLength\":30,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted address\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Address line 2 is a required field\"}]},\"displayId\":\"addressLine2\",\"displayType\":\"property\",\"propertyName\":\"address_line2\",\"tags\":{\"accessibilityName\":\"Address line 2 (Optional)\"}},{\"displayName\":\"City\",\"showDisplayName\":\"true\",\"maxLength\":26,\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted city\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"City is a required field\"}]},\"displayId\":\"addressCity\",\"displayType\":\"property\",\"propertyName\":\"city\",\"tags\":{\"accessibilityName\":\"City\"}},{\"displayName\":\"State\",\"showDisplayName\":\"true\",\"possibleValues\":{\"al\":\"Alabama\",\"ak\":\"Alaska\",\"az\":\"Arizona\",\"ar\":\"Arkansas\",\"ae\":\"Armed Forces Africa\",\"aa\":\"Armed Forces America\",\"ap\":\"Armed Forces Pacific\",\"ca\":\"California\",\"co\":\"Colorado\",\"ct\":\"Connecticut\",\"de\":\"Delaware\",\"dc\":\"District of Columbia\",\"fl\":\"Florida\",\"ga\":\"Georgia\",\"hi\":\"Hawaii\",\"id\":\"Idaho\",\"il\":\"Illinois\",\"in\":\"Indiana\",\"ia\":\"Iowa\",\"ks\":\"Kansas\",\"ky\":\"Kentucky\",\"la\":\"Louisiana\",\"me\":\"Maine\",\"md\":\"Maryland\",\"ma\":\"Massachusetts\",\"mi\":\"Michigan\",\"mn\":\"Minnesota\",\"ms\":\"Mississippi\",\"mo\":\"Missouri\",\"mt\":\"Montana\",\"ne\":\"Nebraska\",\"nv\":\"Nevada\",\"nh\":\"New Hampshire\",\"nj\":\"New Jersey\",\"nm\":\"New Mexico\",\"ny\":\"New York\",\"nc\":\"North Carolina\",\"nd\":\"North Dakota\",\"oh\":\"Ohio\",\"ok\":\"Oklahoma\",\"or\":\"Oregon\",\"pa\":\"Pennsylvania\",\"pr\":\"Puerto Rico\",\"ri\":\"Rhode Island\",\"sc\":\"South Carolina\",\"sd\":\"South Dakota\",\"tn\":\"Tennessee\",\"tx\":\"Texas\",\"ut\":\"Utah\",\"vt\":\"Vermont\",\"va\":\"Virginia\",\"wa\":\"Washington\",\"wv\":\"West Virginia\",\"wi\":\"Wisconsin\",\"wy\":\"Wyoming\"},\"possibleOptions\":{\"al\":{\"displayText\":\"Alabama\",\"isDisabled\":false},\"ak\":{\"displayText\":\"Alaska\",\"isDisabled\":false},\"az\":{\"displayText\":\"Arizona\",\"isDisabled\":false},\"ar\":{\"displayText\":\"Arkansas\",\"isDisabled\":false},\"ae\":{\"displayText\":\"Armed Forces Africa\",\"isDisabled\":false},\"aa\":{\"displayText\":\"Armed Forces America\",\"isDisabled\":false},\"ap\":{\"displayText\":\"Armed Forces Pacific\",\"isDisabled\":false},\"ca\":{\"displayText\":\"California\",\"isDisabled\":false},\"co\":{\"displayText\":\"Colorado\",\"isDisabled\":false},\"ct\":{\"displayText\":\"Connecticut\",\"isDisabled\":false},\"de\":{\"displayText\":\"Delaware\",\"isDisabled\":false},\"dc\":{\"displayText\":\"District of Columbia\",\"isDisabled\":false},\"fl\":{\"displayText\":\"Florida\",\"isDisabled\":false},\"ga\":{\"displayText\":\"Georgia\",\"isDisabled\":false},\"hi\":{\"displayText\":\"Hawaii\",\"isDisabled\":false},\"id\":{\"displayText\":\"Idaho\",\"isDisabled\":false},\"il\":{\"displayText\":\"Illinois\",\"isDisabled\":false},\"in\":{\"displayText\":\"Indiana\",\"isDisabled\":false},\"ia\":{\"displayText\":\"Iowa\",\"isDisabled\":false},\"ks\":{\"displayText\":\"Kansas\",\"isDisabled\":false},\"ky\":{\"displayText\":\"Kentucky\",\"isDisabled\":false},\"la\":{\"displayText\":\"Louisiana\",\"isDisabled\":false},\"me\":{\"displayText\":\"Maine\",\"isDisabled\":false},\"md\":{\"displayText\":\"Maryland\",\"isDisabled\":false},\"ma\":{\"displayText\":\"Massachusetts\",\"isDisabled\":false},\"mi\":{\"displayText\":\"Michigan\",\"isDisabled\":false},\"mn\":{\"displayText\":\"Minnesota\",\"isDisabled\":false},\"ms\":{\"displayText\":\"Mississippi\",\"isDisabled\":false},\"mo\":{\"displayText\":\"Missouri\",\"isDisabled\":false},\"mt\":{\"displayText\":\"Montana\",\"isDisabled\":false},\"ne\":{\"displayText\":\"Nebraska\",\"isDisabled\":false},\"nv\":{\"displayText\":\"Nevada\",\"isDisabled\":false},\"nh\":{\"displayText\":\"New Hampshire\",\"isDisabled\":false},\"nj\":{\"displayText\":\"New Jersey\",\"isDisabled\":false},\"nm\":{\"displayText\":\"New Mexico\",\"isDisabled\":false},\"ny\":{\"displayText\":\"New York\",\"isDisabled\":false},\"nc\":{\"displayText\":\"North Carolina\",\"isDisabled\":false},\"nd\":{\"displayText\":\"North Dakota\",\"isDisabled\":false},\"oh\":{\"displayText\":\"Ohio\",\"isDisabled\":false},\"ok\":{\"displayText\":\"Oklahoma\",\"isDisabled\":false},\"or\":{\"displayText\":\"Oregon\",\"isDisabled\":false},\"pa\":{\"displayText\":\"Pennsylvania\",\"isDisabled\":false},\"pr\":{\"displayText\":\"Puerto Rico\",\"isDisabled\":false},\"ri\":{\"displayText\":\"Rhode Island\",\"isDisabled\":false},\"sc\":{\"displayText\":\"South Carolina\",\"isDisabled\":false},\"sd\":{\"displayText\":\"South Dakota\",\"isDisabled\":false},\"tn\":{\"displayText\":\"Tennessee\",\"isDisabled\":false},\"tx\":{\"displayText\":\"Texas\",\"isDisabled\":false},\"ut\":{\"displayText\":\"Utah\",\"isDisabled\":false},\"vt\":{\"displayText\":\"Vermont\",\"isDisabled\":false},\"va\":{\"displayText\":\"Virginia\",\"isDisabled\":false},\"wa\":{\"displayText\":\"Washington\",\"isDisabled\":false},\"wv\":{\"displayText\":\"West Virginia\",\"isDisabled\":false},\"wi\":{\"displayText\":\"Wisconsin\",\"isDisabled\":false},\"wy\":{\"displayText\":\"Wyoming\",\"isDisabled\":false}},\"displaySelectionText\":\"--Select--\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted state\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"State is a required field\"}]},\"displayId\":\"addressState\",\"displayType\":\"property\",\"propertyName\":\"region\",\"tags\":{\"theme\":\"windows\",\"accessibilityName\":\"State\"}},{\"displayName\":\"ZIP code\",\"showDisplayName\":\"true\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted ZIP code\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"ZIP Code is a required field\"}]},\"displayId\":\"addressPostalCode\",\"displayType\":\"property\",\"propertyName\":\"postal_code\",\"tags\":{\"accessibilityName\":\"ZIP code\"}},{\"displayName\":\"Country/Region\",\"showDisplayName\":\"true\",\"possibleValues\":{\"af\":\"Afghanistan\",\"ax\":\"\u00C5land Islands\",\"al\":\"Albania\",\"dz\":\"Algeria\",\"as\":\"American Samoa\",\"ad\":\"Andorra\",\"ao\":\"Angola\",\"ai\":\"Anguilla\",\"aq\":\"Antarctica\",\"ag\":\"Antigua and Barbuda\",\"ar\":\"Argentina\",\"am\":\"Armenia\",\"aw\":\"Aruba\",\"au\":\"Australia\",\"at\":\"Austria\",\"az\":\"Azerbaijan\",\"bs\":\"Bahamas\",\"bh\":\"Bahrain\",\"bd\":\"Bangladesh\",\"bb\":\"Barbados\",\"by\":\"Belarus\",\"be\":\"Belgium\",\"bz\":\"Belize\",\"bj\":\"Benin\",\"bm\":\"Bermuda\",\"bt\":\"Bhutan\",\"bo\":\"Bolivia\",\"bq\":\"Bonaire\",\"ba\":\"Bosnia and Herzegovina\",\"bw\":\"Botswana\",\"bv\":\"Bouvet Island\",\"br\":\"Brazil\",\"io\":\"British Indian Ocean Territory\",\"bn\":\"Brunei\",\"bg\":\"Bulgaria\",\"bf\":\"Burkina Faso\",\"bi\":\"Burundi\",\"kh\":\"Cambodia\",\"cm\":\"Cameroon\",\"ca\":\"Canada\",\"cv\":\"Cabo Verde\",\"ky\":\"Cayman Islands\",\"cf\":\"Central African Republic\",\"td\":\"Chad\",\"gg\":\"Guernsey\",\"je\":\"Jersey\",\"cl\":\"Chile\",\"cn\":\"China\",\"cx\":\"Christmas Island\",\"cc\":\"Cocos (Keeling) Islands\",\"co\":\"Colombia\",\"km\":\"Comoros\",\"cd\":\"Congo (DRC)\",\"cg\":\"Congo\",\"ck\":\"Cook Islands\",\"cr\":\"Costa Rica\",\"ci\":\"C\u00F4te d\u2019Ivoire\",\"hr\":\"Croatia\",\"cw\":\"Cura\u00E7ao\",\"cy\":\"Cyprus\",\"cz\":\"Czechia\",\"dk\":\"Denmark\",\"dj\":\"Djibouti\",\"dm\":\"Dominica\",\"do\":\"Dominican Republic\",\"ec\":\"Ecuador\",\"eg\":\"Egypt\",\"sv\":\"El Salvador\",\"gq\":\"Equatorial Guinea\",\"er\":\"Eritrea\",\"ee\":\"Estonia\",\"et\":\"Ethiopia\",\"fk\":\"Falkland Islands\",\"fo\":\"Faroe Islands\",\"fj\":\"Fiji\",\"fi\":\"Finland\",\"fr\":\"France\",\"gf\":\"French Guiana\",\"pf\":\"French Polynesia\",\"ga\":\"Gabon\",\"gm\":\"Gambia\",\"ge\":\"Georgia\",\"de\":\"Germany\",\"gh\":\"Ghana\",\"gi\":\"Gibraltar\",\"gr\":\"Greece\",\"gl\":\"Greenland\",\"gd\":\"Grenada\",\"gp\":\"Guadeloupe\",\"gu\":\"Guam\",\"gt\":\"Guatemala\",\"gn\":\"Guinea\",\"gw\":\"Guinea-Bissau\",\"gy\":\"Guyana\",\"ht\":\"Haiti\",\"hm\":\"Heard Island and McDonald Islands\",\"hn\":\"Honduras\",\"hk\":\"Hong Kong SAR\",\"hu\":\"Hungary\",\"is\":\"Iceland\",\"in\":\"India\",\"id\":\"Indonesia\",\"iq\":\"Iraq\",\"ie\":\"Ireland\",\"im\":\"Isle of Man\",\"il\":\"Israel\",\"it\":\"Italy\",\"jm\":\"Jamaica\",\"jp\":\"Japan\",\"jo\":\"Jordan\",\"kz\":\"Kazakhstan\",\"ke\":\"Kenya\",\"ki\":\"Kiribati\",\"kr\":\"Korea\",\"xk\":\"Kosovo\",\"kw\":\"Kuwait\",\"kg\":\"Kyrgyzstan\",\"la\":\"Laos\",\"lv\":\"Latvia\",\"lb\":\"Lebanon\",\"ls\":\"Lesotho\",\"lr\":\"Liberia\",\"ly\":\"Libya\",\"li\":\"Liechtenstein\",\"lt\":\"Lithuania\",\"lu\":\"Luxembourg\",\"mo\":\"Macao SAR\",\"mk\":\"North Macedonia\",\"mg\":\"Madagascar\",\"mw\":\"Malawi\",\"my\":\"Malaysia\",\"mv\":\"Maldives\",\"ml\":\"Mali\",\"mt\":\"Malta\",\"mh\":\"Marshall Islands\",\"mq\":\"Martinique\",\"mr\":\"Mauritania\",\"mu\":\"Mauritius\",\"yt\":\"Mayotte\",\"mx\":\"Mexico\",\"fm\":\"Micronesia\",\"md\":\"Moldova\",\"mc\":\"Monaco\",\"mn\":\"Mongolia\",\"me\":\"Montenegro\",\"ms\":\"Montserrat\",\"ma\":\"Morocco\",\"mz\":\"Mozambique\",\"mm\":\"Myanmar\",\"na\":\"Namibia\",\"nr\":\"Nauru\",\"np\":\"Nepal\",\"nl\":\"Netherlands\",\"nc\":\"New Caledonia\",\"nz\":\"New Zealand\",\"ni\":\"Nicaragua\",\"ne\":\"Niger\",\"ng\":\"Nigeria\",\"nu\":\"Niue\",\"nf\":\"Norfolk Island\",\"mp\":\"Northern Mariana Islands\",\"no\":\"Norway\",\"om\":\"Oman\",\"pk\":\"Pakistan\",\"pw\":\"Palau\",\"ps\":\"Palestinian Authority\",\"pa\":\"Panama\",\"pg\":\"Papua New Guinea\",\"py\":\"Paraguay\",\"pe\":\"Peru\",\"ph\":\"Philippines\",\"pn\":\"Pitcairn Islands\",\"pl\":\"Poland\",\"pt\":\"Portugal\",\"pr\":\"Puerto Rico\",\"qa\":\"Qatar\",\"re\":\"R\u00E9union\",\"ro\":\"Romania\",\"ru\":\"Russia\",\"rw\":\"Rwanda\",\"bl\":\"Saint Barth\u00E9lemy\",\"sh\":\"St Helena, Ascension, Tristan da Cunha\",\"kn\":\"Saint Kitts and Nevis\",\"lc\":\"Saint Lucia\",\"mf\":\"Saint Martin\",\"pm\":\"Saint Pierre and Miquelon\",\"vc\":\"Saint Vincent and the Grenadines\",\"ws\":\"Samoa\",\"sm\":\"San Marino\",\"st\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"sa\":\"Saudi Arabia\",\"sn\":\"Senegal\",\"rs\":\"Serbia\",\"sc\":\"Seychelles\",\"sl\":\"Sierra Leone\",\"sg\":\"Singapore\",\"sx\":\"Sint Maarten\",\"sk\":\"Slovakia\",\"si\":\"Slovenia\",\"sb\":\"Solomon Islands\",\"so\":\"Somalia\",\"za\":\"South Africa\",\"gs\":\"South Georgia and South Sandwich Islands\",\"es\":\"Spain\",\"lk\":\"Sri Lanka\",\"sr\":\"Suriname\",\"sj\":\"Svalbard\",\"sz\":\"Eswatini\",\"se\":\"Sweden\",\"ch\":\"Switzerland\",\"tw\":\"Taiwan\",\"tj\":\"Tajikistan\",\"tz\":\"Tanzania\",\"th\":\"Thailand\",\"tl\":\"Timor-Leste\",\"tg\":\"Togo\",\"tk\":\"Tokelau\",\"to\":\"Tonga\",\"tt\":\"Trinidad and Tobago\",\"tn\":\"Tunisia\",\"tr\":\"Turkey\",\"tm\":\"Turkmenistan\",\"tc\":\"Turks and Caicos Islands\",\"tv\":\"Tuvalu\",\"ug\":\"Uganda\",\"ua\":\"Ukraine\",\"ae\":\"United Arab Emirates\",\"gb\":\"United Kingdom\",\"us\":\"United States\",\"um\":\"U.S. Outlying Islands\",\"uy\":\"Uruguay\",\"uz\":\"Uzbekistan\",\"vu\":\"Vanuatu\",\"va\":\"Vatican City\",\"ve\":\"Venezuela\",\"vn\":\"Vietnam\",\"vg\":\"British Virgin Islands\",\"vi\":\"U.S. Virgin Islands\",\"wf\":\"Wallis and Futuna\",\"ye\":\"Yemen\",\"zm\":\"Zambia\",\"zw\":\"Zimbabwe\"},\"possibleOptions\":{\"af\":{\"displayText\":\"Afghanistan\",\"isDisabled\":false},\"ax\":{\"displayText\":\"\u00C5land Islands\",\"isDisabled\":false},\"al\":{\"displayText\":\"Albania\",\"isDisabled\":false},\"dz\":{\"displayText\":\"Algeria\",\"isDisabled\":false},\"as\":{\"displayText\":\"American Samoa\",\"isDisabled\":false},\"ad\":{\"displayText\":\"Andorra\",\"isDisabled\":false},\"ao\":{\"displayText\":\"Angola\",\"isDisabled\":false},\"ai\":{\"displayText\":\"Anguilla\",\"isDisabled\":false},\"aq\":{\"displayText\":\"Antarctica\",\"isDisabled\":false},\"ag\":{\"displayText\":\"Antigua and Barbuda\",\"isDisabled\":false},\"ar\":{\"displayText\":\"Argentina\",\"isDisabled\":false},\"am\":{\"displayText\":\"Armenia\",\"isDisabled\":false},\"aw\":{\"displayText\":\"Aruba\",\"isDisabled\":false},\"au\":{\"displayText\":\"Australia\",\"isDisabled\":false},\"at\":{\"displayText\":\"Austria\",\"isDisabled\":false},\"az\":{\"displayText\":\"Azerbaijan\",\"isDisabled\":false},\"bs\":{\"displayText\":\"Bahamas\",\"isDisabled\":false},\"bh\":{\"displayText\":\"Bahrain\",\"isDisabled\":false},\"bd\":{\"displayText\":\"Bangladesh\",\"isDisabled\":false},\"bb\":{\"displayText\":\"Barbados\",\"isDisabled\":false},\"by\":{\"displayText\":\"Belarus\",\"isDisabled\":false},\"be\":{\"displayText\":\"Belgium\",\"isDisabled\":false},\"bz\":{\"displayText\":\"Belize\",\"isDisabled\":false},\"bj\":{\"displayText\":\"Benin\",\"isDisabled\":false},\"bm\":{\"displayText\":\"Bermuda\",\"isDisabled\":false},\"bt\":{\"displayText\":\"Bhutan\",\"isDisabled\":false},\"bo\":{\"displayText\":\"Bolivia\",\"isDisabled\":false},\"bq\":{\"displayText\":\"Bonaire\",\"isDisabled\":false},\"ba\":{\"displayText\":\"Bosnia and Herzegovina\",\"isDisabled\":false},\"bw\":{\"displayText\":\"Botswana\",\"isDisabled\":false},\"bv\":{\"displayText\":\"Bouvet Island\",\"isDisabled\":false},\"br\":{\"displayText\":\"Brazil\",\"isDisabled\":false},\"io\":{\"displayText\":\"British Indian Ocean Territory\",\"isDisabled\":false},\"bn\":{\"displayText\":\"Brunei\",\"isDisabled\":false},\"bg\":{\"displayText\":\"Bulgaria\",\"isDisabled\":false},\"bf\":{\"displayText\":\"Burkina Faso\",\"isDisabled\":false},\"bi\":{\"displayText\":\"Burundi\",\"isDisabled\":false},\"kh\":{\"displayText\":\"Cambodia\",\"isDisabled\":false},\"cm\":{\"displayText\":\"Cameroon\",\"isDisabled\":false},\"ca\":{\"displayText\":\"Canada\",\"isDisabled\":false},\"cv\":{\"displayText\":\"Cabo Verde\",\"isDisabled\":false},\"ky\":{\"displayText\":\"Cayman Islands\",\"isDisabled\":false},\"cf\":{\"displayText\":\"Central African Republic\",\"isDisabled\":false},\"td\":{\"displayText\":\"Chad\",\"isDisabled\":false},\"gg\":{\"displayText\":\"Guernsey\",\"isDisabled\":false},\"je\":{\"displayText\":\"Jersey\",\"isDisabled\":false},\"cl\":{\"displayText\":\"Chile\",\"isDisabled\":false},\"cn\":{\"displayText\":\"China\",\"isDisabled\":false},\"cx\":{\"displayText\":\"Christmas Island\",\"isDisabled\":false},\"cc\":{\"displayText\":\"Cocos (Keeling) Islands\",\"isDisabled\":false},\"co\":{\"displayText\":\"Colombia\",\"isDisabled\":false},\"km\":{\"displayText\":\"Comoros\",\"isDisabled\":false},\"cd\":{\"displayText\":\"Congo (DRC)\",\"isDisabled\":false},\"cg\":{\"displayText\":\"Congo\",\"isDisabled\":false},\"ck\":{\"displayText\":\"Cook Islands\",\"isDisabled\":false},\"cr\":{\"displayText\":\"Costa Rica\",\"isDisabled\":false},\"ci\":{\"displayText\":\"C\u00F4te d\u2019Ivoire\",\"isDisabled\":false},\"hr\":{\"displayText\":\"Croatia\",\"isDisabled\":false},\"cw\":{\"displayText\":\"Cura\u00E7ao\",\"isDisabled\":false},\"cy\":{\"displayText\":\"Cyprus\",\"isDisabled\":false},\"cz\":{\"displayText\":\"Czechia\",\"isDisabled\":false},\"dk\":{\"displayText\":\"Denmark\",\"isDisabled\":false},\"dj\":{\"displayText\":\"Djibouti\",\"isDisabled\":false},\"dm\":{\"displayText\":\"Dominica\",\"isDisabled\":false},\"do\":{\"displayText\":\"Dominican Republic\",\"isDisabled\":false},\"ec\":{\"displayText\":\"Ecuador\",\"isDisabled\":false},\"eg\":{\"displayText\":\"Egypt\",\"isDisabled\":false},\"sv\":{\"displayText\":\"El Salvador\",\"isDisabled\":false},\"gq\":{\"displayText\":\"Equatorial Guinea\",\"isDisabled\":false},\"er\":{\"displayText\":\"Eritrea\",\"isDisabled\":false},\"ee\":{\"displayText\":\"Estonia\",\"isDisabled\":false},\"et\":{\"displayText\":\"Ethiopia\",\"isDisabled\":false},\"fk\":{\"displayText\":\"Falkland Islands\",\"isDisabled\":false},\"fo\":{\"displayText\":\"Faroe Islands\",\"isDisabled\":false},\"fj\":{\"displayText\":\"Fiji\",\"isDisabled\":false},\"fi\":{\"displayText\":\"Finland\",\"isDisabled\":false},\"fr\":{\"displayText\":\"France\",\"isDisabled\":false},\"gf\":{\"displayText\":\"French Guiana\",\"isDisabled\":false},\"pf\":{\"displayText\":\"French Polynesia\",\"isDisabled\":false},\"ga\":{\"displayText\":\"Gabon\",\"isDisabled\":false},\"gm\":{\"displayText\":\"Gambia\",\"isDisabled\":false},\"ge\":{\"displayText\":\"Georgia\",\"isDisabled\":false},\"de\":{\"displayText\":\"Germany\",\"isDisabled\":false},\"gh\":{\"displayText\":\"Ghana\",\"isDisabled\":false},\"gi\":{\"displayText\":\"Gibraltar\",\"isDisabled\":false},\"gr\":{\"displayText\":\"Greece\",\"isDisabled\":false},\"gl\":{\"displayText\":\"Greenland\",\"isDisabled\":false},\"gd\":{\"displayText\":\"Grenada\",\"isDisabled\":false},\"gp\":{\"displayText\":\"Guadeloupe\",\"isDisabled\":false},\"gu\":{\"displayText\":\"Guam\",\"isDisabled\":false},\"gt\":{\"displayText\":\"Guatemala\",\"isDisabled\":false},\"gn\":{\"displayText\":\"Guinea\",\"isDisabled\":false},\"gw\":{\"displayText\":\"Guinea-Bissau\",\"isDisabled\":false},\"gy\":{\"displayText\":\"Guyana\",\"isDisabled\":false},\"ht\":{\"displayText\":\"Haiti\",\"isDisabled\":false},\"hm\":{\"displayText\":\"Heard Island and McDonald Islands\",\"isDisabled\":false},\"hn\":{\"displayText\":\"Honduras\",\"isDisabled\":false},\"hk\":{\"displayText\":\"Hong Kong SAR\",\"isDisabled\":false},\"hu\":{\"displayText\":\"Hungary\",\"isDisabled\":false},\"is\":{\"displayText\":\"Iceland\",\"isDisabled\":false},\"in\":{\"displayText\":\"India\",\"isDisabled\":false},\"id\":{\"displayText\":\"Indonesia\",\"isDisabled\":false},\"iq\":{\"displayText\":\"Iraq\",\"isDisabled\":false},\"ie\":{\"displayText\":\"Ireland\",\"isDisabled\":false},\"im\":{\"displayText\":\"Isle of Man\",\"isDisabled\":false},\"il\":{\"displayText\":\"Israel\",\"isDisabled\":false},\"it\":{\"displayText\":\"Italy\",\"isDisabled\":false},\"jm\":{\"displayText\":\"Jamaica\",\"isDisabled\":false},\"jp\":{\"displayText\":\"Japan\",\"isDisabled\":false},\"jo\":{\"displayText\":\"Jordan\",\"isDisabled\":false},\"kz\":{\"displayText\":\"Kazakhstan\",\"isDisabled\":false},\"ke\":{\"displayText\":\"Kenya\",\"isDisabled\":false},\"ki\":{\"displayText\":\"Kiribati\",\"isDisabled\":false},\"kr\":{\"displayText\":\"Korea\",\"isDisabled\":false},\"xk\":{\"displayText\":\"Kosovo\",\"isDisabled\":false},\"kw\":{\"displayText\":\"Kuwait\",\"isDisabled\":false},\"kg\":{\"displayText\":\"Kyrgyzstan\",\"isDisabled\":false},\"la\":{\"displayText\":\"Laos\",\"isDisabled\":false},\"lv\":{\"displayText\":\"Latvia\",\"isDisabled\":false},\"lb\":{\"displayText\":\"Lebanon\",\"isDisabled\":false},\"ls\":{\"displayText\":\"Lesotho\",\"isDisabled\":false},\"lr\":{\"displayText\":\"Liberia\",\"isDisabled\":false},\"ly\":{\"displayText\":\"Libya\",\"isDisabled\":false},\"li\":{\"displayText\":\"Liechtenstein\",\"isDisabled\":false},\"lt\":{\"displayText\":\"Lithuania\",\"isDisabled\":false},\"lu\":{\"displayText\":\"Luxembourg\",\"isDisabled\":false},\"mo\":{\"displayText\":\"Macao SAR\",\"isDisabled\":false},\"mk\":{\"displayText\":\"North Macedonia\",\"isDisabled\":false},\"mg\":{\"displayText\":\"Madagascar\",\"isDisabled\":false},\"mw\":{\"displayText\":\"Malawi\",\"isDisabled\":false},\"my\":{\"displayText\":\"Malaysia\",\"isDisabled\":false},\"mv\":{\"displayText\":\"Maldives\",\"isDisabled\":false},\"ml\":{\"displayText\":\"Mali\",\"isDisabled\":false},\"mt\":{\"displayText\":\"Malta\",\"isDisabled\":false},\"mh\":{\"displayText\":\"Marshall Islands\",\"isDisabled\":false},\"mq\":{\"displayText\":\"Martinique\",\"isDisabled\":false},\"mr\":{\"displayText\":\"Mauritania\",\"isDisabled\":false},\"mu\":{\"displayText\":\"Mauritius\",\"isDisabled\":false},\"yt\":{\"displayText\":\"Mayotte\",\"isDisabled\":false},\"mx\":{\"displayText\":\"Mexico\",\"isDisabled\":false},\"fm\":{\"displayText\":\"Micronesia\",\"isDisabled\":false},\"md\":{\"displayText\":\"Moldova\",\"isDisabled\":false},\"mc\":{\"displayText\":\"Monaco\",\"isDisabled\":false},\"mn\":{\"displayText\":\"Mongolia\",\"isDisabled\":false},\"me\":{\"displayText\":\"Montenegro\",\"isDisabled\":false},\"ms\":{\"displayText\":\"Montserrat\",\"isDisabled\":false},\"ma\":{\"displayText\":\"Morocco\",\"isDisabled\":false},\"mz\":{\"displayText\":\"Mozambique\",\"isDisabled\":false},\"mm\":{\"displayText\":\"Myanmar\",\"isDisabled\":false},\"na\":{\"displayText\":\"Namibia\",\"isDisabled\":false},\"nr\":{\"displayText\":\"Nauru\",\"isDisabled\":false},\"np\":{\"displayText\":\"Nepal\",\"isDisabled\":false},\"nl\":{\"displayText\":\"Netherlands\",\"isDisabled\":false},\"nc\":{\"displayText\":\"New Caledonia\",\"isDisabled\":false},\"nz\":{\"displayText\":\"New Zealand\",\"isDisabled\":false},\"ni\":{\"displayText\":\"Nicaragua\",\"isDisabled\":false},\"ne\":{\"displayText\":\"Niger\",\"isDisabled\":false},\"ng\":{\"displayText\":\"Nigeria\",\"isDisabled\":false},\"nu\":{\"displayText\":\"Niue\",\"isDisabled\":false},\"nf\":{\"displayText\":\"Norfolk Island\",\"isDisabled\":false},\"mp\":{\"displayText\":\"Northern Mariana Islands\",\"isDisabled\":false},\"no\":{\"displayText\":\"Norway\",\"isDisabled\":false},\"om\":{\"displayText\":\"Oman\",\"isDisabled\":false},\"pk\":{\"displayText\":\"Pakistan\",\"isDisabled\":false},\"pw\":{\"displayText\":\"Palau\",\"isDisabled\":false},\"ps\":{\"displayText\":\"Palestinian Authority\",\"isDisabled\":false},\"pa\":{\"displayText\":\"Panama\",\"isDisabled\":false},\"pg\":{\"displayText\":\"Papua New Guinea\",\"isDisabled\":false},\"py\":{\"displayText\":\"Paraguay\",\"isDisabled\":false},\"pe\":{\"displayText\":\"Peru\",\"isDisabled\":false},\"ph\":{\"displayText\":\"Philippines\",\"isDisabled\":false},\"pn\":{\"displayText\":\"Pitcairn Islands\",\"isDisabled\":false},\"pl\":{\"displayText\":\"Poland\",\"isDisabled\":false},\"pt\":{\"displayText\":\"Portugal\",\"isDisabled\":false},\"pr\":{\"displayText\":\"Puerto Rico\",\"isDisabled\":false},\"qa\":{\"displayText\":\"Qatar\",\"isDisabled\":false},\"re\":{\"displayText\":\"R\u00E9union\",\"isDisabled\":false},\"ro\":{\"displayText\":\"Romania\",\"isDisabled\":false},\"ru\":{\"displayText\":\"Russia\",\"isDisabled\":false},\"rw\":{\"displayText\":\"Rwanda\",\"isDisabled\":false},\"bl\":{\"displayText\":\"Saint Barth\u00E9lemy\",\"isDisabled\":false},\"sh\":{\"displayText\":\"St Helena, Ascension, Tristan da Cunha\",\"isDisabled\":false},\"kn\":{\"displayText\":\"Saint Kitts and Nevis\",\"isDisabled\":false},\"lc\":{\"displayText\":\"Saint Lucia\",\"isDisabled\":false},\"mf\":{\"displayText\":\"Saint Martin\",\"isDisabled\":false},\"pm\":{\"displayText\":\"Saint Pierre and Miquelon\",\"isDisabled\":false},\"vc\":{\"displayText\":\"Saint Vincent and the Grenadines\",\"isDisabled\":false},\"ws\":{\"displayText\":\"Samoa\",\"isDisabled\":false},\"sm\":{\"displayText\":\"San Marino\",\"isDisabled\":false},\"st\":{\"displayText\":\"S\u00E3o Tom\u00E9 and Pr\u00EDncipe\",\"isDisabled\":false},\"sa\":{\"displayText\":\"Saudi Arabia\",\"isDisabled\":false},\"sn\":{\"displayText\":\"Senegal\",\"isDisabled\":false},\"rs\":{\"displayText\":\"Serbia\",\"isDisabled\":false},\"sc\":{\"displayText\":\"Seychelles\",\"isDisabled\":false},\"sl\":{\"displayText\":\"Sierra Leone\",\"isDisabled\":false},\"sg\":{\"displayText\":\"Singapore\",\"isDisabled\":false},\"sx\":{\"displayText\":\"Sint Maarten\",\"isDisabled\":false},\"sk\":{\"displayText\":\"Slovakia\",\"isDisabled\":false},\"si\":{\"displayText\":\"Slovenia\",\"isDisabled\":false},\"sb\":{\"displayText\":\"Solomon Islands\",\"isDisabled\":false},\"so\":{\"displayText\":\"Somalia\",\"isDisabled\":false},\"za\":{\"displayText\":\"South Africa\",\"isDisabled\":false},\"gs\":{\"displayText\":\"South Georgia and South Sandwich Islands\",\"isDisabled\":false},\"es\":{\"displayText\":\"Spain\",\"isDisabled\":false},\"lk\":{\"displayText\":\"Sri Lanka\",\"isDisabled\":false},\"sr\":{\"displayText\":\"Suriname\",\"isDisabled\":false},\"sj\":{\"displayText\":\"Svalbard\",\"isDisabled\":false},\"sz\":{\"displayText\":\"Eswatini\",\"isDisabled\":false},\"se\":{\"displayText\":\"Sweden\",\"isDisabled\":false},\"ch\":{\"displayText\":\"Switzerland\",\"isDisabled\":false},\"tw\":{\"displayText\":\"Taiwan\",\"isDisabled\":false},\"tj\":{\"displayText\":\"Tajikistan\",\"isDisabled\":false},\"tz\":{\"displayText\":\"Tanzania\",\"isDisabled\":false},\"th\":{\"displayText\":\"Thailand\",\"isDisabled\":false},\"tl\":{\"displayText\":\"Timor-Leste\",\"isDisabled\":false},\"tg\":{\"displayText\":\"Togo\",\"isDisabled\":false},\"tk\":{\"displayText\":\"Tokelau\",\"isDisabled\":false},\"to\":{\"displayText\":\"Tonga\",\"isDisabled\":false},\"tt\":{\"displayText\":\"Trinidad and Tobago\",\"isDisabled\":false},\"tn\":{\"displayText\":\"Tunisia\",\"isDisabled\":false},\"tr\":{\"displayText\":\"Turkey\",\"isDisabled\":false},\"tm\":{\"displayText\":\"Turkmenistan\",\"isDisabled\":false},\"tc\":{\"displayText\":\"Turks and Caicos Islands\",\"isDisabled\":false},\"tv\":{\"displayText\":\"Tuvalu\",\"isDisabled\":false},\"ug\":{\"displayText\":\"Uganda\",\"isDisabled\":false},\"ua\":{\"displayText\":\"Ukraine\",\"isDisabled\":false},\"ae\":{\"displayText\":\"United Arab Emirates\",\"isDisabled\":false},\"gb\":{\"displayText\":\"United Kingdom\",\"isDisabled\":false},\"us\":{\"displayText\":\"United States\",\"isDisabled\":false},\"um\":{\"displayText\":\"U.S. Outlying Islands\",\"isDisabled\":false},\"uy\":{\"displayText\":\"Uruguay\",\"isDisabled\":false},\"uz\":{\"displayText\":\"Uzbekistan\",\"isDisabled\":false},\"vu\":{\"displayText\":\"Vanuatu\",\"isDisabled\":false},\"va\":{\"displayText\":\"Vatican City\",\"isDisabled\":false},\"ve\":{\"displayText\":\"Venezuela\",\"isDisabled\":false},\"vn\":{\"displayText\":\"Vietnam\",\"isDisabled\":false},\"vg\":{\"displayText\":\"British Virgin Islands\",\"isDisabled\":false},\"vi\":{\"displayText\":\"U.S. Virgin Islands\",\"isDisabled\":false},\"wf\":{\"displayText\":\"Wallis and Futuna\",\"isDisabled\":false},\"ye\":{\"displayText\":\"Yemen\",\"isDisabled\":false},\"zm\":{\"displayText\":\"Zambia\",\"isDisabled\":false},\"zw\":{\"displayText\":\"Zimbabwe\",\"isDisabled\":false}},\"displaySelectionText\":\"--Select--\",\"displayErrorMessages\":{\"defaultErrorMessage\":\"Incorrectly formatted country\",\"fromErrorCode\":[{\"errorCode\":\"required_field_empty\",\"errorMessage\":\"Country/Region is a required field\"}]},\"displayId\":\"addressCountry\",\"displayType\":\"property\",\"isDisabled\":true,\"propertyName\":\"country\",\"tags\":{\"theme\":\"windows\",\"accessibilityName\":\"Country/Region\"}}],\"displayId\":\"addressDetailsDataGroup\",\"displayType\":\"group\"},{\"members\":[{\"displayContent\":\"Microsoft respects your privacy. See our \",\"displayId\":\"microsoft_privacy_static_text\",\"displayType\":\"text\"},{\"sourceUrl\":\"https://go.microsoft.com/fwlink/?LinkId=248681\",\"displayContent\":\"privacy statement\",\"displayId\":\"privacyStatement\",\"displayType\":\"hyperlink\",\"pidlAction\":{\"type\":\"navigate\",\"context\":\"https://go.microsoft.com/fwlink/?LinkId=248681\"}},{\"displayContent\":\".\",\"displayId\":\"staticPeriodText\",\"displayType\":\"text\"}],\"displayId\":\"microsoftPrivacyTextGroup\",\"displayType\":\"textgroup\",\"tags\":{\"privacy-text-group\":\"privacy-text-group\"}},{\"isSubmitGroup\":true,\"layoutOrientation\":\"inline\",\"members\":[{\"displayContent\":\"Back\",\"displayId\":\"addressBackButton\",\"displayType\":\"button\",\"isBack\":true,\"pidlAction\":{\"type\":\"movePrevious\",\"context\":\"\"},\"tags\":{\"accessibilityName\":\"Back\"}},{\"displayContent\":\"Save\",\"displayId\":\"saveButton\",\"displayType\":\"button\",\"isHighlighted\":true,\"pidlAction\":{\"type\":\"submit\",\"isDefault\":true,\"context\":{\"href\":\"https://{pifd-endpoint}/users/{userId}/addressesEx?partner=amcweb&language=en-US&avsSuggest=True\",\"method\":\"POST\"}},\"tags\":{\"accessibilityName\":\"Save\"}}],\"displayId\":\"addressBackSaveGroup\",\"displayType\":\"group\"}],\"displayId\":\"addressSuggestionPage2\",\"displayType\":\"page\"}],\"strings\":{\"constants\":{\"singleFieldErrorMessage\":\"There is 1 field in the form that requires your attention\",\"multipleFieldsErrorMessage\":\"There are {n} fields in the form that require your attention\"},\"serverErrorCodes\":{\"InvalidAddress\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"postal_code,city,region\"},\"InvalidAddressFieldsCombination\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"postal_code,city,region\"},\"InvalidProperty\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1,address_line2,address_line3,postal_code,city,region\"},\"InvalidCity\":{\"ErrorMessage\":\"Check the city in your address. There appears to be an error in it.\",\"Target\":\"city\"},\"InvalidPostalCode\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address.\uFFFDThere appears to be an error in it.\",\"Target\":\"postal_code\"},\"InvalidRegion\":{\"ErrorMessage\":\"Check the state in your address.\uFFFDThere appears to be an error in it.\",\"Target\":\"region\"},\"10021\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"10033\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"40005\":{\"ErrorMessage\":\"Check your address. A required field is missing.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"60010\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"address_line1, address_line2,address_line3,city,region,country,postal_code\"},\"60012\":{\"ErrorMessage\":\"Check the state in your address. There appears to be an error in it.\",\"Target\":\"region\"},\"60016\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60017\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60018\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60019\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region,postal_code\"},\"60011\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60013\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,postal_code\"},\"60014\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"},\"60015\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,region\"},\"60041\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"},\"60042\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60045\":{\"ErrorMessage\":\"Check the state in your address. There appears to be an error in it.\",\"Target\":\"region\"},\"60071\":{\"ErrorMessage\":\"Check your address. There appears to be an error in it.\",\"Target\":\"city,postal_code\"},\"60029\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"postal_code\"},\"60030\":{\"ErrorMessage\":\"Check the Zip or Postal code in your address. There appears to be an error in it.\",\"Target\":\"region,postal_code\"}}}}]";
            foreach (string operation in pidlOperations)
            {
                foreach (var avsSuggest in avsSuggests)
                {
                    using (var session = new TraceEventSession(XPertPaymentsSessionName, etlFileName))
                    {
                        session.EnableProvider(SllProviderID);
                    }

                    using (var source = new ETWTraceEventSource(etlFileName))
                    {
                        var parser = new DynamicTraceEventParser(source);
                        parser.All += delegate(TraceEvent data)
                        {
                            if (string.Equals(data.EventName, "GeneralInformational/Message")
                            && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("Microsoft.Commerce.Tracing.Sll.PXServiceIncomingOperation") > 0)
                            {
                                var eventString = (string)data.PayloadByName("commonSchemaEvent");
                                dynamic log = JsonConvert.DeserializeObject(eventString);
                                string responseDetail = log.data.ResponseDetails;
                                Assert.AreEqual(26500, responseDetail.Length);
                            }
                        };

                        source.Process();
                    }
                }
            }
        }

        [TestMethod]
        public void TracePXServiceException()
        {
            string etlFileName = "PXServiceSllWebLoggerTest_TracePXServiceException.etl";
            EventTraceActivity requestTraceId = new EventTraceActivity(Guid.NewGuid());
            Exception exception = new PIDLConfigException("testErrorMessage", "testErrorCode");

            // Sessions collect and control event providers.
            using (var session = new TraceEventSession(XPertPaymentsSessionName, etlFileName))
            {
                session.EnableProvider(SllProviderID);
                SllWebLogger.TracePXServiceException(exception.ToString(), requestTraceId);
            }

            bool receivedExpectedTraceData = false;

            using (var source = new ETWTraceEventSource(etlFileName))
            {
                var parser = new DynamicTraceEventParser(source);
                parser.All += delegate(TraceEvent data)
                {
                    if (string.Equals(data.EventName, "GeneralError/Message")
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("Microsoft.Commerce.Tracing.Sll.PXServiceTraceException") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("RequestTraceId\":\"{0}", requestTraceId.ActivityId.ToString())) > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("Exception\":\"{0}", exception.ToString())) > 0)
                    {
                        receivedExpectedTraceData = true;
                    }
                };

                source.Process();
            }

            Assert.IsTrue(receivedExpectedTraceData, "Expected trace data is not received");
        }

        [TestMethod]
        public void TracePXServiceIntegrationError()
        {
            string etlFileName = "PXServiceSllWebLoggerTest_TracePXServiceIntegration.etl";

            string fullRequestUrl = "https://paymentinstruments.mp.microsoft.com/v6.0/users/me/paymentMethodDescriptions?partner=invalidParamValue&operation=Add&language=pt-BR&family=credit_card&country=br&completePrerequisites=true";
            string serviceName = "serviceName";
            EventTraceActivity requestTraceId = new EventTraceActivity(Guid.NewGuid());
            EventTraceActivity serverTraceId = new EventTraceActivity(Guid.NewGuid());
            IntegrationErrorCode integrationErrorCode = IntegrationErrorCode.InvalidRequestParameterFormat;
            string invalidParamValue = "invalidParamValue";
            string message = string.Format("The format of request parameter {0} is invalid in the request URL: {1}.", invalidParamValue, fullRequestUrl);

            // Sessions collect and control event providers.
            using (var session = new TraceEventSession(XPertPaymentsSessionName, etlFileName))
            {
                session.EnableProvider(SllProviderID);
            }

            bool receivedExpectedTraceData = false;

            using (var source = new ETWTraceEventSource(etlFileName))
            {
                var parser = new DynamicTraceEventParser(source);
                parser.All += delegate(TraceEvent data)
                {
                    if (string.Equals(data.EventName, "GeneralWarning/Message")
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf("Microsoft.Commerce.Tracing.Sll.PXServiceIntegrationError") > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("ServiceName\":\"{0}", serviceName)) > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("IntegrationErrorCode\":\"{0}", integrationErrorCode.ToString())) > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("ServerTraceId\":\"{0}", serverTraceId.ActivityId.ToString())) > 0
                    && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("RequestTraceId\":\"{0}", requestTraceId.ActivityId.ToString())) > 0
                   && ((string)data.PayloadByName("commonSchemaEvent")).IndexOf(string.Format("The format of request parameter {0} is invalid in the request URL: {1}.", invalidParamValue, fullRequestUrl)) > 0)
                    {
                        receivedExpectedTraceData = true;
                    }
                };

                source.Process();
            }

            Assert.IsTrue(receivedExpectedTraceData, "Expected trace data is not received");
        }

        private HttpRequest BuildHttpRequest(string operationName, string method, string partner, string operation, string accountId, string payload = null)
        {
            var context = new DefaultHttpContext();
            var request = context.Request;

            // Set method
            request.Method = method.ToUpperInvariant();

            // Set path and query string
            request.Path = $"/{accountId}/{operationName}";
            request.QueryString = new QueryString($"?partner={partner}&operation={operation}");

            // Set content if applicable
            if (!string.IsNullOrEmpty(payload))
            {
                var bodyBytes = Encoding.UTF8.GetBytes(payload);
                request.Body = new MemoryStream(bodyBytes);
                request.ContentType = "application/json";
                request.ContentLength = bodyBytes.Length;
            }

            return request;
        }

        private HttpResponse BuildHttpResponse(string payload)
        {
            var context = new DefaultHttpContext();
            var response = context.Response;

            // Reset and write payload to the response body
            response.Body = new MemoryStream();
            var buffer = Encoding.UTF8.GetBytes(payload);
            response.Body.Write(buffer, 0, buffer.Length);
            response.ContentType = "application/json";
            response.ContentLength = buffer.Length;

            // Rewind for later reading
            response.Body.Seek(0, SeekOrigin.Begin);

            return response;
        }
    }
}

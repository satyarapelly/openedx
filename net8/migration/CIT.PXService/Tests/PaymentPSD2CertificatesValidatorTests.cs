// <copyright file="PaymentPSD2CertificatesValidatorTests.cs" company="Microsoft">Copyright (c) Microsoft. All rights reserved.</copyright>

namespace CIT.PXService.Tests
{
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using Microsoft.Commerce.Payments.Common;
    using Microsoft.Commerce.Payments.Common.Web;
    using Microsoft.Commerce.Payments.PXService.V7.PaymentChallenge;
    using Microsoft.Commerce.Tracing;
    using Microsoft.VisualStudio.TestTools.UnitTesting;
    using Common = Microsoft.Commerce.Payments.Common.Transaction;

    [TestClass]
    public class PaymentPSD2CertificatesValidatorTests
    {
        private const string AcsSignedContentVisa = "eyJ4NWMiOlsiTUlJRnpUQ0NBN1dnQXdJQkFnSVFVMXFRWjRzV1B2alRWNU5tVGwvc1NEQU5CZ2txaGtpRzl3MEJBUXNGQURCMk1Rc3dDUVlEVlFRR0V3SlZVekVOTUFzR0ExVUVDZ3dFVmtsVFFURXZNQzBHQTFVRUN3d21WbWx6WVNCSmJuUmxjbTVoZEdsdmJtRnNJRk5sY25acFkyVWdRWE56YjJOcFlYUnBiMjR4SnpBbEJnTlZCQU1NSGxacGMyRWdaVU52YlcxbGNtTmxJRWx6YzNWcGJtY2dRMEVnTFNCSE1qQWVGdzB5TXpBek1qZ3dPREkxTURaYUZ3MHlOREF6TWpjd09ESTFNRFZhTUhreER6QU5CZ05WQkFjTUJsTnNiM1ZuYURFU01CQUdBMVVFQ0F3SlFtVnlhM05vYVhKbE1Rc3dDUVlEVlFRR0V3SkhRakVaTUJjR0ExVUVDZ3dRVWxOQklGTmxZM1Z5YVhSNUlFeE1RekVNTUFvR0ExVUVDd3dETTBSVE1Sd3dHZ1lEVlFRRERCTldhWE5oSUZObFkzVnlaU0JUYVdkdWFXNW5NSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTNuNjd3NmFTbG1kb2tEbHRxb3RYR05nN1FqZTFkS1JqM1UzRXRoL05BNG9XTHNPWXUvY3hhYzdweURMa1NBR1BiRVN0amlFNk1DSTM4L3phU0dqaWU0am10bTlUWi9XbGNwZHhWKzVzOCtqU0w5YzNFcGJWODhXcm1PV0dBbFNVMkRIWEFVMVVYYktHRHhtQXhISEJrTGdjeGtVdkhuemtYem5Oek1CWWI5VUlmbTg5OHVFbEh6VDdJVVJZZk9wWTlnT3dtWHJVNnFybWdjb3p3RDZZaTdMNUxsYlQvWmtORUNDTTM1TGxCeVZxUWMvN0FLWHoxaFY5VnhmRGRKKzExYTAvVnZoTnVTR0h5Y0dDYndPR0JIckorYUQxSmRJcjJSWWV2S2RmamNZZUF3WGM2ejdiMlpFaThFVG1hc2UzWHZMS3lzSUxqSjVjSzkrSFpoRjFFd0lEQVFBQm80SUJVakNDQVU0d0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JTOUoyTW9wSzVVdDhnanQ4RTFRaGZweG5oZmhUQm5CZ2dyQmdFRkJRY0JBUVJiTUZrd01BWUlLd1lCQlFVSE1BS0dKR2gwZEhBNkx5OWxibkp2Ykd3dWRtbHpZV05oTG1OdmJTOWxRMjl0YlVjeUxtTnlkREFsQmdnckJnRUZCUWN3QVlZWmFIUjBjRG92TDI5amMzQXVkbWx6WVM1amIyMHZiMk56Y0RBNUJnTlZIU0FFTWpBd01DNEdCV2VCQXdFQk1DVXdJd1lJS3dZQkJRVUhBZ0VXRjJoMGRIQTZMeTkzZDNjdWRtbHpZUzVqYjIwdmNHdHBNQk1HQTFVZEpRUU1NQW9HQ0NzR0FRVUZCd01DTURVR0ExVWRId1F1TUN3d0txQW9vQ2FHSkdoMGRIQTZMeTlsYm5KdmJHd3VkbWx6WVdOaExtTnZiUzlsUTI5dGJVY3lMbU55YkRBZEJnTlZIUTRFRmdRVUNpOTVSZ2psc21wczBUVU9qbnF4dXR0a1RIUXdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQmVGM0hKTFR5cGZSeWJmWXpkN2s2KzJPSjYyWkhVYnhhcTNGazd0Sld3YlF0QU42YTZYOGNDTTRFTnlYL1FxREJPNFVVYnNBV1ZEQzZwRGVOYkVhUktaWXJLbHJ3WGp0RllhSUF4d3o0WkxKVXZPUms2T09Wb2daZWFGY2tubGJWZW5QdEc2TVBXNmRVc1JYKy9SQzloMWNNS2hlaklhMFdhd1BNRlhtdUpaMzVtMm1XRDRaYTZoRVlKMXpNZWgya0FYdmxzbTliZmo0RXlWUHJhb1JzeXJHbEN0MkZKdkl4N3JNb1lETjNFOGlLWHYva2ZYU1JiNGw5YlJaM0M1dVM0bkcrZ0tpZjVBLzJmWnNCcUU1UHVwRUVWSTd1QWxTckNlTWNMTXhnUjhUWENKS2toWjBETzk1ZklMSUh2TmluQUtFVUpGL1F4VkczMm90WldIeFZGSXV5dlJyeFF6a3B2MU1Tei9yeGlMdFdNREpyNWZNSnZRSjVmay94b0tobXp0MGRHdVNaSVR3M1h2T3FxMzZUN0syMUV1WlpSV2Z1N1BxbzFvRTQ4QjZrR3ZxcEdXYXFkNWpVSjZxbGNoWmxIWEZyYUJWSWxiQ2FzcnhjSHZTeVRSTUhkVFYybFE4em14MzkrQTdPZ3BndHdxZlIwSk9vdk5zc2JVeE9nVXEzWHdXRGNpL2kyU1ltRE9XdUNWMXUvWW9USytROUx4WGg0alcxeUFOQ1ZCMTBMTHJVTFJkTlcwWVZ6V2hqSjJpQmpOUTJqcHBGSnhlcG1NLy80TWdjRHFLL0ROU2FVVm15dWk4ZlU3NHpBSzJpWWpWQ3ZhSDlTdVRxQWNrL0FEcVM5WWEyUnhzVDI2bWdiTEIvUXFVL0QyN2pUd25JMUluZ3Y5b3RsYkNES3lRPT0iLCJNSUlHNFRDQ0JNbWdBd0lCQWdJUFVUNldBQUFBNWFOdGhQVGQ1SUJsTUEwR0NTcUdTSWIzRFFFQkN3VUFNRzh4Q3pBSkJnTlZCQVlUQWxWVE1RMHdDd1lEVlFRS0RBUldTVk5CTVM4d0xRWURWUVFMRENaV2FYTmhJRWx1ZEdWeWJtRjBhVzl1WVd3Z1UyVnlkbWxqWlNCQmMzTnZZMmxoZEdsdmJqRWdNQjRHQTFVRUF3d1hWbWx6WVNCUWRXSnNhV01nVWxOQklGSnZiM1FnUTBFd0hoY05NakV3TmpBek1EQXdNREF3V2hjTk5ERXdNekV4TURBd01EQXdXakIyTVFzd0NRWURWUVFHRXdKVlV6RU5NQXNHQTFVRUNnd0VWa2xUUVRFdk1DMEdBMVVFQ3d3bVZtbHpZU0JKYm5SbGNtNWhkR2x2Ym1Gc0lGTmxjblpwWTJVZ1FYTnpiMk5wWVhScGIyNHhKekFsQmdOVkJBTU1IbFpwYzJFZ1pVTnZiVzFsY21ObElFbHpjM1ZwYm1jZ1EwRWdMU0JITWpDQ0FpSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnSVBBRENDQWdvQ2dnSUJBSTlFa3BBL1BDczhSYno4L1dUbFZLeFh2ajlZNUJJWDZuVkhWMjFJRVVhZk5ZQXZDcUwxbzlodHJkcm1ValpuNmNpNVkxZzlmR0hla1RmaWJEb3VDaGtreHlpVnMybHo4Sm9FR3VKZnVESi9ValVKUlJmczVMbEhDdldpYmhNaVgvQXRkRll6YlZQUU90V3B5UG1mL2ZaVVJ3YTl0THRsQUVIcjZlckFVcUxXam03N3B5b2ZRV2N5SFQ5K1VnOEVCc0ZTM1JSQVc2SUxOaUtYQ1Y5WlNITkxMV0Zta2didmZ5dkJFN1ZtQUphdllGMmNGSU9DdEJyWERac1YvY3hGek9iQy9FTUN5WnA5T29hMGlZU0Z4TGF5dFN4OHB3bUkwc2hsZUZSSEtvYzc2ZVZjb29UN1ltMTNocmgzODhHbmczQzRaUjRVSXVhb05saFNMZlVub0ZsTlJESVB3a3k1S0M2MnV1UEJoNmFIbEttTU9zcDArelRmcTh1MXNqTXl6dUZ5Sm5rL0QxMmtrTFBqVHBBQlN2MXplVmpsS3h6dmxyVk5sZVBnWTRsU1B2dEliTGNCbjJZSEVsVGU0WW9aSzEySDhSR2xodUZEek5tNElXRGZxSUZpUEQ3S1lGV0twMDY5QTZFR0E4TDkzbVNvUElzOVNDSXdpMnEzc2hRQk9NamVMS2hMQUIxTmdSSTF2Y0w4L2RldXBwZXk3c2lLaCsxNU9BMFQ0dnRjTEl3dHUzU0Z5TXZEek1jaVFWMVliR1pteUlXQVp3R2xxdEgwaGtrUXllV0NyQ3ZpSWNWWjNNWDZkditvUkUxWWhJOWxYWklicGtoZitJTmJBVzdWZ0V6S0F3VHJ1QWVtZTdUTEIxVXZvWUpWM21VQ1EwS1FhQWVpL1JZZUU5dEZBZ01CQUFHamdnRnhNSUlCYlRBZkJnTlZIU01FR0RBV2dCUkxUYVlPKzZBUjZLMEw0dkR6Q2dBdnJJc1crekFkQmdOVkhRNEVGZ1FVdlNkaktLU3VWTGZJSTdmQk5VSVg2Y1o0WDRVd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd1d3WURWUjBnQkZRd1VqQXlCZ2dyQmdFRkJRY0NBVEFtTUNRR0NDc0dBUVVGQndJQkZoaG9kSFJ3Y3pvdkwzZDNkeTUyYVhOaExtTnZiUzl3YTJrd0NBWUdaNEVNQVFJQ01BZ0dCbWVCQXdFQkFUQUlCZ1puZ1FNQkFRSXdIUVlEVlIwbEJCWXdGQVlJS3dZQkJRVUhBd0VHQ0NzR0FRVUZCd01DTUQ4R0ExVWRId1E0TURZd05LQXlvRENHTG1oMGRIQTZMeTlsYm5KdmJHd3VkbWx6WVdOaExtTnZiUzlXYVhOaFVIVmliR2xqVWxOQlVtOXZkQzVqY213d1NnWUlLd1lCQlFVSEFRRUVQakE4TURvR0NDc0dBUVVGQnpBQ2hpNW9kSFJ3T2k4dlpXNXliMnhzTG5acGMyRmpZUzVqYjIwdlZtbHpZVkIxWW14cFkxSlRRVkp2YjNRdVkzSjBNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUNCV1ZiQ2hRem1YQ2pPd3E5VW1vREwvTVJqZkNraDFhK0Y5K1kzRkcrbWRJM0ViUDlxMFU5ZGdIMnNTUU02V0ZoM041UGVBVVoxanFBOGQzTDFueVMxbzkvYmxSeU0ydmlFellMeFF5aUFIbHd6QXd2Q3o0THlIOU9yTko5TFVYcGE0TE5sMktrQXI4SEhDNWxSVUNYL2lnQWxFWFNlUVAvaE1iN0NKWGk3cmNaalM3RVFqb2d2bUJqTDJxSDA0R04ya1VsdU9XNWRJZkdxVHh4S05tOXhPZ2FDR3kxbVJucjFBUGNQZFlPNGRNQi9mRWNRNlpGME9OTUNlc3hOMnd6SHhTUXNDQUZ1QUg0eUJWdXNmUERieDdzU2tUOXNZbXN1UDBLajNNeFdYZTZ2dGZrVCtQTE9mNHJtRjc5MXlxaEJiUDRUS2pQSTlGa3F5MFY1RURiUEFrRk5BM2xRcElKNEcyc1I4ZFhpYVhKb3dqQ1czMEh6RmxCVXZiVUpPQjlJUXdCcGZ1TXp1dlNWWmw4OWV5T0UyNmx2TmJSMHptRURPMnQ2RlpHT2NGNVh3VWloWWlncGNzcnVEdWxFUnQ3eGZYRDVESEpQVS96Q3dyMDJSc0JZMUh0dlkyRHh5Y3ZBMWJiVnZabzRlbXoyRXpRNVZaZDdxbGI4aDdWYXE2Q0p6SGxmaUs4U01KWTh3d0Z2MGNSM2hQN3JZemxQR05sZlUvMkVHdDRET3U5MG81Z2VaNkRIeEQxczVpRVhTRWJ2aUx6UHZnWDBCZ2Z2ekZyQkJRNnB5eTVTZ2xTNWtjRlF2cWpOQ0Y5OUZlOTY5dHR6KzdJMitnNnF4YU9XSHowck5Tb0FRL0J3MHZDUk82N0VwMTZxdlZveW81azU1TWY2M3llRnhGaTNFUT09IiwiTUlJRnFUQ0NBNUdnQXdJQkFnSVBVVDZXQUFBQTIwUW43cXpndnVGSU1BMEdDU3FHU0liM0RRRUJDd1VBTUc4eEN6QUpCZ05WQkFZVEFsVlRNUTB3Q3dZRFZRUUtEQVJXU1ZOQk1TOHdMUVlEVlFRTERDWldhWE5oSUVsdWRHVnlibUYwYVc5dVlXd2dVMlZ5ZG1salpTQkJjM052WTJsaGRHbHZiakVnTUI0R0ExVUVBd3dYVm1sellTQlFkV0pzYVdNZ1VsTkJJRkp2YjNRZ1EwRXdIaGNOTWpFd016RTJNREF3TURBd1doY05OREV3TXpFMU1EQXdNREF3V2pCdk1Rc3dDUVlEVlFRR0V3SlZVekVOTUFzR0ExVUVDZ3dFVmtsVFFURXZNQzBHQTFVRUN3d21WbWx6WVNCSmJuUmxjbTVoZEdsdmJtRnNJRk5sY25acFkyVWdRWE56YjJOcFlYUnBiMjR4SURBZUJnTlZCQU1NRjFacGMyRWdVSFZpYkdsaklGSlRRU0JTYjI5MElFTkJNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQTJXRWJYTFMzZ0k2TE9ZOTNiUDdLejZFTzlMMVFYbHI4bCtmVGtKV1psZEo2UXV3WjFjdjQzNjl0ZmplSjhPNXdTSmlEY1Z3N2VOZE9QNzNMZkF0d0hsVG5VbmIwZTlJTFRUaXBjNWJrTm5BZXZvY3JKQUNzcnBpUThqQkk5dHRwY3FLVWVKZ3pXNEllMjV5cGlyS3JvVkQ0MmI0RTBpSUNLMmNaNVFmRDRCU3pVbmZ0cDRCcWg4QWZwR3ZHMWxyZUNhRDUzcXJzeTVTVWFkWS9OYWVVR09rcWRQdkRTTm9ESWRyYkV4d25aYVNGVW1qUVQxc3ZLd01xR28yR0ZyZ0o0Y1VMRXA0Tk5qNXJnYThZVFRaN1hvNU1ibEhyTHBTUE9tSmV2MzBLV2kvQmNidnRDTllOV0JUZzdVTXpQM2NLTVExcEdMdkcyUGd2RlRaU1J2SDNRem5nSlJnckRZWU9KNmtqOWF2ZSs2eU9PRnFqODBaQ3VIME51Z3QybU1TM2MzK05rc2F3KzZIM2NRUHNFL0d2NXpqZnNLbGVSaEVGdEUxZ3lyZFVnMURNZ3U4by9ZaEtNN0ZBcWtYVW43NHp3b1JGZ3gzTWk1T2FHVFFiZytObHdKZ1I0c1ZIWENWNHM5YjhQam5lTGh6V01uMzUzU0ZBUkY5ZG5PN0xEQnFxdFQ2V2x0SnUxejl4MlplMFVWTlp2eEtHY3lDa0xvZHkyOU84ajkvTUdaOFNPU1V1NFU2TkhyZWJLdXVmOUZodG42UHFRNHBwa2h5NnNSZVhlVjVOVkdmVnBEWVk1WkFLRVdxVFlnTVVMV3BRMlB5NEJHcEZ6QmUwN2pYa3l1bFJwb0t2ejE0aVhlQTBvcTE2Yzk0RHJGWVgwam1yV0xlVTRhL1RDWlFMRklzQ0F3RUFBYU5DTUVBd0hRWURWUjBPQkJZRUZFdE5wZzc3b0JIb3JRdmk4UE1LQUMrc2l4YjdNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEZ1lEVlIwUEFRSC9CQVFEQWdFR01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQzVCVTlxUVNaWVBjZ0NwMngwSnVxNTlrTW1YdUJseTA5NERhRW5QcXZ0Q2d3d0Fpcmt2OHg4L1FTT3hpV1dpdStudmV5dVIrajZHei9mSmFWNHUrSjVRRUR5Y2ZrNjA1TXczSEljSk9lWnZEZ2sxZXlPbVF3VVA2Wi9CZFFUTkptWjkyWjhkY0c1eVdDeExCcnFQSDdybzNTc2poWXE5ZHVJSlU3amZpekNKQ040Vzh0cDBEMnBXQmUxL0NZTnN3UDRHTXM1alE1K1pRS04vTDVKRmR3VlR1N1hQdDhiNXpmZ2JtbVFwVm1VbjBvRndtM09JKytaNmdFcE5tVzViZC8yb1VJWm9HOTZRZmYyZmF1Vk1BWWlXUXZObkwzeTFna1JndVRPU01WVUNDaUdmZHZ3dTV5Z293aWxsdlYybkhiNytZaWJROU41WjJzcFAwbzlabGZ6b2F0MjdXRnB5SzQ3VGlVZHUvNHRvYXJMS0daUCtoYkEvRjR4bG5NLzhFZlprRTFEZVRUSTBsaE4zTzh5RXNIcnRSbDFPdVFaL0lleEhPOFVHVTZqdm40VFdvMTBIWWVYenJHY2tMN29JWGZHVHJqUHpmWTYyVDVIRFcvQkFFWlMrOVRraWp6MjVZTTBmUFB6N0lkbEVHK2s0cTRZd1o4Mmo3M1k5a0RFTTU0MjNtcldvcnEvQnE3STVZOHYwTFRZOUdXSFlycEVsWWYwV2RPWEFic2Z3UWlUNnFuUmlvK3A4MlZ5cWxZOEp0NlZWQTZDRHkvaUhLd2NqMUVMRW5EUWZWdjloZWRveG1uUTZ4ZS9uSzhjemNsdTloUUpSdjVMaDlnazlROERLSzJubWd6WjhTU1ErbHIzbVNTZVk4Sk9NUmxFK1JLZE9RSUNoV3RoVEpLaDd3PT0iXSwiYWxnIjoiUFMyNTYifQ.eyJhY3NVUkwiOiJodHRwczovL3d3dy5yc2EzZHNhdXRoLmNvLnVrLzNkczIvQ1JlcT9pc3N1ZXI9YmFyY2xheXMiLCJhY3NFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsIngiOiJJVkUwaWI4d1BiVGpYdi1ZOUVEbHVjQlN0ekxfOWwtTWJ0LVJvNW4zN2EwIiwieSI6Im5OVGY0T2xqa3ZmV0pPbWVmSjlBWGdmMnhFSi0xWEpPeEVNRjdsSXU4NTgiLCJjcnYiOiJQLTI1NiJ9LCJzZGtFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IjJiVUtvc1NsOTQwSk9IcWxLUWpqYnpUYW5KNEgtc1RwR2lkWjNyWnhib00iLCJ5IjoibXB3Ml9vaWNwU0tCWW1zNkx1T0haVWZ3ZEpkWXZPd0otdjRVcjhiMmJESSJ9fQ.G9Unj3pHpWFoLtW7Gjof5k810cZ6_c229ZhwZnA6I8wnEGXtBTB3n5OE4x0TwMfw-hiimQHlDvpu0hTXkPqwwsSypb0rwq6MM-7vvgnNzEmgOsG5THgawfgxEfEFmNtwNNFtir4GIFCN593HgQ47Lw2pG0SYHmM2Xh7KQc5KXyD0DpoK4wwbNyumkLkEujFAWtlNRrS6_M32m-3l0uZaWCULsyJ7Y9z6nNLY-T-31GkyA-3bKekfYpWEtcyAOtqPnvaaaxieb60rTuaX3FJYwo-8BmlVKFfc04fBJTj-OAJ7Wz_OSFlL8BMKzmTwM8-o43xTx59mEJJUNZdBDOVM4w";

        // [SuppressMessage("Microsoft.Security", "CS002:SecretInNextLine", Justification="Test ACS cert used in validation test")]
        private const string AcsSignedContentMastercard = "eyJ4NWMiOlsiTUlJRnREQ0NBNXlnQXdJQkFnSUlEek1MV200a2VuSXdEUVlKS29aSWh2Y05BUUVMQlFBd2VERUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlZCQW9UQ2sxaGMzUmxja05oY21ReEtEQW1CZ05WQkFzVEgwMWhjM1JsY2tOaGNtUWdTV1JsYm5ScGRIa2dRMmhsWTJzZ1IyVnVJRE14S2pBb0JnTlZCQU1USVZCU1JDQk5ZWE4wWlhKRFlYSmtJRE5FVXpJZ1NYTnpkV1Z5SUZOMVlpQkRRVEFlRncweU1UQXpNRFF4TVRReU16aGFGdzB5TkRBek1ETXhNVFF5TXpoYU1JR2pNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVVNQklHQTFVRUJ4TUxVMkZ1ZEdFZ1EyeGhjbUV4R0RBV0JnTlZCQW9URDBOQklGUmxZMmh1YjJ4dloybGxjekV2TUMwR0ExVUVDeFFtUVVOVFRWTXRRVU5UTFZZeU1UQXRRMEZmVkVWRFNFNVBURTlIU1VWVFh5MHROVFl6TURVeEhqQWNCZ05WQkFNVEZYUnplWE56YVdkdWFXNW5MbUZ5WTI5MExtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFJc01EVGxuMmJER3hnOVJDTmlDSFk5ako4WHNibVdvdVFXczg1b0F3b3BMVWxJd2RUM2ozZWsyR0Nqb3F1RWdMVmZyRWhVMHF0Z0p4MmhGM05adVUrQ0drOENodzVLQnJ2dTlEM0hqT3daTVwvQkZYXC9TekFKdWlGdnV5NlBDMElyd3M4UFVSdElFeEFxa2JyU2VlUFhsaE5wN3QzMnBJXC9wNmZIQnAyN0tydmdIckFCbGk1QXBxUHExMmdRT1FuZURzcDh1NzNsRVQxcCtadFFSRVdxMGdnYW9mM2EzOGVXSitHYmhFK1k1YlVxSURRRXRhTE5KNDllT2IyQlo0V3E1R3NNQ1BBZ2s3d0VwdnpPemw0dnhGbXJqMlBXdkc0Y29KcnFUWHFmbHpzOHlGSmtLZVpXaVBqZTVhMUZpdkgrMVRZQkRXRkdGZGJ1MlNYNndOY2FZSmNDQXdFQUFhT0NBUlF3Z2dFUU1BNEdBMVVkRHdFQlwvd1FFQXdJQWdEQUpCZ05WSFJNRUFqQUFNQjBHQTFVZERnUVdCQlFibkNoZ29ySlA0eTRzMExmcUYyYU5QNDVnZGpBZkJnTlZIU01FR0RBV2dCUlA5OE9mWXNwV1ZFdmZTSFRMY0J4dlBOMFFSVEJJQmdnckJnRUZCUWNCQVFROE1Eb3dPQVlJS3dZQkJRVUhNQUdHTEdoMGRIQTZMeTl2WTNOd0xuQnJhUzVwWkdWdWRHbDBlV05vWldOckxtMWhjM1JsY21OaGNtUXVZMjl0TUdrR0ExVWRId1JpTUdBd1hxQmNvRnFHV0doMGRIQTZMeTlqY213dWNHdHBMbWxrWlc1MGFYUjVZMmhsWTJzdWJXRnpkR1Z5WTJGeVpDNWpiMjB2TkdabU4yTXpPV1kyTW1OaE5UWTFORFJpWkdZME9EYzBZMkkzTURGak5tWXpZMlJrTVRBME5TNWpjbXd3RFFZSktvWklodmNOQVFFTEJRQURnZ0lCQUEyVHdDRlZldFEwbVNTQTNCMWR0bWVXUzc2dGVMMjBTVituV005RjdRQThDMERucGNiR0ZoYTVMeThVNE44XC95Sm1md1wvaTVGZ1JwM3BNbHhTNEdKcWo4SVdROHdGc2ZFa3VXR2JFVG0rZ3JzZ3FyUmt1TG93XC9sRHlCQm5QeGxXRkpISHJES1Y3UHZNUElkSFhFUUlKQWFhMDlGTHFqR0Y4OGJ4cThBR3ZaZmtjQWVaZ3lFeGFKdWxMU1ZBY0dqbEo2RDVWaGtBdVdZeXcyUXFjeGN4MmQzUUlKVlFRQ2ZQZ08xeWRDYXZhK1p1Yk5zcVNoTzluTkZSYmtHWlA1YlM5MDVPR3d1QlpONDVkMklVdURObHlENnpVSWV5K2lQXC9JSXBMZTdTS0ZyalY2YjNnbTNpVENvMlJCY1dUY0FhRUJxek10OFdwakIrcWJJd0NGS1hxTlFLZDdDVlEwajlqTDhUTmFzYXZscm1ZNUVUVEFTcXFiWUJlaUtNd0VheStPVFI2XC95S0ZCNWFVU1E4eXNwOGFqZHVwVnR1aWM1S1wvVjdFc2JFRlBlZlwvMzFDNmdqaDRHQng2WlU5TWtRcVpxR0VRV094UE1Wc1VrRjlqTEgycG5HZHo0ZkxsY3IxS1ljNlZkUG0wcUlhSlNiVGR2ajFlYWJFME1SaGVOV1c0WDJISXhaNHI0UmpRazRIWFdQOW54QUFzcW9yclFyeWFmUnVYYlNXNDBBR1lySVdXOUdJSmhialpySGJ0WWZwbUVcL254dmkweUw1TDdKZXpxSUplanB4Z3N5VjdjaDgwRER5UUE1UGNUN3Q1NXRuV0tEaTNjTzhIT1dxK2VmS2N6ZUZPUnlvZkR1NXFpOWhTYkJLQW1wTGs4Tmh2TWNtVVFEY0R5N3RNMElWZXYiLCJNSUlHblRDQ0JJV2dBd0lCQWdJUUNXWEFnaVdcL3hRdTZXUUdpMGxIeEtUQU5CZ2txaGtpRzl3MEJBUXNGQURCOE1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDaE1LVFdGemRHVnlRMkZ5WkRFb01DWUdBMVVFQ3hNZlRXRnpkR1Z5UTJGeVpDQkpaR1Z1ZEdsMGVTQkRhR1ZqYXlCSFpXNGdNekV1TUN3R0ExVUVBeE1sVUZKRUlFMWhjM1JsY2tOaGNtUWdTV1JsYm5ScGRIa2dRMmhsWTJzZ1VtOXZkQ0JEUVRBZUZ3MHhOekF4TURFd05UQXdNREJhRncweU5qQTNNVFV3TnpBd01EQmFNSGd4Q3pBSkJnTlZCQVlUQWxWVE1STXdFUVlEVlFRS0V3cE5ZWE4wWlhKRFlYSmtNU2d3SmdZRFZRUUxFeDlOWVhOMFpYSkRZWEprSUVsa1pXNTBhWFI1SUVOb1pXTnJJRWRsYmlBek1Tb3dLQVlEVlFRREV5RlFVa1FnVFdGemRHVnlRMkZ5WkNBelJGTXlJRWx6YzNWbGNpQlRkV0lnUTBFd2dnSWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUNEd0F3Z2dJS0FvSUNBUUNiRFd6NTVoOFloVXRIanM4M3lUcG9GTmJVZ0l2blBjSlRTRVVwaWlDTGVkaWNoNjFEcFFYZjhuQklkVUZ2K3pzN2pFS1MrbE5jWng3NWlVd0dKMm1Sb1JOaWtKajduS1d3SVBHU3Joc0plT0dSbndrZzZraDlQRUVOUmdVeWw2RE1Vc2tQWWhaOStLTmV1SHJ0M0hlK3NmQmJsS1wvUlEzSlJzeU5WOTJZdE1QQkFrMk5kZEJ2bWg5XC9GU255dTEzd1NoTFVhdHh5c1o2OThPSVoyYnBYc0QyRk8zTWo0OVJYcFhTeU1PelJuV01CMU9KQ2NxWjFuUEpoRzN2cEgzdmFiVGVoWDJjR0wzeGthYTZJVFc2bWtybmVLam5Lb1MzTTMzYlJSZStPZ0FubHVvY1k2K3FKaHFNa0NNcEZMUUxHVWNua1hpckZDS3FNTDVPQUpXWFFRZ1JLRlkyT3JEQXVnTVB2c200eU5WaEVCb2NId3c2dWM2Nkp2ckU3VEJreTZIQTh2SUpYM3NWVVBsMkhcLzVIdlVrVmhrRVJ3bWhTNktqMnhOVmR3MjJRVXpYY2E1d3B4aHU1cXprWUt1RThmQlNUT2g1V0srQUVmc2Jxa1oxMDdVZzYrcmtMWklDcCtcL2hiVG5JbTBuem9KanNOTnZXYkpIeGpQMEcyRDM2MlFpNm9PM1VLa2Q5b3N3MjlDZEhTYmtqYVlwcUJFa21DK2MyYkNxckFQcmVMQldkNDFpaXFSZUtKbU1oOHlTXC8zMkg5eFBCSGlkUHAwbGY3MkNSMlpcL0M5dEpQTWdZVWZFVWtiUnVUNVNRKzMwK1ROSVlsWmd5THg1dUxYcnpYS3p4c0ErYWZTbmp4U2dtWFV3Z2VxNkZIU0w2OVF1SGlGUXJLZ0dESURYNnByd0lEQVFBQm80SUJIVENDQVJrd1NBWUlLd1lCQlFVSEFRRUVQREE2TURnR0NDc0dBUVVGQnpBQmhpeG9kSFJ3T2k4dmIyTnpjQzV3YTJrdWFXUmxiblJwZEhsamFHVmpheTV0WVhOMFpYSmpZWEprTG1OdmJUQnBCZ05WSFI4RVlqQmdNRjZnWEtCYWhsaG9kSFJ3T2k4dlkzSnNMbkJyYVM1cFpHVnVkR2wwZVdOb1pXTnJMbTFoYzNSbGNtTmhjbVF1WTI5dEwyUTBZVFUxTVdGaE9USmtZVEV4T0dJeE5HTTBabVl4TVRkaFpURXhaR1V4TXpGbU9UUmhZakV1WTNKc01BNEdBMVVkRHdFQlwvd1FFQXdJQmhqQVNCZ05WSFJNQkFmOEVDREFHQVFIXC9BZ0VBTUIwR0ExVWREZ1FXQkJSUDk4T2ZZc3BXVkV2ZlNIVExjQnh2UE4wUVJUQWZCZ05WSFNNRUdEQVdnQlRVcFZHcWt0b1JpeFRFXC94RjY0UjNoTWZsS3NUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FnRUFtMDJCdjZpSVwvWmt2c3I2ZEFHXC9naUpDTytwZXZESDgwV0doYWd2dnllSWNqSXd3ZnNTSVViOXczNVhSUmhDT2t4U25QN2x1WW1uT2NvanZTREVuZVVWYlNzTXg5XC96cVwvUjFCbFwvRndBSWtzekpBY2d4TmgxcFwvNEg5akpUVkZFMFQxSmw2QzFZMG9GK1gwZmhVeFFwSDFGWUJYQTRXWlQrN1JER1wvMzNPRDhuZEJUT3dvdWVoXC9ONEV3RlpsOFI0azFGcmRlYVJubXV4U29JSWtidjZJZGRWTTNPZ1RNTlhyaTRjTlAzSDJqcGkxNEJnaGJXeTNWMjgyNGhvRFd3ZlZvN1NNYlAxTXhvWG9vNUhXcEVFb3VrdFFYWGpORFlZdGRGWVFXRG1scjZGaGVBSDFRbnV6dHd4ZDg3OFwvQzlEdmN1c3VWOEhQdEFGUVZWanNYbzNnSWN0bjVOREErY3pYdndkWWNoK1NxWmJtNVl2Yk1UOVJKWXpuWkFzUzNmRFwvc2RadVRnajMwbVkxMmYrSnVnaExLYXl6ZXR4NU9Pb0dvVHFRUEZuazBKOHIrNGljd1FOS054TnZIVE5oRFZrUFVzb2VcL1owNzZlZHYyckNYNHR5VmFYclZaNTBLMDRmVjdrMEhnVklsUXpZRVllUTg0bG5JYnVNZU1aNzBiZytFYU5OTlp1b2RmSHV2VVFrZTJcL0dRRzNENzVWWU1jd3FkQUFHSDZKdzVPZG5EN000V1wvS2hFbkl6ajljam9aZ050WWJLV0ZOb3VhdDRnUG4zYkdsSW5mWnBya0cyQ0VwSWxJWnAycVZNbFQ4NWZhZ0RGam9pOEhzc2ZRbWJtNEdCT3NDT1A1dE90b1lVamh3ZWE0Mjk3Q09uMm55NndDMjdWRGxjNk9tbkQyVDg9IiwiTUlJRnh6Q0NBNitnQXdJQkFnSVFGc2p5SXVxaHc4MHdOTWpYVTQ3bGZqQU5CZ2txaGtpRzl3MEJBUXNGQURCOE1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDaE1LVFdGemRHVnlRMkZ5WkRFb01DWUdBMVVFQ3hNZlRXRnpkR1Z5UTJGeVpDQkpaR1Z1ZEdsMGVTQkRhR1ZqYXlCSFpXNGdNekV1TUN3R0ExVUVBeE1sVUZKRUlFMWhjM1JsY2tOaGNtUWdTV1JsYm5ScGRIa2dRMmhsWTJzZ1VtOXZkQ0JEUVRBZUZ3MHhOakEzTVRRd056STBNREJhRncwek1EQTNNVFV3T0RFd01EQmFNSHd4Q3pBSkJnTlZCQVlUQWxWVE1STXdFUVlEVlFRS0V3cE5ZWE4wWlhKRFlYSmtNU2d3SmdZRFZRUUxFeDlOWVhOMFpYSkRZWEprSUVsa1pXNTBhWFI1SUVOb1pXTnJJRWRsYmlBek1TNHdMQVlEVlFRREV5VlFVa1FnVFdGemRHVnlRMkZ5WkNCSlpHVnVkR2wwZVNCRGFHVmpheUJTYjI5MElFTkJNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQXhaRjNuQ0VpVDhYRkZhcSszQlBUMGNNRGxXRTc2SUJzZHgyN3czaEx4d1ZMb2c0MlVUYXNJZ3pteXNUS3BCYzE3SEVaeU5BcWs5R3JDSG8wT3lrNEpadVhIb1c4MGdvWmFSMnNNbm40OXl0dDdhR3NFMVBzZlZ1cDhncUFvcmZtM0lGYWIyXC9DbmlKSk5YYVdQZ245NCtVXC9uc29hcVRRNmorNkpCb0l3bkZrbGhiWEhmS3JxbGtVWkpDWWFXYlpSaVE3bmtBTllZTTJUZDNOODdGbVJhbm1EWGo1Qkc2bGM5bzFjbFRDN1V2UlFtTklMOU9kRERaOHFscVkyRmkwZXp0Qm51bzJEVVM1dEdkVnk4U2dxUE0zRTEyZnRrNEVkbEt5cldtQnFGY1l3R3g0QWNTSjg4TzNyUW1SQk14dGswcjV2aGdyNmhEQ0dxN0ZIS1wvaFFGUDlMaFVPOTFxeFdFdE1uNzZTYTdEUENMYXMrdGZOUlZ3RzEyRkJ1RVpGaGRTXC9xS01kSVlVRTVRNnV3R1RFdlR6ZzJrbWdKVDNzTmE2ZGJobFluWW45aUlqVGgwZFBHZ2lYYXAxQmhpOEI5YWFQRmNIRUhTcVc4blpVSU5jcndmNUFVaSs3RCtxXC9BRzVJdGlCdFFUQ2FhRm03NGd2NTF5dXR6d2dLbkg5USt4M210dUtcL3V3bExDc2xqOURlWGdPek1XRnhGZ3V1d0xHWDM5a3REbmV0eE53M1BMYWJqSGtEbEdESWZ4ME1DUWFrTTc0c1RjdVc4SUNpSHZOQTdmeFhDbmJ0anN5N2F0XC95WFl3QWQrSURTNTFNQVwvZzNPWVZONE0rMHBHODQzUmU2WjUzb09EcDBZbXVneDBGTk8xTnhUM0hPMWhkN2RYeWpBVlwvdE5cL0dHY0NBd0VBQWFORk1FTXdEZ1lEVlIwUEFRSFwvQkFRREFnR0dNQklHQTFVZEV3RUJcL3dRSU1BWUJBZjhDQVFFd0hRWURWUjBPQkJZRUZOU2xVYXFTMmhHTEZNVFwvRVhyaEhlRXgrVXF4TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCTHFJWW9ycnRWejU2RjZXT29MWDlDY1JqU0ZpbTdnTzg3M2EzcDcrNjJJNmpvWE1zTXIwbmQ5blJQY0V3ZHVFbG9aWHdGZ0VyVlVRV2FVWldOcHVlMG1HdlU3QlVBZ1Y5VHUwSjB5QSs5c3JpelZvTXZ4K280elRKM1Z1NXA1YVRmMWFZb0gxeFlWbzVvb0ZnbFwvaElcL0VYRDJsb1wveE9VZlBLWEJZN3R3ZmlxT3ppUW1UR0J1cVBScThoM2RRUmxYWXhYXC9yekdmODBTZWNJVDZ3bzlLYXZEa2pPbUpXR3p6SHNuNlJ5bzZNRUNsTWFQbjB0ZTg3dWtOTjc0MEFkUGhUdk5lWmRXbHd5cVdBSnBzdjI0Y2FFY2tqU3BncG9JWk9qYzdQQWNFVlFPV0ZTeFVlc01rNEp6NWJWWmFcL0FCanpjcCtyc3ExUUxTSjVxdXFId1dGVGV3Q2h3cHc1Z3B3K0U1U3BLWTZGSUhQbFRkbCtxSFRodk44bHNLTkFRZzBxVGRFYklGWkNVUUMwQ2wzVGkzcVwvY1h2OHRndUxKTld2ZEd6QjYwMFkzMlFIY2xNcGV5YWJUNFwvUWVPZXNxcHg2RGE3MEoyS3ZMVDFqNkNoMkJzS1N6ZVZMYWhyam5vUHJkZ2lJWVlCT2dlQTNUOFNFMXBnYWd0NTZSN25Ja1JRYnRlc29SS2krTmZDN3BQYlwvRzFWVXNqXC9jUkVBSEgxaTFVS2EwYUNzSWlBTmZFZFFONU9rNnd0RkpKaHAzYXBBdm5Wa3JaRGZPRzV3ZTliWXp2R29JN1NVbmxlVVJCSitOM2loakFSZkw0aERlZVJIaFl5TGtNM2tFeUVrckpCTDVyMEdEamljeE0rYUZjUjJmQ0JBa3YzZ3JUNWt6NGtMY3ZzbUhYKzlEQnc9PSJdLCJhbGciOiJQUzI1NiJ9.eyJhY3NVUkwiOiJodHRwczovL3RzeXMuYXJjb3QuY29tL2Fjcy9hcGkvdGRzMi90eG4vYXBwL3YxL2NyZXEiLCJhY3NFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6ImZQNE5EbFlNYVJmenVBX1NIc19mZ0pzNlpNLXNGSnljWDFPaUZub1hvSW8iLCJ5IjoiS0hVRWZLSUJsdjdEaWJBVkVLY180MnVfYVowcFN1c3hKZGducTFZZy1PQSJ9LCJzZGtFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6InJzSWR2TVJQSkw2eHdwNnlubTV1ejh3alBfa0JNeGlNcU5TeFpWY1RrWEkiLCJ5IjoidzI0bU5aeElDaVJIZWs3aU5ZUDFLQjFfcHRjLVducVFHanlQM2ZqZWxiQSJ9fQ.edAoDPxsHfNgb7GGUH0qbK_BulgI_Ezp0658O-dib2MwZy21KoB9vExO70NlXkOJF2CgcohutJLWnKcr1cKdSJrnoFwzRn_R5ByAr8e4378Z-24E3xjZa77KIlpwvPLu1nk8YZD2ux-bgfjd_3jEnaL7Dx_wQaLGnpdHh9gwwhuQ-pW3B19y6GfnSKoSE89DWaiobO_yV4fyaatXMH7vFJlU5MlJpqnavx0BW-3ATSSpnwJb63A8e3zEz-IHweKXu4EiNEMjAKtgkDP1wl_sXfFN0VhN9RZPfOpmKGEJBnQ8GJH5hMK7y5VRlAzRDrDOSZ8a03D-dqJGU99fuaC4Dw";
        private const string AcsSignedContentEmpty = "";
        private const string AcsSignedContentBadFormat = "eyJ4NWMiOlsiTUlJRTZ6Q0NBOU9nQXdJQkFnSVVkUUs3SUZUVDFWUEwwcVp2d1h5UTBySytGVHN3RFFZSktvWklodmNOQVFFTEJRQXdjVEVMTUFrR0ExVUVCaE1DVlZ.tvWklodmNOQVFFTEJRQXdjVEVMTUFrR0ExVUVCaE1DVlZNeERUQUxCZ05WQkFvVEJGWkpVMEV4THpBdEJnTlZCQXNUSmxacGMyRWdTVzUwWlhKdVlYUn";
        private const string AcsSignedContentVisaEmulatorWithHeader = "eyJhbGciOiJQUzI1NiIsIng1YyI6WyJNSUlFQWpDQ0F1cWdBd0lCQWdJSkFMYkN5N0MzeEIybk1BMEdDU3FHU0liM0RRRUJDd1VBTUlHVk1Rc3dDUVlEVlFRR0V3SlZVekVMTUFrR0ExVUVDQXdDVjBFeEVEQU9CZ05WQkFjTUIxSmxaRzF2Ym1ReEhqQWNCZ05WQkFvTUZVMXBZM0p2YzI5bWRDQkRiM0p3YjNKaGRHbHZiakVpTUNBR0ExVUVBd3daWVdOelpXMTFiR0YwYjNJdWJXbGpjbTl6YjJaMExtTnZiVEVqTUNFR0NTcUdTSWIzRFFFSkFSWVVjSGhrWlhaelFHMXBZM0p2YzI5bWRDNWpiMjB3SGhjTk1qRXdNekF5TWpNek56VTVXaGNOTXpFd01qSTRNak16TnpVNVdqQ0JsVEVMTUFrR0ExVUVCaE1DVlZNeEN6QUpCZ05WQkFnTUFsZEJNUkF3RGdZRFZRUUhEQWRTWldSdGIyNWtNUjR3SEFZRFZRUUtEQlZOYVdOeWIzTnZablFnUTI5eWNHOXlZWFJwYjI0eElqQWdCZ05WQkFNTUdXRmpjMlZ0ZFd4aGRHOXlMbTFwWTNKdmMyOW1kQzVqYjIweEl6QWhCZ2txaGtpRzl3MEJDUUVXRkhCNFpHVjJjMEJ0YVdOeWIzTnZablF1WTI5dE1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBeE5hdUdoRVZPSGFUaGJlMkV1d0dTK3hrVzYwdmkrd1Y4K2ljRktFcFljd01Dbk5WemJNNkM2YVF1b1RZS3VrVkQ3bDR3MXRtbjg2bGdYQWpaMG9YaDR3OXdiNzZmVWFadW5sRkNndXNDQ1NtMWYyaU9lbXdVbVQyWTROb2hha21IU20xcVBpVWtraTY4L0FlSlJqVWRjVzY4c3BvcGhXVHNiNndzWDJGWjkwUHV0VkVOSk5oSUhwek82bHpnclRzME1DbkhSdnoxbkVsNEtFQ040eXBPQVJGS2VUSWdROWR2ZE9LRDRVM3czNWVQTzJjaFdDdytkZ1hBR0lkaDVpSkVFVTNrZlBxV1JQK0N4eW0xYUlTRVZ5RFhCc3JKUGNkaU1wQUtYanBPTi9hOXJTVURDejM5b3hnWURvQW11RnJDbms1VEEzaEtnb3hPd3VjT3hNN0FRSURBUUFCbzFNd1VUQWRCZ05WSFE0RUZnUVV3MEl6VDd2emRhTXJoZCtqWmJHcmpkNEpibWt3SHdZRFZSMGpCQmd3Rm9BVXcwSXpUN3Z6ZGFNcmhkK2paYkdyamQ0SmJta3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFpM1l3T2M5cEtlQm1oa3VXS0ZXSnJCelFWMWtMdVU2ZTd1bnJVa2tUK0xTSXhnVERrc3orUGtLYk12eGhoVitMSVdLNWJXY2hqdlVqMk9tQUwwcFZ2ZWNxRU9Vazk0aW0zWTRSOXdGeGFDNjFrTE5xWXViRHpIMytGejNIQW9vYWRQWmpVQ3hGOWdkdTNHbnBySW1KQTlmUjR3UnZ5VGhMTTRvNzgzVDRIL2xiV3Y4TzRNSFFkdjQzdGxNWjZLTDFPRlJYNUNiNytjTG5HbXgvZ1pKNUc3Tm1MVWpEQzlEL1BBQWhKRlQzcXI0VS9YZ1BDUWlyd2NyRmdpZkdTMWdoOHVIYWhRenBIR1liWlBwVC9udDdVTnVUazZZTHRsUkNtWDlRaUw0dFNDVjRTSWVXN2JOM1lxT204b0lMTmJ6bVNxWjZGdVpHNlVvM2w2aWVZN1BVM2c9PVxuIl19.eyJhY3NFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IlljbG5QaldsMmt2NFRrWm5GdHZjOEg2dUJ2cWkybEtLZ1lHLTQ3cVY5YXMiLCJ5IjoiZjNXUFJoUG9PSUwyaTllUDN0SF83RFhNSnF1SU9RZXB3RmlyTGd6djk2YyJ9LCJzZGtFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IkFyYkd0UWhNWGhEbEpSNnQ0bnB5MEdXM2xsN1BaMWNCb000Wi13Q1dSYk0iLCJ5IjoibEhVam93c1Bick5TTWk2MXAwWEphQnBWVmpjNlBBaE1XR0RwSkI3YnBnYyJ9LCJhY3NVUkwiOiJodHRwczovL3BheW1lbnRzLWFjcy1lbXVsYXRvci5henVyZXdlYnNpdGVzLm5ldC9hY3Mvc2RrL2NoYWxsZW5nZSJ9.rrx5oT89CHJQ_zXISyp5VRx0iJGdGRLco7GMHYol78zcsEEq8XSNazU-JkfDEQGE-ZC0tfodkW0rWPa00FagXkD6zgm-0TPDA4-NbwvHoIZ2gB6mtboSiu0xcvzQFcm_wjyq71y5plsgPKnxFKxOtDNbZFD_Lt6XtfeFxL4V_YVD-L971tESxRehRO8p3UTDirJUMFYBtgGBEK7lb7SHUydjH-qYdcHI8z1BMEKZHSNfX2kxJYpW_IH9VFv_rRxoFqs-tITWd7nAuyi96fvA2-L6EcUO1KNC1a9kwzdOkrvJvU6XSM5YAhbG2JKruSs_9t1CoU5jhvEqLPuEYpRsFw";
        private const string AcsSignedContentVisaEmulatorWithoutHeader = ".eyJhY3NFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IlljbG5QaldsMmt2NFRrWm5GdHZjOEg2dUJ2cWkybEtLZ1lHLTQ3cVY5YXMiLCJ5IjoiZjNXUFJoUG9PSUwyaTllUDN0SF83RFhNSnF1SU9RZXB3RmlyTGd6djk2YyJ9LCJzZGtFcGhlbVB1YktleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IkFyYkd0UWhNWGhEbEpSNnQ0bnB5MEdXM2xsN1BaMWNCb000Wi13Q1dSYk0iLCJ5IjoibEhVam93c1Bick5TTWk2MXAwWEphQnBWVmpjNlBBaE1XR0RwSkI3YnBnYyJ9LCJhY3NVUkwiOiJodHRwczovL3BheW1lbnRzLWFjcy1lbXVsYXRvci5henVyZXdlYnNpdGVzLm5ldC9hY3Mvc2RrL2NoYWxsZW5nZSJ9.rrx5oT89CHJQ_zXISyp5VRx0iJGdGRLco7GMHYol78zcsEEq8XSNazU-JkfDEQGE-ZC0tfodkW0rWPa00FagXkD6zgm-0TPDA4-NbwvHoIZ2gB6mtboSiu0xcvzQFcm_wjyq71y5plsgPKnxFKxOtDNbZFD_Lt6XtfeFxL4V_YVD-L971tESxRehRO8p3UTDirJUMFYBtgGBEK7lb7SHUydjH-qYdcHI8z1BMEKZHSNfX2kxJYpW_IH9VFv_rRxoFqs-tITWd7nAuyi96fvA2-L6EcUO1KNC1a9kwzdOkrvJvU6XSM5YAhbG2JKruSs_9t1CoU5jhvEqLPuEYpRsFw";

        private const string DsRootCertVisa = "MIIDojCCAoqgAwIBAgIQE4Y1TR0/BvLB+WUF1ZAcYjANBgkqhkiG9w0BAQUFADBrMQswCQYDVQQGEwJVUzENMAsGA1UEChMEVklTQTEvMC0GA1UECxMmVmlzYSBJbnRlcm5hdGlvbmFsIFNlcnZpY2UgQXNzb2NpYXRpb24xHDAaBgNVBAMTE1Zpc2EgZUNvbW1lcmNlIFJvb3QwHhcNMDIwNjI2MDIxODM2WhcNMjIwNjI0MDAxNjEyWjBrMQswCQYDVQQGEwJVUzENMAsGA1UEChMEVklTQTEvMC0GA1UECxMmVmlzYSBJbnRlcm5hdGlvbmFsIFNlcnZpY2UgQXNzb2NpYXRpb24xHDAaBgNVBAMTE1Zpc2EgZUNvbW1lcmNlIFJvb3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCvV95WHm6h2mCxlCfLF9sHP4CFT8icttD0b0/Pmdjh28JIXDqsOTPHH2qLJj0rNfVIsZHBAk4ElpF7sDPwsRROEW+1QK8bRaVK7362rPKgH1g/EkZgPI2h4H3PVz4zHvtH8aoVlwdVZqW1LS7YgFmypw23RuwhY/81q6UCzyr0TP579ZRdhE2o8mCP2w4lPJ9zcc+U30rq299yOIzzlr3xF7zSujtFWsan9sYXiwGd/BmoKoMWuDpI/k4+oKsGGelT84ATB+0tvz8KPFUgOSwsAGl0lUq8ILKpeeUYiZGo3BxN77t+Nwtd/jmliFKMAGzsGHxBvfaLdXe6YJ2E5/4tAgMBAAGjQjBAMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBQVOIMPPyw/cDMezUb+B4wg4NfDtzANBgkqhkiG9w0BAQUFAAOCAQEAX/FBfXxcCLkr4NWSR/pnXKUTwwMhmytMiUbPWU3J/qVAtmPN3XEolWcRzCSs00Rsca4BIGsDoo8Ytyk6feUWYFN4PMCvFYP3j1IzJL1kk5fui/fbGKhtcbP3LBfQdCVp9/5rPJS+TUtBjE7ic9DjkCJzQ83z7+pzzkWKsKZJ/0x9nXGIxHYdkFsd7v3M9+79YKWxehZx0RbQfBI8bGmX265fOZpwLwU8GUYEmSA20GBuYQa7FkKMcPcw++DbZqMAAb3mLNqRX6BGi01qnD093QVG/na/oAo85ADmJ7f/hC3euiInlhBx6yLt398znM/jra6O1I7mT1GvFpLgXPYHDw==";
        private const string DsPublicRSAIntermediateRootCertVisa = "MIIFqTCCA5GgAwIBAgIPUT6WAAAA20Qn7qzgvuFIMA0GCSqGSIb3DQEBCwUAMG8xCzAJBgNVBAYTAlVTMQ0wCwYDVQQKDARWSVNBMS8wLQYDVQQLDCZWaXNhIEludGVybmF0aW9uYWwgU2VydmljZSBBc3NvY2lhdGlvbjEgMB4GA1UEAwwXVmlzYSBQdWJsaWMgUlNBIFJvb3QgQ0EwHhcNMjEwMzE2MDAwMDAwWhcNNDEwMzE1MDAwMDAwWjBvMQswCQYDVQQGEwJVUzENMAsGA1UECgwEVklTQTEvMC0GA1UECwwmVmlzYSBJbnRlcm5hdGlvbmFsIFNlcnZpY2UgQXNzb2NpYXRpb24xIDAeBgNVBAMMF1Zpc2EgUHVibGljIFJTQSBSb290IENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA2WEbXLS3gI6LOY93bP7Kz6EO9L1QXlr8l+fTkJWZldJ6QuwZ1cv4369tfjeJ8O5wSJiDcVw7eNdOP73LfAtwHlTnUnb0e9ILTTipc5bkNnAevocrJACsrpiQ8jBI9ttpcqKUeJgzW4Ie25ypirKroVD42b4E0iICK2cZ5QfD4BSzUnftp4Bqh8AfpGvG1lreCaD53qrsy5SUadY/NaeUGOkqdPvDSNoDIdrbExwnZaSFUmjQT1svKwMqGo2GFrgJ4cULEp4NNj5rga8YTTZ7Xo5MblHrLpSPOmJev30KWi/BcbvtCNYNWBTg7UMzP3cKMQ1pGLvG2PgvFTZSRvH3QzngJRgrDYYOJ6kj9ave+6yOOFqj80ZCuH0Nugt2mMS3c3+Nksaw+6H3cQPsE/Gv5zjfsKleRhEFtE1gyrdUg1DMgu8o/YhKM7FAqkXUn74zwoRFgx3Mi5OaGTQbg+NlwJgR4sVHXCV4s9b8PjneLhzWMn353SFARF9dnO7LDBqqtT6WltJu1z9x2Ze0UVNZvxKGcyCkLody29O8j9/MGZ8SOSUu4U6NHrebKuuf9Fhtn6PqQ4ppkhy6sReXeV5NVGfVpDYY5ZAKEWqTYgMULWpQ2Py4BGpFzBe07jXkyulRpoKvz14iXeA0oq16c94DrFYX0jmrWLeU4a/TCZQLFIsCAwEAAaNCMEAwHQYDVR0OBBYEFEtNpg77oBHorQvi8PMKAC+sixb7MA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4ICAQC5BU9qQSZYPcgCp2x0Juq59kMmXuBly094DaEnPqvtCgwwAirkv8x8/QSOxiWWiu+nveyuR+j6Gz/fJaV4u+J5QEDycfk605Mw3HIcJOeZvDgk1eyOmQwUP6Z/BdQTNJmZ92Z8dcG5yWCxLBrqPH7ro3SsjhYq9duIJU7jfizCJCN4W8tp0D2pWBe1/CYNswP4GMs5jQ5+ZQKN/L5JFdwVTu7XPt8b5zfgbmmQpVmUn0oFwm3OI++Z6gEpNmW5bd/2oUIZoG96Qff2fauVMAYiWQvNnL3y1gkRguTOSMVUCCiGfdvwu5ygowillvV2nHb7+YibQ9N5Z2spP0o9Zlfzoat27WFpyK47TiUdu/4toarLKGZP+hbA/F4xlnM/8EfZkE1DeTTI0lhN3O8yEsHrtRl1OuQZ/IexHO8UGU6jvn4TWo10HYeXzrGckL7oIXfGTrjPzfY62T5HDW/BAEZS+9Tkijz25YM0fPPz7IdlEG+k4q4YwZ82j73Y9kDEM5423mrWorq/Bq7I5Y8v0LTY9GWHYrpElYf0WdOXAbsfwQiT6qnRio+p82VyqlY8Jt6VVA6CDy/iHKwcj1ELEnDQfVv9hedoxmnQ6xe/nK8czclu9hQJRv5Lh9gk9Q8DKK2nmgzZ8SSQ+lr3mSSeY8JOMRlE+RKdOQIChWthTJKh7w==";
        private const string DsEcommeIssuingG2CertVisa = "MIIG4TCCBMmgAwIBAgIPUT6WAAAA5aNthPTd5IBlMA0GCSqGSIb3DQEBCwUAMG8xCzAJBgNVBAYTAlVTMQ0wCwYDVQQKDARWSVNBMS8wLQYDVQQLDCZWaXNhIEludGVybmF0aW9uYWwgU2VydmljZSBBc3NvY2lhdGlvbjEgMB4GA1UEAwwXVmlzYSBQdWJsaWMgUlNBIFJvb3QgQ0EwHhcNMjEwNjAzMDAwMDAwWhcNNDEwMzExMDAwMDAwWjB2MQswCQYDVQQGEwJVUzENMAsGA1UECgwEVklTQTEvMC0GA1UECwwmVmlzYSBJbnRlcm5hdGlvbmFsIFNlcnZpY2UgQXNzb2NpYXRpb24xJzAlBgNVBAMMHlZpc2EgZUNvbW1lcmNlIElzc3VpbmcgQ0EgLSBHMjCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAI9EkpA/PCs8Rbz8/WTlVKxXvj9Y5BIX6nVHV21IEUafNYAvCqL1o9htrdrmUjZn6ci5Y1g9fGHekTfibDouChkkxyiVs2lz8JoEGuJfuDJ/UjUJRRfs5LlHCvWibhMiX/AtdFYzbVPQOtWpyPmf/fZURwa9tLtlAEHr6erAUqLWjm77pyofQWcyHT9+Ug8EBsFS3RRAW6ILNiKXCV9ZSHNLLWFmkgbvfyvBE7VmAJavYF2cFIOCtBrXDZsV/cxFzObC/EMCyZp9Ooa0iYSFxLaytSx8pwmI0shleFRHKoc76eVcooT7Ym13hrh388Gng3C4ZR4UIuaoNlhSLfUnoFlNRDIPwky5KC62uuPBh6aHlKmMOsp0+zTfq8u1sjMyzuFyJnk/D12kkLPjTpABSv1zeVjlKxzvlrVNlePgY4lSPvtIbLcBn2YHElTe4YoZK12H8RGlhuFDzNm4IWDfqIFiPD7KYFWKp069A6EGA8L93mSoPIs9SCIwi2q3shQBOMjeLKhLAB1NgRI1vcL8/deuppey7siKh+15OA0T4vtcLIwtu3SFyMvDzMciQV1YbGZmyIWAZwGlqtH0hkkQyeWCrCviIcVZ3MX6dv+oRE1YhI9lXZIbpkhf+INbAW7VgEzKAwTruAeme7TLB1UvoYJV3mUCQ0KQaAei/RYeE9tFAgMBAAGjggFxMIIBbTAfBgNVHSMEGDAWgBRLTaYO+6AR6K0L4vDzCgAvrIsW+zAdBgNVHQ4EFgQUvSdjKKSuVLfII7fBNUIX6cZ4X4UwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAQYwWwYDVR0gBFQwUjAyBggrBgEFBQcCATAmMCQGCCsGAQUFBwIBFhhodHRwczovL3d3dy52aXNhLmNvbS9wa2kwCAYGZ4EMAQICMAgGBmeBAwEBATAIBgZngQMBAQIwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMD8GA1UdHwQ4MDYwNKAyoDCGLmh0dHA6Ly9lbnJvbGwudmlzYWNhLmNvbS9WaXNhUHVibGljUlNBUm9vdC5jcmwwSgYIKwYBBQUHAQEEPjA8MDoGCCsGAQUFBzAChi5odHRwOi8vZW5yb2xsLnZpc2FjYS5jb20vVmlzYVB1YmxpY1JTQVJvb3QuY3J0MA0GCSqGSIb3DQEBCwUAA4ICAQCBWVbChQzmXCjOwq9UmoDL/MRjfCkh1a+F9+Y3FG+mdI3EbP9q0U9dgH2sSQM6WFh3N5PeAUZ1jqA8d3L1nyS1o9/blRyM2viEzYLxQyiAHlwzAwvCz4LyH9OrNJ9LUXpa4LNl2KkAr8HHC5lRUCX/igAlEXSeQP/hMb7CJXi7rcZjS7EQjogvmBjL2qH04GN2kUluOW5dIfGqTxxKNm9xOgaCGy1mRnr1APcPdYO4dMB/fEcQ6ZF0ONMCesxN2wzHxSQsCAFuAH4yBVusfPDbx7sSkT9sYmsuP0Kj3MxWXe6vtfkT+PLOf4rmF791yqhBbP4TKjPI9Fkqy0V5EDbPAkFNA3lQpIJ4G2sR8dXiaXJowjCW30HzFlBUvbUJOB9IQwBpfuMzuvSVZl89eyOE26lvNbR0zmEDO2t6FZGOcF5XwUihYigpcsruDulERt7xfXD5DHJPU/zCwr02RsBY1HtvY2DxycvA1bbVvZo4emz2EzQ5VZd7qlb8h7Vaq6CJzHlfiK8SMJY8wwFv0cR3hP7rYzlPGNlfU/2EGt4DOu90o5geZ6DHxD1s5iEXSEbviLzPvgX0BgfvzFrBBQ6pyy5SglS5kcFQvqjNCF99Fe969ttz+7I2+g6qxaOWHz0rNSoAQ/Bw0vCRO67Ep16qvVoyo5k55Mf63yeFxFi3EQ==";
        private const string DsRootCertMastercard = "MIIFxzCCA6+gAwIBAgIQFsjyIuqhw80wNMjXU47lfjANBgkqhkiG9w0BAQsFADB8MQswCQYDVQQGEwJVUzETMBEGA1UEChMKTWFzdGVyQ2FyZDEoMCYGA1UECxMfTWFzdGVyQ2FyZCBJZGVudGl0eSBDaGVjayBHZW4gMzEuMCwGA1UEAxMlUFJEIE1hc3RlckNhcmQgSWRlbnRpdHkgQ2hlY2sgUm9vdCBDQTAeFw0xNjA3MTQwNzI0MDBaFw0zMDA3MTUwODEwMDBaMHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQKEwpNYXN0ZXJDYXJkMSgwJgYDVQQLEx9NYXN0ZXJDYXJkIElkZW50aXR5IENoZWNrIEdlbiAzMS4wLAYDVQQDEyVQUkQgTWFzdGVyQ2FyZCBJZGVudGl0eSBDaGVjayBSb290IENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAxZF3nCEiT8XFFaq+3BPT0cMDlWE76IBsdx27w3hLxwVLog42UTasIgzmysTKpBc17HEZyNAqk9GrCHo0Oyk4JZuXHoW80goZaR2sMnn49ytt7aGsE1PsfVup8gqAorfm3IFab2/CniJJNXaWPgn94+U/nsoaqTQ6j+6JBoIwnFklhbXHfKrqlkUZJCYaWbZRiQ7nkANYYM2Td3N87FmRanmDXj5BG6lc9o1clTC7UvRQmNIL9OdDDZ8qlqY2Fi0eztBnuo2DUS5tGdVy8SgqPM3E12ftk4EdlKyrWmBqFcYwGx4AcSJ88O3rQmRBMxtk0r5vhgr6hDCGq7FHK/hQFP9LhUO91qxWEtMn76Sa7DPCLas+tfNRVwG12FBuEZFhdS/qKMdIYUE5Q6uwGTEvTzg2kmgJT3sNa6dbhlYnYn9iIjTh0dPGgiXap1Bhi8B9aaPFcHEHSqW8nZUINcrwf5AUi+7D+q/AG5ItiBtQTCaaFm74gv51yutzwgKnH9Q+x3mtuK/uwlLCslj9DeXgOzMWFxFguuwLGX39ktDnetxNw3PLabjHkDlGDIfx0MCQakM74sTcuW8ICiHvNA7fxXCnbtjsy7at/yXYwAd+IDS51MA/g3OYVN4M+0pG843Re6Z53oODp0Ymugx0FNO1NxT3HO1hd7dXyjAV/tN/GGcCAwEAAaNFMEMwDgYDVR0PAQH/BAQDAgGGMBIGA1UdEwEB/wQIMAYBAf8CAQEwHQYDVR0OBBYEFNSlUaqS2hGLFMT/EXrhHeEx+UqxMA0GCSqGSIb3DQEBCwUAA4ICAQBLqIYorrtVz56F6WOoLX9CcRjSFim7gO873a3p7+62I6joXMsMr0nd9nRPcEwduEloZXwFgErVUQWaUZWNpue0mGvU7BUAgV9Tu0J0yA+9srizVoMvx+o4zTJ3Vu5p5aTf1aYoH1xYVo5ooFgl/hI/EXD2lo/xOUfPKXBY7twfiqOziQmTGBuqPRq8h3dQRlXYxX/rzGf80SecIT6wo9KavDkjOmJWGzzHsn6Ryo6MEClMaPn0te87ukNN740AdPhTvNeZdWlwyqWAJpsv24caEckjSpgpoIZOjc7PAcEVQOWFSxUesMk4Jz5bVZa/ABjzcp+rsq1QLSJ5quqHwWFTewChwpw5gpw+E5SpKY6FIHPlTdl+qHThvN8lsKNAQg0qTdEbIFZCUQC0Cl3Ti3q/cXv8tguLJNWvdGzB600Y32QHclMpeyabT4/QeOesqpx6Da70J2KvLT1j6Ch2BsKSzeVLahrjnoPrdgiIYYBOgeA3T8SE1pgagt56R7nIkRQbtesoRKi+NfC7pPb/G1VUsj/cREAHH1i1UKa0aCsIiANfEdQN5Ok6wtFJJhp3apAvnVkrZDfOG5we9bYzvGoI7SUnleURBJ+N3ihjARfL4hDeeRHhYyLkM3kEyEkrJBL5r0GDjicxM+aFcR2fCBAkv3grT5kz4kLcvsmHX+9DBw==";

        /// <summary>
        /// Confirms valid ACS and DS certs are used in PaymentSessionsHandler.cs
        /// </summary>
        /// <param name="mockjws">ACS content string</param>
        /// <param name="rootDsCert">Ecommerce Root Certificate</param>
        /// <param name="intermediateDsCert">Public RSA Root Certificate</param>
        /// <param name="g2DsCert">Ecommerce Issuing Certificate G2</param>
        /// <param name="testContextScenario"></param>
        /// <param name="expectedcertauthorizationresult"></param>
        /// <returns></returns>
        [TestMethod]
        ////[DataRow(AcsSignedContentVisa, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "", true)] /// Valid ACS and appropriate dsCerts
        ////[DataRow(AcsSignedContentVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, DsRootCertVisa, "", true)] /// Valid ACS and valid dsCerts in random order 
        ////[DataRow(AcsSignedContentVisa, DsPublicRSAIntermediateRootCertVisa, DsRootCertVisa, DsRootCertVisa, "", true)] /// Valid ACS and repetition of a dsCerts, valid
        [DataRow(AcsSignedContentEmpty, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "", false)] /// Empty ACS
        [DataRow(AcsSignedContentBadFormat, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "", false)] /// ACS that does not decode correctly
        [DataRow(AcsSignedContentVisaEmulatorWithHeader, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "px-service-psd2-e2e-emulator", true)] /// Emulator test with valid parameters 
        [DataRow(AcsSignedContentVisaEmulatorWithoutHeader, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "px-service-psd2-e2e-emulator", false)] /// Emulator test with invalid parameters 
        [DataRow(AcsSignedContentMastercard, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "", false)] /// ACS and dsCert mismatch
        [DataRow(AcsSignedContentVisaEmulatorWithoutHeader, DsPublicRSAIntermediateRootCertVisa, DsRootCertVisa, DsRootCertVisa, "px-service-psd2-e2e-emulator", false)] /// Emulator test with invalid parameters
        [DataRow(AcsSignedContentBadFormat, DsPublicRSAIntermediateRootCertVisa, DsRootCertVisa, DsEcommeIssuingG2CertVisa, "px-service-psd2-e2e-emulator", false)] /// Emulator test with invalid parameters
        [DataRow(null, DsRootCertVisa, DsPublicRSAIntermediateRootCertVisa, DsEcommeIssuingG2CertVisa, "", false)] /// Null ACS
        [DataRow(null, null, null, null, "", false)] /// Null ACS and null dsCert
        public Task PassMultiCert_CheckSuccessOrFail(string mockjws, string rootDsCert, string intermediateDsCert, string g2DsCert, string testContextScenario, bool expectedcertauthorizationresult)
        {
            List<string> testdsrootcert = new List<string> { rootDsCert, intermediateDsCert, g2DsCert };

            Common.TestContext tc = new Common.TestContext(
                      contact: "paymentclient_testapp",
                      retention: DateTime.MaxValue,
                      scenarios: testContextScenario);
            string sessionId = "123456789";

            var paymentcertificatevalidator = new PaymentPSD2CertificatesValidator(mockjws, testdsrootcert, tc, sessionId);
            try
            {
                /// Act
                bool result = paymentcertificatevalidator.VerifySignature(traceActivityId: new EventTraceActivity());
                Assert.AreEqual(expectedcertauthorizationresult, result, string.Format("expected authorization to {0}", expectedcertauthorizationresult ? "succeed" : "fail"));
            }
            catch (ValidationException ex)
            {
                /// Assert
                Assert.AreEqual(ex.ErrorCode, ErrorCode.InvalidRequestData, "the error code for authorization failure is not as expected");
            }

            return Task.CompletedTask;
        }

        [TestMethod]
        ////[DataRow(AcsSignedContentVisa, DsEcommeIssuingG2CertVisa, "", true)] /// Valid ACS and appropriate dsCert, Visa
        ////[DataRow(AcsSignedContentMastercard, DsRootCertMastercard, "", true)] /// Valid ACS and appropriate dsCert, MC
        [DataRow(AcsSignedContentMastercard, DsEcommeIssuingG2CertVisa, "", false)] /// ACS and dsCert mismatch
        [DataRow(AcsSignedContentVisa, DsRootCertMastercard, "", false)] /// ACS and dsCert mismatch
        [DataRow(AcsSignedContentEmpty, DsEcommeIssuingG2CertVisa, "", false)] /// Empty ACS
        [DataRow(AcsSignedContentBadFormat, DsEcommeIssuingG2CertVisa, "", false)] /// ACS that does not decode correctly
        [DataRow(AcsSignedContentVisaEmulatorWithHeader, DsEcommeIssuingG2CertVisa, "px-service-psd2-e2e-emulator", true)] /// Emulator test with valid parameters
        [DataRow(AcsSignedContentVisaEmulatorWithoutHeader, DsEcommeIssuingG2CertVisa, "px-service-psd2-e2e-emulator", false)] /// Emulator test with invalid parameters
        [DataRow(null, DsRootCertMastercard, "", false)] /// Null ACS
        [DataRow(null, null, "", false)] /// Null ACS and null dsCert
        public Task PassSingleCert_CheckSuccessOrFail(string mockjws, string dsCert, string testContextScenario, bool expectedcertauthorizationresult)
        {
            List<string> testdsrootcert = new List<string> { dsCert };

            Common.TestContext tc = new Common.TestContext(
                      contact: "px.azure.cot",
                      retention: DateTime.MaxValue,
                      scenarios: testContextScenario);
            string sessionId = "123456789";

            var paymentcertificatevalidator = new PaymentPSD2CertificatesValidator(mockjws, testdsrootcert, tc, sessionId);
            try
            {
                /// Act
                bool result = paymentcertificatevalidator.VerifySignature(traceActivityId: new EventTraceActivity());
                Assert.AreEqual(expectedcertauthorizationresult, result, string.Format("expected authorization to {0}", expectedcertauthorizationresult ? "succeed" : "fail"));
            }
            catch (ValidationException ex)
            {
                /// Assert
                Assert.AreEqual(ex.ErrorCode, ErrorCode.InvalidRequestData, "the error code for authorization failure is not as expected");
            }

            return Task.CompletedTask;
        }
    }
}

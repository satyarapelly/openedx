// <copyright file="CertificateUserDirectoryTests.cs" company="Microsoft">Copyright (c) Microsoft 2015. All rights reserved.</copyright>

namespace CIT.PXService.Tests
{
    using System;
    using System.Collections.Generic;
    using System.Collections.ObjectModel;
    using System.Security.Cryptography.X509Certificates;
    using System.Text;
    using global::Tests.Common.Model.Authentication;
    using Microsoft.Commerce.Payments.Management.CertificateVerificationCore;
    using Microsoft.VisualStudio.TestTools.UnitTesting;

    [TestClass]
    public class CertificateUserDirectoryTests
    {
        private const string INTEGRATION = "integration";
        private const string PRODUCTION = "production";
        Dictionary<Tuple<string, string, bool>, string> certificates = new Dictionary<Tuple<string, string, bool>, string>
        {
            {
                new Tuple<string, string, bool>(INTEGRATION, Partner.Name.PIFDService.ToString(), true),
                "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"
            },
            {
                new Tuple<string, string, bool>(INTEGRATION, Partner.Name.PXCOT.ToString(), true),
                "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"
            },
            {
                new Tuple<string, string, bool>(INTEGRATION, Partner.Name.PIFDService.ToString(), false),
                "MIIIhzCCBm+gAwIBAgITFgAShDHgLQyi3MzYcAAAABKEMTANBgkqhkiG9w0BAQsFADBEMRMwEQYKCZImiZPyLGQBGRYDR0JMMRMwEQYKCZImiZPyLGQBGRYDQU1FMRgwFgYDVQQDEw9BTUUgSW5mcmEgQ0EgMDMwHhcNMjAwODMxMTgwNDEyWhcNMjEwODI2MTgwNDEyWjCBrDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAldBMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xHjAcBgNVBAsTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjE+MDwGA1UEAxM1Z2VuZXZhLXB4Y2xpZW50YXV0aC5wYXltZW50ZXhwZXJpZW5jZS5hemNsaWVudC1pbnQubXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCbCtVV3t1rLRUtMRyKMNXDfLOHQy5vosKiEVQz3Xdi9bhmH0TP31GoFMmZNgpzTQZMY8LUp0NNw9HnTpWkFuSiqYTUyGklOov/PMicCdTzi4H0mFDeIifv3a0mjjqoKKAe6EMocdKKYOxjpaZBCLS3jxrJSfy0cEQMFESPjpd3n+bGI9QeiMcBI9xy5V0kuk61NTCy9eb7OkymV0rl2IebwbhMXaMkN6S08r+Xv9RoO7CDmAYwkFcqTH3rMZMbQ/9etWBpbtGs/UKNkq5z6ClMA9Z7Zv7mWDj5ymgCoD2XOa+RlFQUBM9zszoOTp8KsEoh8V1/XO9Kqzs6nYlIQRJTAgMBAAGjggQHMIIEAzAnBgkrBgEEAYI3FQoEGjAYMAoGCCsGAQUFBwMBMAoGCCsGAQUFBwMCMD0GCSsGAQQBgjcVBwQwMC4GJisGAQQBgjcVCIaQ4w2E1bR4hPGLPoWb3RbOnRKBYIL19iuD8tEgAgFkAgEKMIIBywYIKwYBBQUHAQEEggG9MIIBuTBjBggrBgEFBQcwAoZXaHR0cDovL2NybC5taWNyb3NvZnQuY29tL3BraWluZnJhL0NlcnRzL0FNM1BLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDMuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsMS5hbWUuZ2JsL2FpYS9BTTNQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNydDBTBggrBgEFBQcwAoZHaHR0cDovL2NybDIuYW1lLmdibC9haWEvQU0zUEtJSU5UQ0EwMS5BTUUuR0JMX0FNRSUyMEluZnJhJTIwQ0ElMjAwMy5jcnQwUwYIKwYBBQUHMAKGR2h0dHA6Ly9jcmwzLmFtZS5nYmwvYWlhL0FNM1BLSUlOVENBMDEuQU1FLkdCTF9BTUUlMjBJbmZyYSUyMENBJTIwMDMuY3J0MFMGCCsGAQUFBzAChkdodHRwOi8vY3JsNC5hbWUuZ2JsL2FpYS9BTTNQS0lJTlRDQTAxLkFNRS5HQkxfQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNydDAdBgNVHQ4EFgQUiXi5xZOrgFrFlz+sS29dOsUjqUowDgYDVR0PAQH/BAQDAgWgMIIBWQYDVR0fBIIBUDCCAUwwggFIoIIBRKCCAUCGP2h0dHA6Ly9jcmwubWljcm9zb2Z0LmNvbS9wa2lpbmZyYS9DUkwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybIYxaHR0cDovL2NybDEuYW1lLmdibC9jcmwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybIYxaHR0cDovL2NybDIuYW1lLmdibC9jcmwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybIYxaHR0cDovL2NybDMuYW1lLmdibC9jcmwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybIYxaHR0cDovL2NybDQuYW1lLmdibC9jcmwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybIYxaHR0cDovL2NybDQuYW1lLmdibC9jcmwvQU1FJTIwSW5mcmElMjBDQSUyMDAzLmNybDAfBgNVHSMEGDAWgBRQMfDvQi7A/72kCQvKxMKGfdQ/MjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQELBQADggIBAG1YwpTR5/8ug5JhdHR3TBBAapXfvpzqpYQSGJdzA36+4WikLfRzDlhOcDNrviYCgrN+GIdEt8ilf5I8r5/KPd8WKA7ZtkB1rSBi5TZPtEg7VAazMG2pwS41kWCClqzmpBybPcSEzqb0aAr+NEOGQOQMX6DtIlHdmivrX/UgCUiMyw8YN6zZCb52c4woPE7yLKKlqsqYhoN9bLvF9hKf+7X32uu9Q3PpKEsnloYVSswpZtESFjnH0y7ot64yu5ymWM/KI46Jx5Dl03wtn6BYvv8yiDq3zaNtW41+yDBpPCD+UK/X8YBsEkst7xSh+7ZyqWYa7eLErFl6fYuLcOm3x9mOP8lYR47WgbEikdqTNP5bHXAsm4BI4k6zOLEMiriIl3/YkWgZ6DLY1pceslxjm1Oer3PNIbV6HGyA/LrTlQ5w9OUV48brx5wqLcaYqsHDIdaymaJXl0Hdli47v/BjiUHe/zJlzrOMOWtZ68lcurF9I4KtVZeTjCvChFwjCX0qv6KPtg57EjZmY6DGW/eaCgjATGgHx7rVOSwfrtSpzfxjlHP9WSuYT5TIL0b+kO7mJCdzmgghJZG/fHq+YdjwhioF4/IUEL+iq2Vb1o1G2CiwDt9vN3cwQH+67WCnG2LcxvBvjL71OTrB0US/gC/AXZmEvtquwpL9sR6/XAruwEiM"
            },
            {
                new Tuple<string, string, bool>(PRODUCTION, Partner.Name.PIFDService.ToString(), true),
                "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"
            },
            {
                new Tuple<string, string, bool>(PRODUCTION, Partner.Name.PXCOT.ToString(), true),
                "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"
            },
            {
                new Tuple<string, string, bool>(PRODUCTION, Partner.Name.PIFDService.ToString(), false),
                "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"
            },
        };

        [TestMethod]
        public void TestUserDirectory_ValidateAllCertificates()
        {
            foreach (KeyValuePair<Tuple<string, string, bool>, string> entry in certificates)
            {
                this.TestUserDirectory_ValidateCertificate(entry.Key.Item1, entry.Key.Item2, entry.Key.Item3, entry.Value);
            }
        }

        private void TestUserDirectory_ValidateCertificate(string environment, string partnerName, bool isValidCert, string certBase64)
        {
            X509Certificate2 cert = new X509Certificate2(Encoding.UTF8.GetBytes(certBase64));
            ReadOnlyDictionary<string, IEnumerable<Microsoft.Commerce.Payments.Management.CertificateVerificationCore.IVerificationRule>> rules = null;
            UserDirectory userDirectory = null;
            switch (environment)
            {
                case "integration":
                    rules = CertificateRules.Integration;
                    break;
                case "production":
                    rules = CertificateRules.Production;
                    break;
            }

            Assert.IsNotNull(rules);
            userDirectory = new UserDirectory(rules, true, null, false, false, false, null);
            Assert.IsNotNull(userDirectory);

            var identities = userDirectory.FetchIdentities(cert, false).Identities;
            if (isValidCert)
            {
                Assert.AreEqual(1, identities.Count, string.Format("There should be only one cert for {0} in {1}", partnerName, environment));
                Assert.AreEqual(partnerName, identities[0].Name, string.Format("Expected name is not correct. Actual: {0} ", identities[0].Name));
            }
            else
            {
                Assert.AreEqual(0, identities.Count, string.Format("The cert should not be valiad for {0} in {1}", partnerName, environment));
            }
        }
    }
}
